import{_ as ip}from"../chunks/preload-helper.a4192956.js";import{s as Kl,e as te,a as xe,c as ne,f as ce,g as Me,b as Re,d as G,y as U,X as Te,i as Ye,j as Z,l as $e,n as As,r as Ds,m as Yl,Y as sp,z as Rt,o as op,t as ap,h as lp,k as cp,R as ii,S as Tn,H as Ls,T as An,B as hp,U as Ns,V as _t,W as mt}from"../chunks/scheduler.acaf567e.js";import{S as $l,i as Jl,b as dp,d as up,m as fp,t as gp,a as pp,e as _p}from"../chunks/index.5c00e781.js";import{c as bt,g as mp,H as Gl,s as bp,N as Ms,b as wp,A as yp,E as Xl,W as vp,e as kp,d as Ep,__tla as Cp}from"../chunks/scala.92048d30.js";import{R as Sp,S as Os,b as xp,__tla as Rp}from"../chunks/toggleHighContrast.492bfa7f.js";import{w as Tp}from"../chunks/index.7fc33993.js";let Ql,Ap=Promise.all([(()=>{try{return Cp}catch{}})(),(()=>{try{return Rp}catch{}})()]).then(async()=>{const Je=()=>new Map,si=e=>{const t=Je();return e.forEach((n,r)=>{t.set(r,n)}),t},Fe=(e,t,n)=>{let r=e.get(t);return r===void 0&&e.set(t,r=n()),r},ec=(e,t)=>{const n=[];for(const[r,i]of e)n.push(t(i,r));return n},tc=(e,t)=>{for(const[n,r]of e)if(t(r,n))return!0;return!1},jt=()=>new Set,oi=e=>e[e.length-1],nc=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},Tt=Array.from,rc=Array.isArray;class ur{constructor(){this._observers=Je()}on(t,n){Fe(this._observers,t,jt).add(n)}once(t,n){const r=(...i)=>{this.off(t,r),n(...i)};this.on(t,r)}off(t,n){const r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return Tt((this._observers.get(t)||Je()).values()).forEach(r=>r(...n))}destroy(){this._observers=Je()}}const tt=Math.floor,fr=Math.abs,ic=Math.log10,ai=(e,t)=>e<t?e:t,Ut=(e,t)=>e>t?e:t,Is=e=>e!==0?e<0:1/e<0,Ps=1,zs=2,li=4,ci=8,Dn=32,wt=64,Be=128,gr=31,hi=63,Ft=127,sc=2147483647,Bs=Number.MAX_SAFE_INTEGER,oc=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&tt(e)===e),ac=String.fromCharCode,lc=e=>e.toLowerCase(),cc=/^\s*/g,hc=e=>e.replace(cc,""),dc=/([A-Z])/g,js=(e,t)=>hc(e.replace(dc,n=>`${t}${lc(n)}`)),uc=e=>{const t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=t.codePointAt(i);return r},Ln=typeof TextEncoder<"u"?new TextEncoder:null,fc=e=>Ln.encode(e),di=Ln?fc:uc;let Nn=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Nn&&Nn.decode(new Uint8Array).length===1&&(Nn=null);class Mn{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const ke=()=>new Mn,gc=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},me=e=>{const t=new Uint8Array(gc(e));let n=0;for(let r=0;r<e.bufs.length;r++){const i=e.bufs[r];t.set(i,n),n+=i.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},pc=(e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(Ut(n,t)*2),e.cpos=0)},Ee=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t},On=Ee,$=(e,t)=>{for(;t>Ft;)Ee(e,Be|Ft&t),t=tt(t/128);Ee(e,Ft&t)},ui=(e,t)=>{const n=Is(t);for(n&&(t=-t),Ee(e,(t>hi?Be:0)|(n?wt:0)|hi&t),t=tt(t/64);t>0;)Ee(e,(t>Ft?Be:0)|Ft&t),t=tt(t/128)},fi=new Uint8Array(3e4),_c=fi.length/3,mc=(e,t)=>{if(t.length<_c){const n=Ln.encodeInto(t,fi).written||0;$(e,n);for(let r=0;r<n;r++)Ee(e,fi[r])}else be(e,di(t))},bc=(e,t)=>{const n=unescape(encodeURIComponent(t)),r=n.length;$(e,r);for(let i=0;i<r;i++)Ee(e,n.codePointAt(i))},nt=Ln&&Ln.encodeInto?mc:bc,pr=(e,t)=>{const n=e.cbuf.length,r=e.cpos,i=ai(n-r,t.length),s=t.length-i;e.cbuf.set(t.subarray(0,i),r),e.cpos+=i,s>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(Ut(n*2,s)),e.cbuf.set(t.subarray(i)),e.cpos=s)},be=(e,t)=>{$(e,t.byteLength),pr(e,t)},gi=(e,t)=>{pc(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},wc=(e,t)=>gi(e,4).setFloat32(0,t,!1),yc=(e,t)=>gi(e,8).setFloat64(0,t,!1),vc=(e,t)=>gi(e,8).setBigInt64(0,t,!1),Us=new DataView(new ArrayBuffer(4)),kc=e=>(Us.setFloat32(0,e),Us.getFloat32(0)===e),rn=(e,t)=>{switch(typeof t){case"string":Ee(e,119),nt(e,t);break;case"number":oc(t)&&fr(t)<=sc?(Ee(e,125),ui(e,t)):kc(t)?(Ee(e,124),wc(e,t)):(Ee(e,123),yc(e,t));break;case"bigint":Ee(e,122),vc(e,t);break;case"object":if(t===null)Ee(e,126);else if(rc(t)){Ee(e,117),$(e,t.length);for(let n=0;n<t.length;n++)rn(e,t[n])}else if(t instanceof Uint8Array)Ee(e,116),be(e,t);else{Ee(e,118);const n=Object.keys(t);$(e,n.length);for(let r=0;r<n.length;r++){const i=n[r];nt(e,i),rn(e,t[i])}}break;case"boolean":Ee(e,t?120:121);break;default:Ee(e,127)}};class Fs extends Mn{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&$(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const Hs=e=>{e.count>0&&(ui(e.encoder,e.count===1?e.s:-e.s),e.count>1&&$(e.encoder,e.count-2))};class _r{constructor(){this.encoder=new Mn,this.s=0,this.count=0}write(t){this.s===t?this.count++:(Hs(this),this.count=1,this.s=t)}toUint8Array(){return Hs(this),me(this.encoder)}}const Vs=e=>{if(e.count>0){const t=e.diff*2+(e.count===1?0:1);ui(e.encoder,t),e.count>1&&$(e.encoder,e.count-2)}};class pi{constructor(){this.encoder=new Mn,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(Vs(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return Vs(this),me(this.encoder)}}class Ec{constructor(){this.sarr=[],this.s="",this.lensE=new _r}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new Mn;return this.sarr.push(this.s),this.s="",nt(t,this.sarr.join("")),pr(t,this.lensE.toUint8Array()),me(t)}}const rt=e=>new Error(e),it=()=>{throw rt("Method unimplemented")},He=()=>{throw rt("Unexpected case")},qs=rt("Unexpected end of array"),Zs=rt("Integer out of Range");class mr{constructor(t){this.arr=t,this.pos=0}}const st=e=>new mr(e),Cc=e=>e.pos!==e.arr.length,Sc=(e,t)=>{const n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},Ce=e=>Sc(e,X(e)),Ht=e=>e.arr[e.pos++],X=e=>{let t=0,n=1;const r=e.arr.length;for(;e.pos<r;){const i=e.arr[e.pos++];if(t=t+(i&Ft)*n,n*=128,i<Be)return t;if(t>Bs)throw Zs}throw qs},_i=e=>{let t=e.arr[e.pos++],n=t&hi,r=64;const i=(t&wt)>0?-1:1;if(!(t&Be))return i*n;const s=e.arr.length;for(;e.pos<s;){if(t=e.arr[e.pos++],n=n+(t&Ft)*r,r*=128,t<Be)return i*n;if(n>Bs)throw Zs}throw qs},xc=e=>{let t=X(e);if(t===0)return"";{let n=String.fromCodePoint(Ht(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(Ht(e));else for(;t>0;){const r=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,i),t-=r}return decodeURIComponent(escape(n))}},Rc=e=>Nn.decode(Ce(e)),yt=Nn?Rc:xc,mi=(e,t)=>{const n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},Tc=e=>mi(e,4).getFloat32(0,!1),Ac=e=>mi(e,8).getFloat64(0,!1),Dc=e=>mi(e,8).getBigInt64(0,!1),Lc=[e=>{},e=>null,_i,Tc,Ac,Dc,e=>!1,e=>!0,yt,e=>{const t=X(e),n={};for(let r=0;r<t;r++){const i=yt(e);n[i]=sn(e)}return n},e=>{const t=X(e),n=[];for(let r=0;r<t;r++)n.push(sn(e));return n},Ce],sn=e=>Lc[127-Ht(e)](e);class Ws extends mr{constructor(t,n){super(t),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),Cc(this)?this.count=X(this)+1:this.count=-1),this.count--,this.s}}class br extends mr{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=_i(this);const t=Is(this.s);this.count=1,t&&(this.s=-this.s,this.count=X(this)+2)}return this.count--,this.s}}class bi extends mr{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const t=_i(this),n=t&1;this.diff=tt(t/2),this.count=1,n&&(this.count=X(this)+2)}return this.s+=this.diff,this.count--,this.s}}class Nc{constructor(t){this.decoder=new br(t),this.str=yt(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),n=this.str.slice(this.spos,t);return this.spos=t,n}}const Mc=crypto.getRandomValues.bind(crypto),Oc=Math.random,Ks=()=>Mc(new Uint32Array(1))[0],Ic=[1e7]+-1e3+-4e3+-8e3+-1e11,Ys=()=>Ic.replace(/[018]/g,e=>(e^Ks()&15>>e/4).toString(16)),vt=Date.now,$s=e=>new Promise(e);Promise.all.bind(Promise);const Pc=e=>Promise.reject(e),wi=e=>Promise.resolve(e),zc=e=>e===void 0?null:e;class Bc{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}}let Js=new Bc,yi=!0;try{typeof localStorage<"u"&&localStorage&&(Js=localStorage,yi=!1)}catch{}const Gs=Js,jc=e=>yi||addEventListener("storage",e),Uc=e=>yi||removeEventListener("storage",e),Fc=Object.assign,Hc=Object.keys,Vc=(e,t)=>{for(const n in e)t(e[n],n)},wr=e=>Hc(e).length,qc=e=>{for(const t in e)return!1;return!0},Zc=(e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0},Xs=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Wc=(e,t)=>e===t||wr(e)===wr(t)&&Zc(e,(n,r)=>(n!==void 0||Xs(t,r))&&t[r]===n),vi=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&vi(e,t,n+1)}},Kc=()=>{},Yc=e=>e,$c=(e,t)=>e===t,In=(e,t)=>{if(e==null||t==null)return $c(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:{if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break}case Set:{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;break}case Map:{if(e.size!==t.size)return!1;for(const n of e.keys())if(!t.has(n)||!In(e.get(n),t.get(n)))return!1;break}case Object:if(wr(e)!==wr(t))return!1;for(const n in e)if(!Xs(e,n)||!In(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!In(e[n],t[n]))return!1;break;default:return!1}return!0},Jc=(e,t)=>t.includes(e),on=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",Qs=typeof window<"u"&&typeof document<"u"&&!on;let ot;const Gc=()=>{if(ot===void 0)if(on){ot=Je();const e=process.argv;let t=null;for(let n=0;n<e.length;n++){const r=e[n];r[0]==="-"?(t!==null&&ot.set(t,""),t=r):t!==null&&(ot.set(t,r),t=null)}t!==null&&ot.set(t,"")}else typeof location=="object"?(ot=Je(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){const[t,n]=e.split("=");ot.set(`--${js(t,"-")}`,n),ot.set(`-${js(t,"-")}`,n)}})):ot=Je();return ot},ki=e=>Gc().has(e),yr=e=>zc(on?process.env[e.toUpperCase()]:Gs.getItem(e));(e=>ki("--"+e)||yr(e)!==null)("production");const eo=on&&Jc({}.FORCE_COLOR,["true","1","2"]),Xc=!ki("no-colors")&&(!on||process.stdout.isTTY||eo)&&(!on||ki("color")||eo||yr("COLORTERM")!==null||(yr("TERM")||"").includes("color")),to=e=>new Uint8Array(e),Qc=(e,t,n)=>new Uint8Array(e,t,n),eh=e=>new Uint8Array(e),th=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=ac(e[n]);return btoa(t)},nh=e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),rh=e=>{const t=atob(e),n=to(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},ih=e=>{const t=Buffer.from(e,"base64");return Qc(t.buffer,t.byteOffset,t.byteLength)},no=Qs?th:nh,ro=Qs?rh:ih,sh=e=>{const t=to(e.byteLength);return t.set(e),t};class oh{constructor(t,n){this.left=t,this.right=n}}const kt=(e,t)=>new oh(e,t);typeof DOMParser<"u"&&new DOMParser;const ah=e=>ec(e,(t,n)=>`${n}:${t};`).join(""),Et=Symbol,Ve=Et(),Vt=Et(),io=Et(),Ei=Et(),so=Et(),oo=Et(),ao=Et(),Ci=Et(),vr=Et(),lh=e=>{const t=[];let n=0;for(;n<e.length;n++){const r=e[n];r.constructor===String||r.constructor===Number||r.constructor===Object&&t.push(JSON.stringify(r))}return t},lo=[so,ao,Ci,io];let Si=0,co=vt();const ch=(e,t)=>{const n=lo[Si],r=yr("log"),i=r!==null&&(r==="*"||r==="true"||new RegExp(r,"gi").test(t));return Si=(Si+1)%lo.length,t+=": ",i?(...s)=>{const l=vt(),a=l-co;co=l,e(n,t,vr,...s.map(c=>typeof c=="string"||typeof c=="symbol"?c:JSON.stringify(c)),n," +"+a+"ms")}:Kc},hh={[Ve]:kt("font-weight","bold"),[Vt]:kt("font-weight","normal"),[io]:kt("color","blue"),[so]:kt("color","green"),[Ei]:kt("color","grey"),[oo]:kt("color","red"),[ao]:kt("color","purple"),[Ci]:kt("color","orange"),[vr]:kt("color","black")},dh=e=>{const t=[],n=[],r=Je();let i=[],s=0;for(;s<e.length;s++){const l=e[s],a=hh[l];if(a!==void 0)r.set(a.left,a.right);else if(l.constructor===String||l.constructor===Number){const c=ah(r);s>0||c.length>0?(t.push("%c"+l),n.push(c)):t.push(l)}else break}for(s>0&&(i=n,i.unshift(t.join("")));s<e.length;s++){const l=e[s];l instanceof Symbol||i.push(l)}return i},uh=Xc?dh:lh,ho=(...e)=>{console.log(...uh(e)),fh.forEach(t=>t.print(e))},fh=jt(),gh=e=>ch(ho,e),uo=e=>({[Symbol.iterator](){return this},next:e}),ph=(e,t)=>uo(()=>{let n;do n=e.next();while(!n.done&&!t(n.value));return n}),xi=(e,t)=>uo(()=>{const{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}});class Ri{constructor(t,n){this.clock=t,this.len=n}}class Pn{constructor(){this.clients=new Map}}const fo=(e,t,n)=>t.clients.forEach((r,i)=>{const s=e.doc.store.clients.get(i);for(let l=0;l<r.length;l++){const a=r[l];No(e,s,a.clock,a.len,n)}}),_h=(e,t)=>{let n=0,r=e.length-1;for(;n<=r;){const i=tt((n+r)/2),s=e[i],l=s.clock;if(l<=t){if(t<l+s.len)return i;n=i+1}else r=i-1}return null},go=(e,t)=>{const n=e.clients.get(t.client);return n!==void 0&&_h(n,t.clock)!==null},Ti=e=>{e.clients.forEach(t=>{t.sort((i,s)=>i.clock-s.clock);let n,r;for(n=1,r=1;n<t.length;n++){const i=t[r-1],s=t[n];i.clock+i.len>=s.clock?i.len=Ut(i.len,s.clock+s.len-i.clock):(r<n&&(t[r]=s),r++)}t.length=r})},mh=e=>{const t=new Pn;for(let n=0;n<e.length;n++)e[n].clients.forEach((r,i)=>{if(!t.clients.has(i)){const s=r.slice();for(let l=n+1;l<e.length;l++)nc(s,e[l].clients.get(i)||[]);t.clients.set(i,s)}});return Ti(t),t},kr=(e,t,n,r)=>{Fe(e.clients,t,()=>[]).push(new Ri(n,r))},bh=()=>new Pn,wh=e=>{const t=bh();return e.clients.forEach((n,r)=>{const i=[];for(let s=0;s<n.length;s++){const l=n[s];if(l.deleted){const a=l.id.clock;let c=l.length;if(s+1<n.length)for(let h=n[s+1];s+1<n.length&&h.deleted;h=n[++s+1])c+=h.length;i.push(new Ri(a,c))}}i.length>0&&t.clients.set(r,i)}),t},an=(e,t)=>{$(e.restEncoder,t.clients.size),Tt(t.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{e.resetDsCurVal(),$(e.restEncoder,n);const i=r.length;$(e.restEncoder,i);for(let s=0;s<i;s++){const l=r[s];e.writeDsClock(l.clock),e.writeDsLen(l.len)}})},Ai=e=>{const t=new Pn,n=X(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();const i=X(e.restDecoder),s=X(e.restDecoder);if(s>0){const l=Fe(t.clients,i,()=>[]);for(let a=0;a<s;a++)l.push(new Ri(e.readDsClock(),e.readDsLen()))}}return t},po=(e,t,n)=>{const r=new Pn,i=X(e.restDecoder);for(let s=0;s<i;s++){e.resetDsCurVal();const l=X(e.restDecoder),a=X(e.restDecoder),c=n.clients.get(l)||[],h=ye(n,l);for(let u=0;u<a;u++){const f=e.readDsClock(),p=f+e.readDsLen();if(f<h){h<p&&kr(r,l,h,p-h);let g=at(c,f),m=c[g];for(!m.deleted&&m.id.clock<f&&(c.splice(g+1,0,Fr(t,m,f-m.id.clock)),g++);g<c.length&&(m=c[g++],m.id.clock<p);)m.deleted||(p<m.id.clock+m.length&&c.splice(g,0,Fr(t,m,p-m.id.clock)),m.delete(t))}else kr(r,l,f,p-f)}}if(r.clients.size>0){const s=new qt;return $(s.restEncoder,0),an(s,r),s.toUint8Array()}return null},_o=Ks;class ln extends ur{constructor({guid:t=Ys(),collectionid:n=null,gc:r=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:l=!1,shouldLoad:a=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=_o(),this.guid=t,this.collectionid=n,this.share=new Map,this.store=new Ao,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=l,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=$s(h=>{this.on("load",()=>{this.isLoaded=!0,h(this)})});const c=()=>$s(h=>{const u=f=>{(f===void 0||f===!0)&&(this.off("sync",u),h())};this.on("sync",u)});this.on("sync",h=>{h===!1&&this.isSynced&&(this.whenSynced=c()),this.isSynced=h===void 0||h===!0,this.isLoaded||this.emit("load",[])}),this.whenSynced=c()}load(){const t=this._item;t!==null&&!this.shouldLoad&&ge(t.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Tt(this.subdocs).map(t=>t.guid))}transact(t,n=null){return ge(this,t,n)}get(t,n=Ae){const r=Fe(this.share,t,()=>{const s=new n;return s._integrate(this,null),s}),i=r.constructor;if(n!==Ae&&i!==n)if(i===Ae){const s=new n;s._map=r._map,r._map.forEach(l=>{for(;l!==null;l=l.left)l.parent=s}),s._start=r._start;for(let l=s._start;l!==null;l=l.right)l.parent=s;return s._length=r._length,this.share.set(t,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return r}getArray(t=""){return this.get(t,dn)}getText(t=""){return this.get(t,gn)}getMap(t=""){return this.get(t,un)}getXmlFragment(t=""){return this.get(t,Zt)}toJSON(){const t={};return this.share.forEach((n,r)=>{t[r]=n.toJSON()}),t}destroy(){Tt(this.subdocs).forEach(n=>n.destroy());const t=this._item;if(t!==null){this._item=null;const n=t.content;n.doc=new ln({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=t,ge(t.parent.doc,r=>{const i=n.doc;t.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,n){super.on(t,n)}off(t,n){super.off(t,n)}}class mo{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return X(this.restDecoder)}readDsLen(){return X(this.restDecoder)}}class bo extends mo{readLeftID(){return re(X(this.restDecoder),X(this.restDecoder))}readRightID(){return re(X(this.restDecoder),X(this.restDecoder))}readClient(){return X(this.restDecoder)}readInfo(){return Ht(this.restDecoder)}readString(){return yt(this.restDecoder)}readParentInfo(){return X(this.restDecoder)===1}readTypeRef(){return X(this.restDecoder)}readLen(){return X(this.restDecoder)}readAny(){return sn(this.restDecoder)}readBuf(){return sh(Ce(this.restDecoder))}readJSON(){return JSON.parse(yt(this.restDecoder))}readKey(){return yt(this.restDecoder)}}class yh{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=X(this.restDecoder),this.dsCurrVal}readDsLen(){const t=X(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class cn extends yh{constructor(t){super(t),this.keys=[],X(t),this.keyClockDecoder=new bi(Ce(t)),this.clientDecoder=new br(Ce(t)),this.leftClockDecoder=new bi(Ce(t)),this.rightClockDecoder=new bi(Ce(t)),this.infoDecoder=new Ws(Ce(t),Ht),this.stringDecoder=new Nc(Ce(t)),this.parentInfoDecoder=new Ws(Ce(t),Ht),this.typeRefDecoder=new br(Ce(t)),this.lenDecoder=new br(Ce(t))}readLeftID(){return new hn(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new hn(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return sn(this.restDecoder)}readBuf(){return Ce(this.restDecoder)}readJSON(){return sn(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class wo{constructor(){this.restEncoder=ke()}toUint8Array(){return me(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){$(this.restEncoder,t)}writeDsLen(t){$(this.restEncoder,t)}}class zn extends wo{writeLeftID(t){$(this.restEncoder,t.client),$(this.restEncoder,t.clock)}writeRightID(t){$(this.restEncoder,t.client),$(this.restEncoder,t.clock)}writeClient(t){$(this.restEncoder,t)}writeInfo(t){On(this.restEncoder,t)}writeString(t){nt(this.restEncoder,t)}writeParentInfo(t){$(this.restEncoder,t?1:0)}writeTypeRef(t){$(this.restEncoder,t)}writeLen(t){$(this.restEncoder,t)}writeAny(t){rn(this.restEncoder,t)}writeBuf(t){be(this.restEncoder,t)}writeJSON(t){nt(this.restEncoder,JSON.stringify(t))}writeKey(t){nt(this.restEncoder,t)}}class yo{constructor(){this.restEncoder=ke(),this.dsCurrVal=0}toUint8Array(){return me(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const n=t-this.dsCurrVal;this.dsCurrVal=t,$(this.restEncoder,n)}writeDsLen(t){t===0&&He(),$(this.restEncoder,t-1),this.dsCurrVal+=t}}class qt extends yo{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new pi,this.clientEncoder=new _r,this.leftClockEncoder=new pi,this.rightClockEncoder=new pi,this.infoEncoder=new Fs(On),this.stringEncoder=new Ec,this.parentInfoEncoder=new Fs(On),this.typeRefEncoder=new _r,this.lenEncoder=new _r}toUint8Array(){const t=ke();return $(t,0),be(t,this.keyClockEncoder.toUint8Array()),be(t,this.clientEncoder.toUint8Array()),be(t,this.leftClockEncoder.toUint8Array()),be(t,this.rightClockEncoder.toUint8Array()),be(t,me(this.infoEncoder)),be(t,this.stringEncoder.toUint8Array()),be(t,me(this.parentInfoEncoder)),be(t,this.typeRefEncoder.toUint8Array()),be(t,this.lenEncoder.toUint8Array()),pr(t,me(this.restEncoder)),me(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){rn(this.restEncoder,t)}writeBuf(t){be(this.restEncoder,t)}writeJSON(t){rn(this.restEncoder,t)}writeKey(t){const n=this.keyMap.get(t);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(n)}}const vh=(e,t,n,r)=>{r=Ut(r,t[0].id.clock);const i=at(t,r);$(e.restEncoder,t.length-i),e.writeClient(n),$(e.restEncoder,r);const s=t[i];s.write(e,r-s.id.clock);for(let l=i+1;l<t.length;l++)t[l].write(e,0)},Di=(e,t,n)=>{const r=new Map;n.forEach((i,s)=>{ye(t,s)>i&&r.set(s,i)}),Rr(t).forEach((i,s)=>{n.has(s)||r.set(s,0)}),$(e.restEncoder,r.size),Tt(r.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{vh(e,t.clients.get(i),i,s)})},kh=(e,t)=>{const n=Je(),r=X(e.restDecoder);for(let i=0;i<r;i++){const s=X(e.restDecoder),l=new Array(s),a=e.readClient();let c=X(e.restDecoder);n.set(a,{i:0,refs:l});for(let h=0;h<s;h++){const u=e.readInfo();switch(gr&u){case 0:{const f=e.readLen();l[h]=new qe(re(a,c),f),c+=f;break}case 10:{const f=X(e.restDecoder);l[h]=new Ze(re(a,c),f),c+=f;break}default:{const f=(u&(wt|Be))===0,p=new we(re(a,c),null,(u&Be)===Be?e.readLeftID():null,null,(u&wt)===wt?e.readRightID():null,f?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,f&&(u&Dn)===Dn?e.readString():null,ia(e,u));l[h]=p,c+=p.length}}}}return n},Eh=(e,t,n)=>{const r=[];let i=Tt(n.keys()).sort((g,m)=>g-m);if(i.length===0)return null;const s=()=>{if(i.length===0)return null;let g=n.get(i[i.length-1]);for(;g.refs.length===g.i;)if(i.pop(),i.length>0)g=n.get(i[i.length-1]);else return null;return g};let l=s();if(l===null&&r.length===0)return null;const a=new Ao,c=new Map,h=(g,m)=>{const k=c.get(g);(k==null||k>m)&&c.set(g,m)};let u=l.refs[l.i++];const f=new Map,p=()=>{for(const g of r){const m=g.id.client,k=n.get(m);k?(k.i--,a.clients.set(m,k.refs.slice(k.i)),n.delete(m),k.i=0,k.refs=[]):a.clients.set(m,[g]),i=i.filter(L=>L!==m)}r.length=0};for(;;){if(u.constructor!==Ze){const g=Fe(f,u.id.client,()=>ye(t,u.id.client))-u.id.clock;if(g<0)r.push(u),h(u.id.client,u.id.clock-1),p();else{const m=u.getMissing(e,t);if(m!==null){r.push(u);const k=n.get(m)||{refs:[],i:0};if(k.refs.length===k.i)h(m,ye(t,m)),p();else{u=k.refs[k.i++];continue}}else(g===0||g<u.length)&&(u.integrate(e,g),f.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(l!==null&&l.i<l.refs.length)u=l.refs[l.i++];else{if(l=s(),l===null)break;u=l.refs[l.i++]}}if(a.clients.size>0){const g=new qt;return Di(g,a,new Map),$(g.restEncoder,0),{missing:c,update:g.toUint8Array()}}return null},Ch=(e,t)=>Di(e,t.doc.store,t.beforeState),Sh=(e,t,n,r=new cn(e))=>ge(t,i=>{i.local=!1;let s=!1;const l=i.doc,a=l.store,c=kh(r,l),h=Eh(i,a,c),u=a.pendingStructs;if(u){for(const[p,g]of u.missing)if(g<ye(a,p)){s=!0;break}if(h){for(const[p,g]of h.missing){const m=u.missing.get(p);(m==null||m>g)&&u.missing.set(p,g)}u.update=Dr([u.update,h.update])}}else a.pendingStructs=h;const f=po(r,i,a);if(a.pendingDs){const p=new cn(st(a.pendingDs));X(p.restDecoder);const g=po(p,i,a);f&&g?a.pendingDs=Dr([f,g]):a.pendingDs=f||g}else a.pendingDs=f;if(s){const p=a.pendingStructs.update;a.pendingStructs=null,vo(i.doc,p)}},n,!1),vo=(e,t,n,r=cn)=>{const i=st(t);Sh(i,e,n,new r(i))},xh=(e,t,n)=>vo(e,t,n,bo),Rh=(e,t,n=new Map)=>{Di(e,t.store,n),an(e,wh(t.store))},Th=(e,t=new Uint8Array([0]),n=new qt)=>{const r=ko(t);Rh(n,e,r);const i=[n.toUint8Array()];if(e.store.pendingDs&&i.push(e.store.pendingDs),e.store.pendingStructs&&i.push(Wh(e.store.pendingStructs.update,t)),i.length>1){if(n.constructor===zn)return qh(i.map((s,l)=>l===0?s:Yh(s)));if(n.constructor===qt)return Dr(i)}return i[0]},Ah=(e,t)=>Th(e,t,new zn),Dh=e=>{const t=new Map,n=X(e.restDecoder);for(let r=0;r<n;r++){const i=X(e.restDecoder),s=X(e.restDecoder);t.set(i,s)}return t},ko=e=>Dh(new mo(st(e))),Eo=(e,t)=>($(e.restEncoder,t.size),Tt(t.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{$(e.restEncoder,n),$(e.restEncoder,r)}),e),Lh=(e,t)=>Eo(e,Rr(t.store)),Nh=(e,t=new yo)=>(e instanceof Map?Eo(t,e):Lh(t,e),t.toUint8Array()),Mh=e=>Nh(e,new wo);class Oh{constructor(){this.l=[]}}const Co=()=>new Oh,So=(e,t)=>e.l.push(t),xo=(e,t)=>{const n=e.l,r=n.length;e.l=n.filter(i=>t!==i),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Ro=(e,t,n)=>vi(e.l,[t,n]);class hn{constructor(t,n){this.client=t,this.clock=n}}const Er=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,re=(e,t)=>new hn(e,t),To=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw He()};class Ih{constructor(t,n,r,i=0){this.type=t,this.tname=n,this.item=r,this.assoc=i}}class Ph{constructor(t,n,r=0){this.type=t,this.index=n,this.assoc=r}}const zh=(e,t,n=0)=>new Ph(e,t,n),Cr=(e,t,n)=>{let r=null,i=null;return e._item===null?i=To(e):r=re(e._item.id.client,e._item.id.clock),new Ih(r,i,t,n)},Sr=(e,t,n=0)=>{let r=e._start;if(n<0){if(t===0)return Cr(e,null,n);t--}for(;r!==null;){if(!r.deleted&&r.countable){if(r.length>t)return Cr(e,re(r.id.client,r.id.clock+t),n);t-=r.length}if(r.right===null&&n<0)return Cr(e,r.lastId,n);r=r.right}return Cr(e,null,n)},xr=(e,t)=>{const n=t.store,r=e.item,i=e.type,s=e.tname,l=e.assoc;let a=null,c=0;if(r!==null){if(ye(n,r.client)<=r.clock)return null;const h=ra(n,r),u=h.item;if(!(u instanceof we))return null;if(a=u.parent,a._item===null||!a._item.deleted){c=u.deleted||!u.countable?0:h.diff+(l>=0?0:1);let f=u.left;for(;f!==null;)!f.deleted&&f.countable&&(c+=f.length),f=f.left}}else{if(s!==null)a=t.get(s);else if(i!==null){if(ye(n,i.client)<=i.clock)return null;const{item:h}=ra(n,i);if(h instanceof we&&h.content instanceof ct)a=h.content.type;else return null}else throw He();l>=0?c=a._length:c=0}return zh(a,c,e.assoc)},Bn=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!go(t.ds,e.id),Li=(e,t)=>{const n=Fe(e.meta,Li,jt),r=e.doc.store;n.has(t)||(t.sv.forEach((i,s)=>{i<ye(r,s)&&At(e,re(s,i))}),fo(e,t.ds,i=>{}),n.add(t))};class Ao{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Rr=e=>{const t=new Map;return e.clients.forEach((n,r)=>{const i=n[n.length-1];t.set(r,i.id.clock+i.length)}),t},ye=(e,t)=>{const n=e.clients.get(t);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},Do=(e,t)=>{let n=e.clients.get(t.id.client);if(n===void 0)n=[],e.clients.set(t.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==t.id.clock)throw He()}n.push(t)},at=(e,t)=>{let n=0,r=e.length-1,i=e[r],s=i.id.clock;if(s===t)return r;let l=tt(t/(s+i.length-1)*r);for(;n<=r;){if(i=e[l],s=i.id.clock,s<=t){if(t<s+i.length)return l;n=l+1}else r=l-1;l=tt((n+r)/2)}throw He()},Bh=(e,t)=>{const n=e.clients.get(t.client);return n[at(n,t.clock)]},Tr=Bh,Ni=(e,t,n)=>{const r=at(t,n),i=t[r];return i.id.clock<n&&i instanceof we?(t.splice(r+1,0,Fr(e,i,n-i.id.clock)),r+1):r},At=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[Ni(e,n,t.clock)]},Lo=(e,t,n)=>{const r=t.clients.get(n.client),i=at(r,n.clock),s=r[i];return n.clock!==s.id.clock+s.length-1&&s.constructor!==qe&&r.splice(i+1,0,Fr(e,s,n.clock-s.id.clock+1)),s},jh=(e,t,n)=>{const r=e.clients.get(t.id.client);r[at(r,t.id.clock)]=n},No=(e,t,n,r,i)=>{if(r===0)return;const s=n+r;let l=Ni(e,t,n),a;do a=t[l++],s<a.id.clock+a.length&&Ni(e,t,s),i(a);while(l<t.length&&t[l].id.clock<s)};class Uh{constructor(t,n,r){this.doc=t,this.deleteSet=new Pn,this.beforeState=Rr(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const Mo=(e,t)=>t.deleteSet.clients.size===0&&!tc(t.afterState,(n,r)=>t.beforeState.get(r)!==n)?!1:(Ti(t.deleteSet),Ch(e,t),an(e,t.deleteSet),!0),Oo=(e,t,n)=>{const r=t._item;(r===null||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&Fe(e.changed,t,jt).add(n)},Ar=(e,t)=>{let n=e[t],r=e[t-1],i=t;for(;i>0;n=r,r=e[--i-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof we&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const s=t-i;return s&&e.splice(t+1-s,s),s},Fh=(e,t,n)=>{for(const[r,i]of e.clients.entries()){const s=t.clients.get(r);for(let l=i.length-1;l>=0;l--){const a=i[l],c=a.clock+a.len;for(let h=at(s,a.clock),u=s[h];h<s.length&&u.id.clock<c;u=s[++h]){const f=s[h];if(a.clock+a.len<=f.id.clock)break;f instanceof we&&f.deleted&&!f.keep&&n(f)&&f.gc(t,!1)}}}},Hh=(e,t)=>{e.clients.forEach((n,r)=>{const i=t.clients.get(r);for(let s=n.length-1;s>=0;s--){const l=n[s],a=ai(i.length-1,1+at(i,l.clock+l.len-1));for(let c=a,h=i[c];c>0&&h.id.clock>=l.clock;h=i[c])c-=1+Ar(i,c)}})},Io=(e,t)=>{if(t<e.length){const n=e[t],r=n.doc,i=r.store,s=n.deleteSet,l=n._mergeStructs;try{Ti(s),n.afterState=Rr(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const a=[];n.changed.forEach((c,h)=>a.push(()=>{(h._item===null||!h._item.deleted)&&h._callObserver(n,c)})),a.push(()=>{n.changedParentTypes.forEach((c,h)=>{h._dEH.l.length>0&&(h._item===null||!h._item.deleted)&&(c=c.filter(u=>u.target._item===null||!u.target._item.deleted),c.forEach(u=>{u.currentTarget=h,u._path=null}),c.sort((u,f)=>u.path.length-f.path.length),Ro(h._dEH,c,n))})}),a.push(()=>r.emit("afterTransaction",[n,r])),vi(a,[]),n._needFormattingCleanup&&ad(n)}finally{r.gc&&Fh(s,i,r.gcFilter),Hh(s,i),n.afterState.forEach((u,f)=>{const p=n.beforeState.get(f)||0;if(p!==u){const g=i.clients.get(f),m=Ut(at(g,p),1);for(let k=g.length-1;k>=m;)k-=1+Ar(g,k)}});for(let u=l.length-1;u>=0;u--){const{client:f,clock:p}=l[u].id,g=i.clients.get(f),m=at(g,p);m+1<g.length&&Ar(g,m+1)>1||m>0&&Ar(g,m)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(ho(Ci,Ve,"[yjs] ",Vt,oo,"Changed the client-id because another client seems to be using it."),r.clientID=_o()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const u=new zn;Mo(u,n)&&r.emit("update",[u.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const u=new qt;Mo(u,n)&&r.emit("updateV2",[u.toUint8Array(),n.origin,r,n])}const{subdocsAdded:a,subdocsLoaded:c,subdocsRemoved:h}=n;(a.size>0||h.size>0||c.size>0)&&(a.forEach(u=>{u.clientID=r.clientID,u.collectionid==null&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),h.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:c,added:a,removed:h},r,n]),h.forEach(u=>u.destroy())),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):Io(e,t+1)}}},ge=(e,t,n=null,r=!0)=>{const i=e._transactionCleanups;let s=!1,l=null;e._transaction===null&&(s=!0,e._transaction=new Uh(e,n,r),i.push(e._transaction),i.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{l=t(e._transaction)}finally{if(s){const a=e._transaction===i[0];e._transaction=null,a&&Io(i,0)}}return l};function*Vh(e){const t=X(e.restDecoder);for(let n=0;n<t;n++){const r=X(e.restDecoder),i=e.readClient();let s=X(e.restDecoder);for(let l=0;l<r;l++){const a=e.readInfo();if(a===10){const c=X(e.restDecoder);yield new Ze(re(i,s),c),s+=c}else if(gr&a){const c=(a&(wt|Be))===0,h=new we(re(i,s),null,(a&Be)===Be?e.readLeftID():null,null,(a&wt)===wt?e.readRightID():null,c?e.readParentInfo()?e.readString():e.readLeftID():null,c&&(a&Dn)===Dn?e.readString():null,ia(e,a));yield h,s+=h.length}else{const c=e.readLen();yield new qe(re(i,s),c),s+=c}}}}class Mi{constructor(t,n){this.gen=Vh(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Ze);return this.curr}}class Oi{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const qh=e=>Dr(e,bo,zn),Zh=(e,t)=>{if(e.constructor===qe){const{client:n,clock:r}=e.id;return new qe(re(n,r+t),e.length-t)}else if(e.constructor===Ze){const{client:n,clock:r}=e.id;return new Ze(re(n,r+t),e.length-t)}else{const n=e,{client:r,clock:i}=n.id;return new we(re(r,i+t),null,re(r,i+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},Dr=(e,t=cn,n=qt)=>{if(e.length===1)return e[0];const r=e.map(u=>new t(st(u)));let i=r.map(u=>new Mi(u,!0)),s=null;const l=new n,a=new Oi(l);for(;i=i.filter(u=>u.curr!==null),i.sort((u,f)=>{if(u.curr.id.client===f.curr.id.client){const p=u.curr.id.clock-f.curr.id.clock;return p===0?u.curr.constructor===f.curr.constructor?0:u.curr.constructor===Ze?1:-1:p}else return f.curr.id.client-u.curr.id.client}),i.length!==0;){const u=i[0],f=u.curr.id.client;if(s!==null){let p=u.curr,g=!1;for(;p!==null&&p.id.clock+p.length<=s.struct.id.clock+s.struct.length&&p.id.client>=s.struct.id.client;)p=u.next(),g=!0;if(p===null||p.id.client!==f||g&&p.id.clock>s.struct.id.clock+s.struct.length)continue;if(f!==s.struct.id.client)Dt(a,s.struct,s.offset),s={struct:p,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<p.id.clock)if(s.struct.constructor===Ze)s.struct.length=p.id.clock+p.length-s.struct.id.clock;else{Dt(a,s.struct,s.offset);const m=p.id.clock-s.struct.id.clock-s.struct.length;s={struct:new Ze(re(f,s.struct.id.clock+s.struct.length),m),offset:0}}else{const m=s.struct.id.clock+s.struct.length-p.id.clock;m>0&&(s.struct.constructor===Ze?s.struct.length-=m:p=Zh(p,m)),s.struct.mergeWith(p)||(Dt(a,s.struct,s.offset),s={struct:p,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let p=u.curr;p!==null&&p.id.client===f&&p.id.clock===s.struct.id.clock+s.struct.length&&p.constructor!==Ze;p=u.next())Dt(a,s.struct,s.offset),s={struct:p,offset:0}}s!==null&&(Dt(a,s.struct,s.offset),s=null),Ii(a);const c=r.map(u=>Ai(u)),h=mh(c);return an(l,h),l.toUint8Array()},Wh=(e,t,n=cn,r=qt)=>{const i=ko(t),s=new r,l=new Oi(s),a=new n(st(e)),c=new Mi(a,!1);for(;c.curr;){const u=c.curr,f=u.id.client,p=i.get(f)||0;if(c.curr.constructor===Ze){c.next();continue}if(u.id.clock+u.length>p)for(Dt(l,u,Ut(p-u.id.clock,0)),c.next();c.curr&&c.curr.id.client===f;)Dt(l,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===f&&c.curr.id.clock+c.curr.length<=p;)c.next()}Ii(l);const h=Ai(a);return an(s,h),s.toUint8Array()},Po=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:me(e.encoder.restEncoder)}),e.encoder.restEncoder=ke(),e.written=0)},Dt=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&Po(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),$(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},Ii=e=>{Po(e);const t=e.encoder.restEncoder;$(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const r=e.clientStructs[n];$(t,r.written),pr(t,r.restEncoder)}},Kh=(e,t,n,r)=>{const i=new n(st(e)),s=new Mi(i,!1),l=new r,a=new Oi(l);for(let h=s.curr;h!==null;h=s.next())Dt(a,t(h),0);Ii(a);const c=Ai(i);return an(l,c),l.toUint8Array()},Yh=e=>Kh(e,Yc,cn,zn),zo="You must not compute changes after the event-handler fired.";class Lr{constructor(t,n){this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=$h(this.currentTarget,this.target))}deletes(t){return go(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw rt(zo);const t=new Map,n=this.target;this.transaction.changed.get(n).forEach(r=>{if(r!==null){const i=n._map.get(r);let s,l;if(this.adds(i)){let a=i.left;for(;a!==null&&this.adds(a);)a=a.left;if(this.deletes(i))if(a!==null&&this.deletes(a))s="delete",l=oi(a.content.getContent());else return;else a!==null&&this.deletes(a)?(s="update",l=oi(a.content.getContent())):(s="add",l=void 0)}else if(this.deletes(i))s="delete",l=oi(i.content.getContent());else return;t.set(r,{action:s,oldValue:l})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw rt(zo);const n=this.target,r=jt(),i=jt(),s=[];if(t={added:r,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(n).has(null)){let l=null;const a=()=>{l&&s.push(l)};for(let c=n._start;c!==null;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&((l===null||l.delete===void 0)&&(a(),l={delete:0}),l.delete+=c.length,i.add(c)):this.adds(c)?((l===null||l.insert===void 0)&&(a(),l={insert:[]}),l.insert=l.insert.concat(c.content.getContent()),r.add(c)):((l===null||l.retain===void 0)&&(a(),l={retain:0}),l.retain+=c.length);l!==null&&l.retain===void 0&&a()}this._changes=t}return t}}const $h=(e,t)=>{const n=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)n.unshift(t._item.parentSub);else{let r=0,i=t._item.parent._start;for(;i!==t._item&&i!==null;)i.deleted||r++,i=i.right;n.unshift(r)}t=t._item.parent}return n},Bo=80;let Pi=0;class Jh{constructor(t,n){t.marker=!0,this.p=t,this.index=n,this.timestamp=Pi++}}const Gh=e=>{e.timestamp=Pi++},jo=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=Pi++},Xh=(e,t,n)=>{if(e.length>=Bo){const r=e.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return jo(r,t,n),r}else{const r=new Jh(t,n);return e.push(r),r}},Nr=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;const n=e._searchMarker.length===0?null:e._searchMarker.reduce((s,l)=>fr(t-s.index)<fr(t-l.index)?s:l);let r=e._start,i=0;for(n!==null&&(r=n.p,i=n.index,Gh(n));r.right!==null&&i<t;){if(!r.deleted&&r.countable){if(t<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>t;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return n!==null&&fr(n.index-i)<r.parent.length/Bo?(jo(n,r,i),n):Xh(e._searchMarker,r,i)},jn=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){const i=e[r];if(n>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){e.splice(r,1);continue}i.p=s,s.marker=!0}(t<i.index||n>0&&t===i.index)&&(i.index=Ut(t,i.index+n))}},Mr=(e,t,n)=>{const r=e,i=t.changedParentTypes;for(;Fe(i,e,()=>[]).push(n),e._item!==null;)e=e._item.parent;Ro(r._eH,n,t)};class Ae{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Co(),this._dEH=Co(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,n){this.doc=t,this._item=n}_copy(){throw it()}clone(){throw it()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,n){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){So(this._eH,t)}observeDeep(t){So(this._dEH,t)}unobserve(t){xo(this._eH,t)}unobserveDeep(t){xo(this._dEH,t)}toJSON(){}}const Uo=(e,t,n)=>{t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t;const i=[];let s=e._start;for(;s!==null&&r>0;){if(s.countable&&!s.deleted){const l=s.content.getContent();if(l.length<=t)t-=l.length;else{for(let a=t;a<l.length&&r>0;a++)i.push(l[a]),r--;t=0}}s=s.right}return i},Fo=e=>{const t=[];let n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let i=0;i<r.length;i++)t.push(r[i])}n=n.right}return t},Un=(e,t)=>{let n=0,r=e._start;for(;r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let s=0;s<i.length;s++)t(i[s],n++,e)}r=r.right}},Ho=(e,t)=>{const n=[];return Un(e,(r,i)=>{n.push(t(r,i,e))}),n},Qh=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}const i=n[r++];return n.length<=r&&(n=null),{done:!1,value:i}}}},Vo=(e,t)=>{const n=Nr(e,t);let r=e._start;for(n!==null&&(r=n.p,t-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},Or=(e,t,n,r)=>{let i=n;const s=e.doc,l=s.clientID,a=s.store,c=n===null?t._start:n.right;let h=[];const u=()=>{h.length>0&&(i=new we(re(l,ye(a,l)),i,i&&i.lastId,c,c&&c.id,t,null,new Kt(h)),i.integrate(e,0),h=[])};r.forEach(f=>{if(f===null)h.push(f);else switch(f.constructor){case Number:case Object:case Boolean:case Array:case String:h.push(f);break;default:switch(u(),f.constructor){case Uint8Array:case ArrayBuffer:i=new we(re(l,ye(a,l)),i,i&&i.lastId,c,c&&c.id,t,null,new Hn(new Uint8Array(f))),i.integrate(e,0);break;case ln:i=new we(re(l,ye(a,l)),i,i&&i.lastId,c,c&&c.id,t,null,new qn(f)),i.integrate(e,0);break;default:if(f instanceof Ae)i=new we(re(l,ye(a,l)),i,i&&i.lastId,c,c&&c.id,t,null,new ct(f)),i.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},qo=()=>rt("Length exceeded!"),Zo=(e,t,n,r)=>{if(n>t._length)throw qo();if(n===0)return t._searchMarker&&jn(t._searchMarker,n,r.length),Or(e,t,null,r);const i=n,s=Nr(t,n);let l=t._start;for(s!==null&&(l=s.p,n-=s.index,n===0&&(l=l.prev,n+=l&&l.countable&&!l.deleted?l.length:0));l!==null;l=l.right)if(!l.deleted&&l.countable){if(n<=l.length){n<l.length&&At(e,re(l.id.client,l.id.clock+n));break}n-=l.length}return t._searchMarker&&jn(t._searchMarker,i,r.length),Or(e,t,l,r)},ed=(e,t,n)=>{let r=(t._searchMarker||[]).reduce((i,s)=>s.index>i.index?s:i,{index:0,p:t._start}).p;if(r)for(;r.right;)r=r.right;return Or(e,t,r,n)},Wo=(e,t,n,r)=>{if(r===0)return;const i=n,s=r,l=Nr(t,n);let a=t._start;for(l!==null&&(a=l.p,n-=l.index);a!==null&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&At(e,re(a.id.client,a.id.clock+n)),n-=a.length);for(;r>0&&a!==null;)a.deleted||(r<a.length&&At(e,re(a.id.client,a.id.clock+r)),a.delete(e),r-=a.length),a=a.right;if(r>0)throw qo();t._searchMarker&&jn(t._searchMarker,i,-s+r)},Ir=(e,t,n)=>{const r=t._map.get(n);r!==void 0&&r.delete(e)},zi=(e,t,n,r)=>{const i=t._map.get(n)||null,s=e.doc,l=s.clientID;let a;if(r==null)a=new Kt([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:a=new Kt([r]);break;case Uint8Array:a=new Hn(r);break;case ln:a=new qn(r);break;default:if(r instanceof Ae)a=new ct(r);else throw new Error("Unexpected content type")}new we(re(l,ye(s.store,l)),i,i&&i.lastId,null,null,t,n,a).integrate(e,0)},Bi=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},Ko=e=>{const t={};return e._map.forEach((n,r)=>{n.deleted||(t[r]=n.content.getContent()[n.length-1])}),t},Yo=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted},Pr=e=>ph(e.entries(),t=>!t[1].deleted);class td extends Lr{constructor(t,n){super(t,n),this._transaction=n}}class dn extends Ae{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const n=new dn;return n.push(t),n}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new dn}clone(){const t=new dn;return t.insert(0,this.toArray().map(n=>n instanceof Ae?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,n){super._callObserver(t,n),Mr(this,t,new td(this,t))}insert(t,n){this.doc!==null?ge(this.doc,r=>{Zo(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}push(t){this.doc!==null?ge(this.doc,n=>{ed(n,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,n=1){this.doc!==null?ge(this.doc,r=>{Wo(r,this,t,n)}):this._prelimContent.splice(t,n)}get(t){return Vo(this,t)}toArray(){return Fo(this)}slice(t=0,n=this.length){return Uo(this,t,n)}toJSON(){return this.map(t=>t instanceof Ae?t.toJSON():t)}map(t){return Ho(this,t)}forEach(t){Un(this,t)}[Symbol.iterator](){return Qh(this)}_write(t){t.writeTypeRef(Sd)}}const nd=e=>new dn;class rd extends Lr{constructor(t,n,r){super(t,n),this.keysChanged=r}}class un extends Ae{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,n){super._integrate(t,n),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new un}clone(){const t=new un;return this.forEach((n,r)=>{t.set(r,n instanceof Ae?n.clone():n)}),t}_callObserver(t,n){Mr(this,t,new rd(this,t,n))}toJSON(){const t={};return this._map.forEach((n,r)=>{if(!n.deleted){const i=n.content.getContent()[n.length-1];t[r]=i instanceof Ae?i.toJSON():i}}),t}get size(){return[...Pr(this._map)].length}keys(){return xi(Pr(this._map),t=>t[0])}values(){return xi(Pr(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return xi(Pr(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((n,r)=>{n.deleted||t(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?ge(this.doc,n=>{Ir(n,this,t)}):this._prelimContent.delete(t)}set(t,n){return this.doc!==null?ge(this.doc,r=>{zi(r,this,t,n)}):this._prelimContent.set(t,n),n}get(t){return Bi(this,t)}has(t){return Yo(this,t)}clear(){this.doc!==null?ge(this.doc,t=>{this.forEach(function(n,r,i){Ir(t,i,r)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(xd)}}const id=e=>new un,Lt=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&Wc(e,t);class ji{constructor(t,n,r,i){this.left=t,this.right=n,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&He(),this.right.content.constructor){case ve:this.right.deleted||fn(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const $o=(e,t,n)=>{for(;t.right!==null&&n>0;){switch(t.right.content.constructor){case ve:t.right.deleted||fn(t.currentAttributes,t.right.content);break;default:t.right.deleted||(n<t.right.length&&At(e,re(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},zr=(e,t,n)=>{const r=new Map,i=Nr(t,n);if(i){const s=new ji(i.p.left,i.p,i.index,r);return $o(e,s,n-i.index)}else{const s=new ji(null,t._start,0,r);return $o(e,s,n)}},Jo=(e,t,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===ve&&Lt(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const i=e.doc,s=i.clientID;r.forEach((l,a)=>{const c=n.left,h=n.right,u=new we(re(s,ye(i.store,s)),c,c&&c.lastId,h,h&&h.id,t,null,new ve(a,l));u.integrate(e,0),n.right=u,n.forward()})},fn=(e,t)=>{const{key:n,value:r}=t;r===null?e.delete(n):e.set(n,r)},Go=(e,t)=>{for(;e.right!==null&&(e.right.deleted||e.right.content.constructor===ve&&Lt(t[e.right.content.key]||null,e.right.content.value));)e.forward()},Xo=(e,t,n,r)=>{const i=e.doc,s=i.clientID,l=new Map;for(const a in r){const c=r[a],h=n.currentAttributes.get(a)||null;if(!Lt(h,c)){l.set(a,h);const{left:u,right:f}=n;n.right=new we(re(s,ye(i.store,s)),u,u&&u.lastId,f,f&&f.id,t,null,new ve(a,c)),n.right.integrate(e,0),n.forward()}}return l},Ui=(e,t,n,r,i)=>{n.currentAttributes.forEach((p,g)=>{i[g]===void 0&&(i[g]=null)});const s=e.doc,l=s.clientID;Go(n,i);const a=Xo(e,t,n,i),c=r.constructor===String?new lt(r):r instanceof Ae?new ct(r):new Wt(r);let{left:h,right:u,index:f}=n;t._searchMarker&&jn(t._searchMarker,n.index,c.getLength()),u=new we(re(l,ye(s.store,l)),h,h&&h.lastId,u,u&&u.id,t,null,c),u.integrate(e,0),n.right=u,n.index=f,n.forward(),Jo(e,t,n,a)},Qo=(e,t,n,r,i)=>{const s=e.doc,l=s.clientID;Go(n,i);const a=Xo(e,t,n,i);e:for(;n.right!==null&&(r>0||a.size>0&&(n.right.deleted||n.right.content.constructor===ve));){if(!n.right.deleted)switch(n.right.content.constructor){case ve:{const{key:c,value:h}=n.right.content,u=i[c];if(u!==void 0){if(Lt(u,h))a.delete(c);else{if(r===0)break e;a.set(c,h)}n.right.delete(e)}else n.currentAttributes.set(c,h);break}default:r<n.right.length&&At(e,re(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let c="";for(;r>0;r--)c+=`
`;n.right=new we(re(l,ye(s.store,l)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new lt(c)),n.right.integrate(e,0),n.forward()}Jo(e,t,n,a)},ea=(e,t,n,r,i)=>{let s=t;const l=Je();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===ve){const h=s.content;l.set(h.key,h)}s=s.right}let a=0,c=!1;for(;t!==s;){if(n===t&&(c=!0),!t.deleted){const h=t.content;switch(h.constructor){case ve:{const{key:u,value:f}=h,p=r.get(u)||null;(l.get(u)!==h||p===f)&&(t.delete(e),a++,!c&&(i.get(u)||null)===f&&p!==f&&(p===null?i.delete(u):i.set(u,p))),!c&&!t.deleted&&fn(i,h);break}}}t=t.right}return a},sd=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===ve){const r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}},od=e=>{let t=0;return ge(e.doc,n=>{let r=e._start,i=e._start,s=Je();const l=si(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case ve:fn(l,i.content);break;default:t+=ea(n,r,i,s,l),s=si(l),r=i;break}i=i.right}}),t},ad=e=>{const t=new Set,n=e.doc;for(const[r,i]of e.afterState.entries()){const s=e.beforeState.get(r)||0;i!==s&&No(e,n.store.clients.get(r),s,i,l=>{!l.deleted&&l.content.constructor===ve&&l.constructor!==qe&&t.add(l.parent)})}ge(n,r=>{fo(e,e.deleteSet,i=>{if(i instanceof qe||!i.parent._hasFormatting||t.has(i.parent))return;const s=i.parent;i.content.constructor===ve?t.add(s):sd(r,i)});for(const i of t)od(i)})},ta=(e,t,n)=>{const r=n,i=si(t.currentAttributes),s=t.right;for(;n>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case ct:case Wt:case lt:n<t.right.length&&At(e,re(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}s&&ea(e,s,t.right,i,t.currentAttributes);const l=(t.left||t.right).parent;return l._searchMarker&&jn(l._searchMarker,t.index,-r+n),t};class ld extends Lr{constructor(t,n,r){super(t,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,n=[];ge(t,r=>{const i=new Map,s=new Map;let l=this.target._start,a=null;const c={};let h="",u=0,f=0;const p=()=>{if(a!==null){let g=null;switch(a){case"delete":f>0&&(g={delete:f}),f=0;break;case"insert":(typeof h=="object"||h.length>0)&&(g={insert:h},i.size>0&&(g.attributes={},i.forEach((m,k)=>{m!==null&&(g.attributes[k]=m)}))),h="";break;case"retain":u>0&&(g={retain:u},qc(c)||(g.attributes=Fc({},c))),u=0;break}g&&n.push(g),a=null}};for(;l!==null;){switch(l.content.constructor){case ct:case Wt:this.adds(l)?this.deletes(l)||(p(),a="insert",h=l.content.getContent()[0],p()):this.deletes(l)?(a!=="delete"&&(p(),a="delete"),f+=1):l.deleted||(a!=="retain"&&(p(),a="retain"),u+=1);break;case lt:this.adds(l)?this.deletes(l)||(a!=="insert"&&(p(),a="insert"),h+=l.content.str):this.deletes(l)?(a!=="delete"&&(p(),a="delete"),f+=l.length):l.deleted||(a!=="retain"&&(p(),a="retain"),u+=l.length);break;case ve:{const{key:g,value:m}=l.content;if(this.adds(l)){if(!this.deletes(l)){const k=i.get(g)||null;Lt(k,m)?m!==null&&l.delete(r):(a==="retain"&&p(),Lt(m,s.get(g)||null)?delete c[g]:c[g]=m)}}else if(this.deletes(l)){s.set(g,m);const k=i.get(g)||null;Lt(k,m)||(a==="retain"&&p(),c[g]=k)}else if(!l.deleted){s.set(g,m);const k=c[g];k!==void 0&&(Lt(k,m)?k!==null&&l.delete(r):(a==="retain"&&p(),m===null?delete c[g]:c[g]=m))}l.deleted||(a==="insert"&&p(),fn(i,l.content));break}}l=l.right}for(p();n.length>0;){const g=n[n.length-1];if(g.retain!==void 0&&g.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class gn extends Ae{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,n){super._integrate(t,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new gn}clone(){const t=new gn;return t.applyDelta(this.toDelta()),t}_callObserver(t,n){super._callObserver(t,n);const r=new ld(this,t,n);Mr(this,t,r),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===lt&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:n=!0}={}){this.doc!==null?ge(this.doc,r=>{const i=new ji(null,this._start,0,new Map);for(let s=0;s<t.length;s++){const l=t[s];if(l.insert!==void 0){const a=!n&&typeof l.insert=="string"&&s===t.length-1&&i.right===null&&l.insert.slice(-1)===`
`?l.insert.slice(0,-1):l.insert;(typeof a!="string"||a.length>0)&&Ui(r,this,i,a,l.attributes||{})}else l.retain!==void 0?Qo(r,this,i,l.retain,l.attributes||{}):l.delete!==void 0&&ta(r,i,l.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,n,r){const i=[],s=new Map,l=this.doc;let a="",c=this._start;function h(){if(a.length>0){const f={};let p=!1;s.forEach((m,k)=>{p=!0,f[k]=m});const g={insert:a};p&&(g.attributes=f),i.push(g),a=""}}const u=()=>{for(;c!==null;){if(Bn(c,t)||n!==void 0&&Bn(c,n))switch(c.content.constructor){case lt:{const f=s.get("ychange");t!==void 0&&!Bn(c,t)?(f===void 0||f.user!==c.id.client||f.type!=="removed")&&(h(),s.set("ychange",r?r("removed",c.id):{type:"removed"})):n!==void 0&&!Bn(c,n)?(f===void 0||f.user!==c.id.client||f.type!=="added")&&(h(),s.set("ychange",r?r("added",c.id):{type:"added"})):f!==void 0&&(h(),s.delete("ychange")),a+=c.content.str;break}case ct:case Wt:{h();const f={insert:c.content.getContent()[0]};if(s.size>0){const p={};f.attributes=p,s.forEach((g,m)=>{p[m]=g})}i.push(f);break}case ve:Bn(c,t)&&(h(),fn(s,c.content));break}c=c.right}h()};return t||n?ge(l,f=>{t&&Li(f,t),n&&Li(f,n),u()},"cleanup"):u(),i}insert(t,n,r){if(n.length<=0)return;const i=this.doc;i!==null?ge(i,s=>{const l=zr(s,this,t);r||(r={},l.currentAttributes.forEach((a,c)=>{r[c]=a})),Ui(s,this,l,n,r)}):this._pending.push(()=>this.insert(t,n,r))}insertEmbed(t,n,r={}){const i=this.doc;i!==null?ge(i,s=>{const l=zr(s,this,t);Ui(s,this,l,n,r)}):this._pending.push(()=>this.insertEmbed(t,n,r))}delete(t,n){if(n===0)return;const r=this.doc;r!==null?ge(r,i=>{ta(i,zr(i,this,t),n)}):this._pending.push(()=>this.delete(t,n))}format(t,n,r){if(n===0)return;const i=this.doc;i!==null?ge(i,s=>{const l=zr(s,this,t);l.right!==null&&Qo(s,this,l,n,r)}):this._pending.push(()=>this.format(t,n,r))}removeAttribute(t){this.doc!==null?ge(this.doc,n=>{Ir(n,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,n){this.doc!==null?ge(this.doc,r=>{zi(r,this,t,n)}):this._pending.push(()=>this.setAttribute(t,n))}getAttribute(t){return Bi(this,t)}getAttributes(){return Ko(this)}_write(t){t.writeTypeRef(Rd)}}const cd=e=>new gn;class Fi{constructor(t,n=()=>!0){this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,n=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(n)))do if(n=t.content.type,!t.deleted&&(n.constructor===Fn||n.constructor===Zt)&&n._start!==null)t=n._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class Zt extends Ae{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Zt}clone(){const t=new Zt;return t.insert(0,this.toArray().map(n=>n instanceof Ae?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new Fi(this,t)}querySelector(t){t=t.toUpperCase();const n=new Fi(this,r=>r.nodeName&&r.nodeName.toUpperCase()===t).next();return n.done?null:n.value}querySelectorAll(t){return t=t.toUpperCase(),Tt(new Fi(this,n=>n.nodeName&&n.nodeName.toUpperCase()===t))}_callObserver(t,n){Mr(this,t,new ud(this,n,t))}toString(){return Ho(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,n={},r){const i=t.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),Un(this,s=>{i.insertBefore(s.toDOM(t,n,r),null)}),i}insert(t,n){this.doc!==null?ge(this.doc,r=>{Zo(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}insertAfter(t,n){if(this.doc!==null)ge(this.doc,r=>{const i=t&&t instanceof Ae?t._item:t;Or(r,this,i,n)});else{const r=this._prelimContent,i=t===null?0:r.findIndex(s=>s===t)+1;if(i===0&&t!==null)throw rt("Reference item not found");r.splice(i,0,...n)}}delete(t,n=1){this.doc!==null?ge(this.doc,r=>{Wo(r,this,t,n)}):this._prelimContent.splice(t,n)}toArray(){return Fo(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Vo(this,t)}slice(t=0,n=this.length){return Uo(this,t,n)}forEach(t){Un(this,t)}_write(t){t.writeTypeRef(Ad)}}const hd=e=>new Zt;class Fn extends Zt{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,n){super._integrate(t,n),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new Fn(this.nodeName)}clone(){const t=new Fn(this.nodeName),n=this.getAttributes();return Vc(n,(r,i)=>{typeof r=="string"&&t.setAttribute(i,r)}),t.insert(0,this.toArray().map(r=>r instanceof Ae?r.clone():r)),t}toString(){const t=this.getAttributes(),n=[],r=[];for(const a in t)r.push(a);r.sort();const i=r.length;for(let a=0;a<i;a++){const c=r[a];n.push(c+'="'+t[c]+'"')}const s=this.nodeName.toLocaleLowerCase(),l=n.length>0?" "+n.join(" "):"";return`<${s}${l}>${super.toString()}</${s}>`}removeAttribute(t){this.doc!==null?ge(this.doc,n=>{Ir(n,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,n){this.doc!==null?ge(this.doc,r=>{zi(r,this,t,n)}):this._prelimAttrs.set(t,n)}getAttribute(t){return Bi(this,t)}hasAttribute(t){return Yo(this,t)}getAttributes(){return Ko(this)}toDOM(t=document,n={},r){const i=t.createElement(this.nodeName),s=this.getAttributes();for(const l in s){const a=s[l];typeof a=="string"&&i.setAttribute(l,a)}return Un(this,l=>{i.appendChild(l.toDOM(t,n,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(t){t.writeTypeRef(Td),t.writeKey(this.nodeName)}}const dd=e=>new Fn(e.readKey());class ud extends Lr{constructor(t,n,r){super(t,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class Br extends un{constructor(t){super(),this.hookName=t}_copy(){return new Br(this.hookName)}clone(){const t=new Br(this.hookName);return this.forEach((n,r)=>{t.set(r,n)}),t}toDOM(t=document,n={},r){const i=n[this.hookName];let s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(s,this),s}_write(t){t.writeTypeRef(Dd),t.writeKey(this.hookName)}}const fd=e=>new Br(e.readKey());class jr extends gn{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new jr}clone(){const t=new jr;return t.applyDelta(this.toDelta()),t}toDOM(t=document,n,r){const i=t.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(t=>{const n=[];for(const i in t.attributes){const s=[];for(const l in t.attributes[i])s.push({key:l,value:t.attributes[i][l]});s.sort((l,a)=>l.key<a.key?-1:1),n.push({nodeName:i,attrs:s})}n.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let r="";for(let i=0;i<n.length;i++){const s=n[i];r+=`<${s.nodeName}`;for(let l=0;l<s.attrs.length;l++){const a=s.attrs[l];r+=` ${a.key}="${a.value}"`}r+=">"}r+=t.insert;for(let i=n.length-1;i>=0;i--)r+=`</${n[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(Ld)}}const gd=e=>new jr;class Hi{constructor(t,n){this.id=t,this.length=n}get deleted(){throw it()}mergeWith(t){return!1}write(t,n,r){throw it()}integrate(t,n){throw it()}}const pd=0;class qe extends Hi{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){n>0&&(this.id.clock+=n,this.length-=n),Do(t.doc.store,this)}write(t,n){t.writeInfo(pd),t.writeLen(this.length-n)}getMissing(t,n){return null}}class Hn{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Hn(this.content)}splice(t){throw it()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeBuf(this.content)}getRef(){return 3}}const _d=e=>new Hn(e.readBuf());class Vn{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Vn(this.len)}splice(t){const n=new Vn(this.len-t);return this.len=t,n}mergeWith(t){return this.len+=t.len,!0}integrate(t,n){kr(t.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(t){}gc(t){}write(t,n){t.writeLen(this.len-n)}getRef(){return 1}}const md=e=>new Vn(e.readLen()),na=(e,t)=>new ln({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class qn{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),t.meta!==null&&(n.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new qn(na(this.doc.guid,this.opts))}splice(t){throw it()}mergeWith(t){return!1}integrate(t,n){this.doc._item=n,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,n){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const bd=e=>new qn(na(e.readString(),e.readAny()));class Wt{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Wt(this.embed)}splice(t){throw it()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeJSON(this.embed)}getRef(){return 5}}const wd=e=>new Wt(e.readJSON());class ve{constructor(t,n){this.key=t,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ve(this.key,this.value)}splice(t){throw it()}mergeWith(t){return!1}integrate(t,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(t){}gc(t){}write(t,n){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const yd=e=>new ve(e.readKey(),e.readJSON());class Ur{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ur(this.arr)}splice(t){const n=new Ur(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){const s=this.arr[i];t.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const vd=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++){const i=e.readString();i==="undefined"?n.push(void 0):n.push(JSON.parse(i))}return new Ur(n)};class Kt{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Kt(this.arr)}splice(t){const n=new Kt(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){const s=this.arr[i];t.writeAny(s)}}getRef(){return 8}}const kd=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new Kt(n)};class lt{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new lt(this.str)}splice(t){const n=new lt(this.str.slice(t));this.str=this.str.slice(0,t);const r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",n.str="\uFFFD"+n.str.slice(1)),n}mergeWith(t){return this.str+=t.str,!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const Ed=e=>new lt(e.readString()),Cd=[nd,id,cd,dd,hd,fd,gd],Sd=0,xd=1,Rd=2,Td=3,Ad=4,Dd=5,Ld=6;class ct{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new ct(this.type._copy())}splice(t){throw it()}mergeWith(t){return!1}integrate(t,n){this.type._integrate(t.doc,n)}delete(t){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(t.beforeState.get(n.id.client)||0)&&t._mergeStructs.push(n):n.delete(t),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(t.beforeState.get(r.id.client)||0)&&t._mergeStructs.push(r):r.delete(t)}),t.changed.delete(this.type)}gc(t){let n=this.type._start;for(;n!==null;)n.gc(t,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(t,!0),r=r.left}),this.type._map=new Map}write(t,n){this.type._write(t)}getRef(){return 7}}const Nd=e=>new ct(Cd[e.readTypeRef()](e)),ra=(e,t)=>{let n=t,r=0,i;do r>0&&(n=re(n.client,n.clock+r)),i=Tr(e,n),r=n.clock-i.id.clock,n=i.redone;while(n!==null&&i instanceof we);return{item:i,diff:r}},Fr=(e,t,n)=>{const{client:r,clock:i}=t.id,s=new we(re(r,i+n),t,re(r,i+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&s.markDeleted(),t.keep&&(s.keep=!0),t.redone!==null&&(s.redone=re(t.redone.client,t.redone.clock+n)),t.right=s,s.right!==null&&(s.right.left=s),e._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),t.length=n,s};class we extends Hi{constructor(t,n,r,i,s,l,a,c){super(t,c.getLength()),this.origin=r,this.left=n,this.right=i,this.rightOrigin=s,this.parent=l,this.parentSub=a,this.redone=null,this.content=c,this.info=this.content.isCountable()?zs:0}set marker(t){(this.info&ci)>0!==t&&(this.info^=ci)}get marker(){return(this.info&ci)>0}get keep(){return(this.info&Ps)>0}set keep(t){this.keep!==t&&(this.info^=Ps)}get countable(){return(this.info&zs)>0}get deleted(){return(this.info&li)>0}set deleted(t){this.deleted!==t&&(this.info^=li)}markDeleted(){this.info|=li}getMissing(t,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=ye(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=ye(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===hn&&this.id.client!==this.parent.client&&this.parent.clock>=ye(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Lo(t,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=At(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===qe||this.right&&this.right.constructor===qe)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===we&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===we&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===hn){const r=Tr(n,this.parent);r.constructor===qe?this.parent=null:this.parent=r.content.type}return null}integrate(t,n){if(n>0&&(this.id.clock+=n,this.left=Lo(t,t.doc.store,re(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const s=new Set,l=new Set;for(;i!==null&&i!==this.right;){if(l.add(i),s.add(i),Er(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,s.clear();else if(Er(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&l.has(Tr(t.doc.store,i.origin)))s.has(Tr(t.doc.store,i.origin))||(r=i,s.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Do(t.doc.store,this),this.content.integrate(t,this),Oo(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new qe(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:re(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&Er(t.origin,this.lastId)&&this.right===t&&Er(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===t&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),kr(t.deleteSet,this.id.client,this.id.clock,this.length),Oo(t,n,this.parentSub),this.content.delete(t)}}gc(t,n){if(!this.deleted)throw He();this.content.gc(t),n?jh(t,this,new qe(this.id,this.length)):this.content=new Vn(this.length)}write(t,n){const r=n>0?re(this.id.client,this.id.clock+n-1):this.origin,i=this.rightOrigin,s=this.parentSub,l=this.content.getRef()&gr|(r===null?0:Be)|(i===null?0:wt)|(s===null?0:Dn);if(t.writeInfo(l),r!==null&&t.writeLeftID(r),i!==null&&t.writeRightID(i),r===null&&i===null){const a=this.parent;if(a._item!==void 0){const c=a._item;if(c===null){const h=To(a);t.writeParentInfo(!0),t.writeString(h)}else t.writeParentInfo(!1),t.writeLeftID(c.id)}else a.constructor===String?(t.writeParentInfo(!0),t.writeString(a)):a.constructor===hn?(t.writeParentInfo(!1),t.writeLeftID(a)):He();s!==null&&t.writeString(s)}this.content.write(t,n)}}const ia=(e,t)=>Md[t&gr](e),Md=[()=>{He()},md,vd,_d,Ed,wd,yd,Nd,kd,bd,()=>{He()}],Od=10;class Ze extends Hi{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){He()}write(t,n){t.writeInfo(Od),$(t.restEncoder,this.length-n)}getMissing(t,n){return null}}const sa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},oa="__ $YJS$ __";sa[oa]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),sa[oa]=!0;const Id=1200,Pd=2500,Hr=3e4,Vi=e=>{if(e.shouldConnect&&e.ws===null){const t=new WebSocket(e.url),n=e.binaryType;let r=null;n&&(t.binaryType=n),e.ws=t,e.connecting=!0,e.connected=!1,t.onmessage=l=>{e.lastMessageReceived=vt();const a=l.data,c=typeof a=="string"?JSON.parse(a):a;c&&c.type==="pong"&&(clearTimeout(r),r=setTimeout(s,Hr/2)),e.emit("message",[c,e])};const i=l=>{e.ws!==null&&(e.ws=null,e.connecting=!1,e.connected?(e.connected=!1,e.emit("disconnect",[{type:"disconnect",error:l},e])):e.unsuccessfulReconnects++,setTimeout(Vi,ai(ic(e.unsuccessfulReconnects+1)*Id,Pd),e)),clearTimeout(r)},s=()=>{e.ws===t&&e.send({type:"ping"})};t.onclose=()=>i(null),t.onerror=l=>i(l),t.onopen=()=>{e.lastMessageReceived=vt(),e.connecting=!1,e.connected=!0,e.unsuccessfulReconnects=0,e.emit("connect",[{type:"connect"},e]),r=setTimeout(s,Hr/2)}}};class zd extends ur{constructor(t,{binaryType:n}={}){super(),this.url=t,this.ws=null,this.binaryType=n||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&Hr<vt()-this.lastMessageReceived&&this.ws.close()},Hr/2),Vi(this)}send(t){this.ws&&this.ws.send(JSON.stringify(t))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&Vi(this)}}const aa=new Map;class Bd{constructor(t){this.room=t,this.onmessage=null,this._onChange=n=>n.key===t&&this.onmessage!==null&&this.onmessage({data:ro(n.newValue||"")}),jc(this._onChange)}postMessage(t){Gs.setItem(this.room,no(eh(t)))}close(){Uc(this._onChange)}}const jd=typeof BroadcastChannel>"u"?Bd:BroadcastChannel,qi=e=>Fe(aa,e,()=>{const t=jt(),n=new jd(e);return n.onmessage=r=>t.forEach(i=>i(r.data,"broadcastchannel")),{bc:n,subs:t}}),Ud=(e,t)=>(qi(e).subs.add(t),t),Fd=(e,t)=>{const n=qi(e),r=n.subs.delete(t);return r&&n.subs.size===0&&(n.bc.close(),aa.delete(e)),r},Hd=(e,t,n=null)=>{const r=qi(e);r.bc.postMessage(t),r.subs.forEach(i=>i(t,n))},la=()=>{let e=!0;return(t,n)=>{if(e){e=!1;try{t()}finally{e=!0}}else n!==void 0&&n()}};function Vr(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ca={exports:{}};(function(e,t){(function(n){e.exports=n()})(function(){var n=Math.floor,r=Math.abs,i=Math.pow;return function(){function s(l,a,c){function h(p,g){if(!a[p]){if(!l[p]){var m=typeof Vr=="function"&&Vr;if(!g&&m)return m(p,!0);if(u)return u(p,!0);var k=new Error("Cannot find module '"+p+"'");throw k.code="MODULE_NOT_FOUND",k}var L=a[p]={exports:{}};l[p][0].call(L.exports,function(T){var M=l[p][1][T];return h(M||T)},L,L.exports,s,l,a,c)}return a[p].exports}for(var u=typeof Vr=="function"&&Vr,f=0;f<c.length;f++)h(c[f]);return h}return s}()({1:[function(s,l,a){function c(w){var E=w.length;if(0<E%4)throw new Error("Invalid string. Length must be a multiple of 4");var S=w.indexOf("=");S===-1&&(S=E);var v=S===E?0:4-S%4;return[S,v]}function h(w,E,S){return 3*(E+S)/4-S}function u(w){var E,S,v=c(w),R=v[0],D=v[1],C=new L(h(w,R,D)),A=0,I=0<D?R-4:R;for(S=0;S<I;S+=4)E=k[w.charCodeAt(S)]<<18|k[w.charCodeAt(S+1)]<<12|k[w.charCodeAt(S+2)]<<6|k[w.charCodeAt(S+3)],C[A++]=255&E>>16,C[A++]=255&E>>8,C[A++]=255&E;return D===2&&(E=k[w.charCodeAt(S)]<<2|k[w.charCodeAt(S+1)]>>4,C[A++]=255&E),D===1&&(E=k[w.charCodeAt(S)]<<10|k[w.charCodeAt(S+1)]<<4|k[w.charCodeAt(S+2)]>>2,C[A++]=255&E>>8,C[A++]=255&E),C}function f(w){return m[63&w>>18]+m[63&w>>12]+m[63&w>>6]+m[63&w]}function p(w,E,S){for(var v,R=[],D=E;D<S;D+=3)v=(16711680&w[D]<<16)+(65280&w[D+1]<<8)+(255&w[D+2]),R.push(f(v));return R.join("")}function g(w){for(var E,S=w.length,v=S%3,R=[],D=16383,C=0,A=S-v;C<A;C+=D)R.push(p(w,C,C+D>A?A:C+D));return v===1?(E=w[S-1],R.push(m[E>>2]+m[63&E<<4]+"==")):v===2&&(E=(w[S-2]<<8)+w[S-1],R.push(m[E>>10]+m[63&E>>4]+m[63&E<<2]+"=")),R.join("")}a.byteLength=function(w){var E=c(w),S=E[0],v=E[1];return 3*(S+v)/4-v},a.toByteArray=u,a.fromByteArray=g;for(var m=[],k=[],L=typeof Uint8Array>"u"?Array:Uint8Array,T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M=0,b=T.length;M<b;++M)m[M]=T[M],k[T.charCodeAt(M)]=M;k[45]=62,k[95]=63},{}],2:[function(){},{}],3:[function(s,l,a){(function(){(function(){var c=String.fromCharCode,h=Math.min;function u(o){if(2147483647<o)throw new RangeError('The value "'+o+'" is invalid for option "size"');var d=new Uint8Array(o);return d.__proto__=f.prototype,d}function f(o,d,_){if(typeof o=="number"){if(typeof d=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return k(o)}return p(o,d,_)}function p(o,d,_){if(typeof o=="string")return L(o,d);if(ArrayBuffer.isView(o))return T(o);if(o==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o);if(O(o,ArrayBuffer)||o&&O(o.buffer,ArrayBuffer))return M(o,d,_);if(typeof o=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var x=o.valueOf&&o.valueOf();if(x!=null&&x!==o)return f.from(x,d,_);var N=b(o);if(N)return N;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof o[Symbol.toPrimitive]=="function")return f.from(o[Symbol.toPrimitive]("string"),d,_);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o)}function g(o){if(typeof o!="number")throw new TypeError('"size" argument must be of type number');if(0>o)throw new RangeError('The value "'+o+'" is invalid for option "size"')}function m(o,d,_){return g(o),0>=o||d===void 0?u(o):typeof _=="string"?u(o).fill(d,_):u(o).fill(d)}function k(o){return g(o),u(0>o?0:0|w(o))}function L(o,d){if((typeof d!="string"||d==="")&&(d="utf8"),!f.isEncoding(d))throw new TypeError("Unknown encoding: "+d);var _=0|E(o,d),x=u(_),N=x.write(o,d);return N!==_&&(x=x.slice(0,N)),x}function T(o){for(var d=0>o.length?0:0|w(o.length),_=u(d),x=0;x<d;x+=1)_[x]=255&o[x];return _}function M(o,d,_){if(0>d||o.byteLength<d)throw new RangeError('"offset" is outside of buffer bounds');if(o.byteLength<d+(_||0))throw new RangeError('"length" is outside of buffer bounds');var x;return x=d===void 0&&_===void 0?new Uint8Array(o):_===void 0?new Uint8Array(o,d):new Uint8Array(o,d,_),x.__proto__=f.prototype,x}function b(o){if(f.isBuffer(o)){var d=0|w(o.length),_=u(d);return _.length===0||o.copy(_,0,0,d),_}return o.length===void 0?o.type==="Buffer"&&Array.isArray(o.data)?T(o.data):void 0:typeof o.length!="number"||P(o.length)?u(0):T(o)}function w(o){if(o>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|o}function E(o,d){if(f.isBuffer(o))return o.length;if(ArrayBuffer.isView(o)||O(o,ArrayBuffer))return o.byteLength;if(typeof o!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof o);var _=o.length,x=2<arguments.length&&arguments[2]===!0;if(!x&&_===0)return 0;for(var N=!1;;)switch(d){case"ascii":case"latin1":case"binary":return _;case"utf8":case"utf-8":return Ke(o).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*_;case"hex":return _>>>1;case"base64":return Qe(o).length;default:if(N)return x?-1:Ke(o).length;d=(""+d).toLowerCase(),N=!0}}function S(o,d,_){var x=!1;if((d===void 0||0>d)&&(d=0),d>this.length||((_===void 0||_>this.length)&&(_=this.length),0>=_)||(_>>>=0,d>>>=0,_<=d))return"";for(o||(o="utf8");;)switch(o){case"hex":return he(this,d,_);case"utf8":case"utf-8":return J(this,d,_);case"ascii":return F(this,d,_);case"latin1":case"binary":return ue(this,d,_);case"base64":return K(this,d,_);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,d,_);default:if(x)throw new TypeError("Unknown encoding: "+o);o=(o+"").toLowerCase(),x=!0}}function v(o,d,_){var x=o[d];o[d]=o[_],o[_]=x}function R(o,d,_,x,N){if(o.length===0)return-1;if(typeof _=="string"?(x=_,_=0):2147483647<_?_=2147483647:-2147483648>_&&(_=-2147483648),_=+_,P(_)&&(_=N?0:o.length-1),0>_&&(_=o.length+_),_>=o.length){if(N)return-1;_=o.length-1}else if(0>_)if(N)_=0;else return-1;if(typeof d=="string"&&(d=f.from(d,x)),f.isBuffer(d))return d.length===0?-1:D(o,d,_,x,N);if(typeof d=="number")return d&=255,typeof Uint8Array.prototype.indexOf=="function"?N?Uint8Array.prototype.indexOf.call(o,d,_):Uint8Array.prototype.lastIndexOf.call(o,d,_):D(o,[d],_,x,N);throw new TypeError("val must be string, number or Buffer")}function D(o,d,_,x,N){function z(Sn,dr){return W===1?Sn[dr]:Sn.readUInt16BE(dr*W)}var W=1,oe=o.length,_e=d.length;if(x!==void 0&&(x=(x+"").toLowerCase(),x==="ucs2"||x==="ucs-2"||x==="utf16le"||x==="utf-16le")){if(2>o.length||2>d.length)return-1;W=2,oe/=2,_e/=2,_/=2}var ae;if(N){var se=-1;for(ae=_;ae<oe;ae++)if(z(o,ae)!==z(d,se===-1?0:ae-se))se!==-1&&(ae-=ae-se),se=-1;else if(se===-1&&(se=ae),ae-se+1===_e)return se*W}else for(_+_e>oe&&(_=oe-_e),ae=_;0<=ae;ae--){for(var Ne=!0,nn=0;nn<_e;nn++)if(z(o,ae+nn)!==z(d,nn)){Ne=!1;break}if(Ne)return ae}return-1}function C(o,d,_,x){_=+_||0;var N=o.length-_;x?(x=+x,x>N&&(x=N)):x=N;var z=d.length;x>z/2&&(x=z/2);for(var W,oe=0;oe<x;++oe){if(W=parseInt(d.substr(2*oe,2),16),P(W))return oe;o[_+oe]=W}return oe}function A(o,d,_,x){return et(Ke(d,o.length-_),o,_,x)}function I(o,d,_,x){return et(pt(d),o,_,x)}function B(o,d,_,x){return I(o,d,_,x)}function V(o,d,_,x){return et(Qe(d),o,_,x)}function H(o,d,_,x){return et(Bt(d,o.length-_),o,_,x)}function K(o,d,_){return d===0&&_===o.length?j.fromByteArray(o):j.fromByteArray(o.slice(d,_))}function J(o,d,_){_=h(o.length,_);for(var x=[],N=d;N<_;){var z=o[N],W=null,oe=239<z?4:223<z?3:191<z?2:1;if(N+oe<=_){var _e,ae,se,Ne;oe===1?128>z&&(W=z):oe===2?(_e=o[N+1],(192&_e)==128&&(Ne=(31&z)<<6|63&_e,127<Ne&&(W=Ne))):oe===3?(_e=o[N+1],ae=o[N+2],(192&_e)==128&&(192&ae)==128&&(Ne=(15&z)<<12|(63&_e)<<6|63&ae,2047<Ne&&(55296>Ne||57343<Ne)&&(W=Ne))):oe===4&&(_e=o[N+1],ae=o[N+2],se=o[N+3],(192&_e)==128&&(192&ae)==128&&(192&se)==128&&(Ne=(15&z)<<18|(63&_e)<<12|(63&ae)<<6|63&se,65535<Ne&&1114112>Ne&&(W=Ne)))}W===null?(W=65533,oe=1):65535<W&&(W-=65536,x.push(55296|1023&W>>>10),W=56320|1023&W),x.push(W),N+=oe}return Q(x)}function Q(o){var d=o.length;if(d<=4096)return c.apply(String,o);for(var _="",x=0;x<d;)_+=c.apply(String,o.slice(x,x+=4096));return _}function F(o,d,_){var x="";_=h(o.length,_);for(var N=d;N<_;++N)x+=c(127&o[N]);return x}function ue(o,d,_){var x="";_=h(o.length,_);for(var N=d;N<_;++N)x+=c(o[N]);return x}function he(o,d,_){var x=o.length;(!d||0>d)&&(d=0),(!_||0>_||_>x)&&(_=x);for(var N="",z=d;z<_;++z)N+=gt(o[z]);return N}function fe(o,d,_){for(var x=o.slice(d,_),N="",z=0;z<x.length;z+=2)N+=c(x[z]+256*x[z+1]);return N}function ee(o,d,_){if(o%1!=0||0>o)throw new RangeError("offset is not uint");if(o+d>_)throw new RangeError("Trying to access beyond buffer length")}function q(o,d,_,x,N,z){if(!f.isBuffer(o))throw new TypeError('"buffer" argument must be a Buffer instance');if(d>N||d<z)throw new RangeError('"value" argument is out of bounds');if(_+x>o.length)throw new RangeError("Index out of range")}function ie(o,d,_,x){if(_+x>o.length)throw new RangeError("Index out of range");if(0>_)throw new RangeError("Index out of range")}function Le(o,d,_,x,N){return d=+d,_>>>=0,N||ie(o,d,_,4),Y.write(o,d,_,x,23,4),_+4}function Ie(o,d,_,x,N){return d=+d,_>>>=0,N||ie(o,d,_,8),Y.write(o,d,_,x,52,8),_+8}function ze(o){if(o=o.split("=")[0],o=o.trim().replace(y,""),2>o.length)return"";for(;o.length%4!=0;)o+="=";return o}function gt(o){return 16>o?"0"+o.toString(16):o.toString(16)}function Ke(o,d){d=d||1/0;for(var _,x=o.length,N=null,z=[],W=0;W<x;++W){if(_=o.charCodeAt(W),55295<_&&57344>_){if(!N){if(56319<_){-1<(d-=3)&&z.push(239,191,189);continue}else if(W+1===x){-1<(d-=3)&&z.push(239,191,189);continue}N=_;continue}if(56320>_){-1<(d-=3)&&z.push(239,191,189),N=_;continue}_=(N-55296<<10|_-56320)+65536}else N&&-1<(d-=3)&&z.push(239,191,189);if(N=null,128>_){if(0>(d-=1))break;z.push(_)}else if(2048>_){if(0>(d-=2))break;z.push(192|_>>6,128|63&_)}else if(65536>_){if(0>(d-=3))break;z.push(224|_>>12,128|63&_>>6,128|63&_)}else if(1114112>_){if(0>(d-=4))break;z.push(240|_>>18,128|63&_>>12,128|63&_>>6,128|63&_)}else throw new Error("Invalid code point")}return z}function pt(o){for(var d=[],_=0;_<o.length;++_)d.push(255&o.charCodeAt(_));return d}function Bt(o,d){for(var _,x,N,z=[],W=0;W<o.length&&!(0>(d-=2));++W)_=o.charCodeAt(W),x=_>>8,N=_%256,z.push(N),z.push(x);return z}function Qe(o){return j.toByteArray(ze(o))}function et(o,d,_,x){for(var N=0;N<x&&!(N+_>=d.length||N>=o.length);++N)d[N+_]=o[N];return N}function O(o,d){return o instanceof d||o!=null&&o.constructor!=null&&o.constructor.name!=null&&o.constructor.name===d.name}function P(o){return o!==o}var j=s("base64-js"),Y=s("ieee754");a.Buffer=f,a.SlowBuffer=function(o){return+o!=o&&(o=0),f.alloc(+o)},a.INSPECT_MAX_BYTES=50,a.kMaxLength=2147483647,f.TYPED_ARRAY_SUPPORT=function(){try{var o=new Uint8Array(1);return o.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},o.foo()===42}catch{return!1}}(),f.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){return f.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){return f.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),f.poolSize=8192,f.from=function(o,d,_){return p(o,d,_)},f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,f.alloc=function(o,d,_){return m(o,d,_)},f.allocUnsafe=function(o){return k(o)},f.allocUnsafeSlow=function(o){return k(o)},f.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==f.prototype},f.compare=function(o,d){if(O(o,Uint8Array)&&(o=f.from(o,o.offset,o.byteLength)),O(d,Uint8Array)&&(d=f.from(d,d.offset,d.byteLength)),!f.isBuffer(o)||!f.isBuffer(d))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===d)return 0;for(var _=o.length,x=d.length,N=0,z=h(_,x);N<z;++N)if(o[N]!==d[N]){_=o[N],x=d[N];break}return _<x?-1:x<_?1:0},f.isEncoding=function(o){switch((o+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(o,d){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return f.alloc(0);var _;if(d===void 0)for(d=0,_=0;_<o.length;++_)d+=o[_].length;var x=f.allocUnsafe(d),N=0;for(_=0;_<o.length;++_){var z=o[_];if(O(z,Uint8Array)&&(z=f.from(z)),!f.isBuffer(z))throw new TypeError('"list" argument must be an Array of Buffers');z.copy(x,N),N+=z.length}return x},f.byteLength=E,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var o=this.length;if(o%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var d=0;d<o;d+=2)v(this,d,d+1);return this},f.prototype.swap32=function(){var o=this.length;if(o%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var d=0;d<o;d+=4)v(this,d,d+3),v(this,d+1,d+2);return this},f.prototype.swap64=function(){var o=this.length;if(o%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var d=0;d<o;d+=8)v(this,d,d+7),v(this,d+1,d+6),v(this,d+2,d+5),v(this,d+3,d+4);return this},f.prototype.toString=function(){var o=this.length;return o===0?"":arguments.length===0?J(this,0,o):S.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(o){if(!f.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o||f.compare(this,o)===0},f.prototype.inspect=function(){var o="",d=a.INSPECT_MAX_BYTES;return o=this.toString("hex",0,d).replace(/(.{2})/g,"$1 ").trim(),this.length>d&&(o+=" ... "),"<Buffer "+o+">"},f.prototype.compare=function(o,d,_,x,N){if(O(o,Uint8Array)&&(o=f.from(o,o.offset,o.byteLength)),!f.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(d===void 0&&(d=0),_===void 0&&(_=o?o.length:0),x===void 0&&(x=0),N===void 0&&(N=this.length),0>d||_>o.length||0>x||N>this.length)throw new RangeError("out of range index");if(x>=N&&d>=_)return 0;if(x>=N)return-1;if(d>=_)return 1;if(d>>>=0,_>>>=0,x>>>=0,N>>>=0,this===o)return 0;for(var z=N-x,W=_-d,oe=h(z,W),_e=this.slice(x,N),ae=o.slice(d,_),se=0;se<oe;++se)if(_e[se]!==ae[se]){z=_e[se],W=ae[se];break}return z<W?-1:W<z?1:0},f.prototype.includes=function(o,d,_){return this.indexOf(o,d,_)!==-1},f.prototype.indexOf=function(o,d,_){return R(this,o,d,_,!0)},f.prototype.lastIndexOf=function(o,d,_){return R(this,o,d,_,!1)},f.prototype.write=function(o,d,_,x){if(d===void 0)x="utf8",_=this.length,d=0;else if(_===void 0&&typeof d=="string")x=d,_=this.length,d=0;else if(isFinite(d))d>>>=0,isFinite(_)?(_>>>=0,x===void 0&&(x="utf8")):(x=_,_=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var N=this.length-d;if((_===void 0||_>N)&&(_=N),0<o.length&&(0>_||0>d)||d>this.length)throw new RangeError("Attempt to write outside buffer bounds");x||(x="utf8");for(var z=!1;;)switch(x){case"hex":return C(this,o,d,_);case"utf8":case"utf-8":return A(this,o,d,_);case"ascii":return I(this,o,d,_);case"latin1":case"binary":return B(this,o,d,_);case"base64":return V(this,o,d,_);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,o,d,_);default:if(z)throw new TypeError("Unknown encoding: "+x);x=(""+x).toLowerCase(),z=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},f.prototype.slice=function(o,d){var _=this.length;o=~~o,d=d===void 0?_:~~d,0>o?(o+=_,0>o&&(o=0)):o>_&&(o=_),0>d?(d+=_,0>d&&(d=0)):d>_&&(d=_),d<o&&(d=o);var x=this.subarray(o,d);return x.__proto__=f.prototype,x},f.prototype.readUIntLE=function(o,d,_){o>>>=0,d>>>=0,_||ee(o,d,this.length);for(var x=this[o],N=1,z=0;++z<d&&(N*=256);)x+=this[o+z]*N;return x},f.prototype.readUIntBE=function(o,d,_){o>>>=0,d>>>=0,_||ee(o,d,this.length);for(var x=this[o+--d],N=1;0<d&&(N*=256);)x+=this[o+--d]*N;return x},f.prototype.readUInt8=function(o,d){return o>>>=0,d||ee(o,1,this.length),this[o]},f.prototype.readUInt16LE=function(o,d){return o>>>=0,d||ee(o,2,this.length),this[o]|this[o+1]<<8},f.prototype.readUInt16BE=function(o,d){return o>>>=0,d||ee(o,2,this.length),this[o]<<8|this[o+1]},f.prototype.readUInt32LE=function(o,d){return o>>>=0,d||ee(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+16777216*this[o+3]},f.prototype.readUInt32BE=function(o,d){return o>>>=0,d||ee(o,4,this.length),16777216*this[o]+(this[o+1]<<16|this[o+2]<<8|this[o+3])},f.prototype.readIntLE=function(o,d,_){o>>>=0,d>>>=0,_||ee(o,d,this.length);for(var x=this[o],N=1,z=0;++z<d&&(N*=256);)x+=this[o+z]*N;return N*=128,x>=N&&(x-=i(2,8*d)),x},f.prototype.readIntBE=function(o,d,_){o>>>=0,d>>>=0,_||ee(o,d,this.length);for(var x=d,N=1,z=this[o+--x];0<x&&(N*=256);)z+=this[o+--x]*N;return N*=128,z>=N&&(z-=i(2,8*d)),z},f.prototype.readInt8=function(o,d){return o>>>=0,d||ee(o,1,this.length),128&this[o]?-1*(255-this[o]+1):this[o]},f.prototype.readInt16LE=function(o,d){o>>>=0,d||ee(o,2,this.length);var _=this[o]|this[o+1]<<8;return 32768&_?4294901760|_:_},f.prototype.readInt16BE=function(o,d){o>>>=0,d||ee(o,2,this.length);var _=this[o+1]|this[o]<<8;return 32768&_?4294901760|_:_},f.prototype.readInt32LE=function(o,d){return o>>>=0,d||ee(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24},f.prototype.readInt32BE=function(o,d){return o>>>=0,d||ee(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]},f.prototype.readFloatLE=function(o,d){return o>>>=0,d||ee(o,4,this.length),Y.read(this,o,!0,23,4)},f.prototype.readFloatBE=function(o,d){return o>>>=0,d||ee(o,4,this.length),Y.read(this,o,!1,23,4)},f.prototype.readDoubleLE=function(o,d){return o>>>=0,d||ee(o,8,this.length),Y.read(this,o,!0,52,8)},f.prototype.readDoubleBE=function(o,d){return o>>>=0,d||ee(o,8,this.length),Y.read(this,o,!1,52,8)},f.prototype.writeUIntLE=function(o,d,_,x){if(o=+o,d>>>=0,_>>>=0,!x){var N=i(2,8*_)-1;q(this,o,d,_,N,0)}var z=1,W=0;for(this[d]=255&o;++W<_&&(z*=256);)this[d+W]=255&o/z;return d+_},f.prototype.writeUIntBE=function(o,d,_,x){if(o=+o,d>>>=0,_>>>=0,!x){var N=i(2,8*_)-1;q(this,o,d,_,N,0)}var z=_-1,W=1;for(this[d+z]=255&o;0<=--z&&(W*=256);)this[d+z]=255&o/W;return d+_},f.prototype.writeUInt8=function(o,d,_){return o=+o,d>>>=0,_||q(this,o,d,1,255,0),this[d]=255&o,d+1},f.prototype.writeUInt16LE=function(o,d,_){return o=+o,d>>>=0,_||q(this,o,d,2,65535,0),this[d]=255&o,this[d+1]=o>>>8,d+2},f.prototype.writeUInt16BE=function(o,d,_){return o=+o,d>>>=0,_||q(this,o,d,2,65535,0),this[d]=o>>>8,this[d+1]=255&o,d+2},f.prototype.writeUInt32LE=function(o,d,_){return o=+o,d>>>=0,_||q(this,o,d,4,4294967295,0),this[d+3]=o>>>24,this[d+2]=o>>>16,this[d+1]=o>>>8,this[d]=255&o,d+4},f.prototype.writeUInt32BE=function(o,d,_){return o=+o,d>>>=0,_||q(this,o,d,4,4294967295,0),this[d]=o>>>24,this[d+1]=o>>>16,this[d+2]=o>>>8,this[d+3]=255&o,d+4},f.prototype.writeIntLE=function(o,d,_,x){if(o=+o,d>>>=0,!x){var N=i(2,8*_-1);q(this,o,d,_,N-1,-N)}var z=0,W=1,oe=0;for(this[d]=255&o;++z<_&&(W*=256);)0>o&&oe===0&&this[d+z-1]!==0&&(oe=1),this[d+z]=255&(o/W>>0)-oe;return d+_},f.prototype.writeIntBE=function(o,d,_,x){if(o=+o,d>>>=0,!x){var N=i(2,8*_-1);q(this,o,d,_,N-1,-N)}var z=_-1,W=1,oe=0;for(this[d+z]=255&o;0<=--z&&(W*=256);)0>o&&oe===0&&this[d+z+1]!==0&&(oe=1),this[d+z]=255&(o/W>>0)-oe;return d+_},f.prototype.writeInt8=function(o,d,_){return o=+o,d>>>=0,_||q(this,o,d,1,127,-128),0>o&&(o=255+o+1),this[d]=255&o,d+1},f.prototype.writeInt16LE=function(o,d,_){return o=+o,d>>>=0,_||q(this,o,d,2,32767,-32768),this[d]=255&o,this[d+1]=o>>>8,d+2},f.prototype.writeInt16BE=function(o,d,_){return o=+o,d>>>=0,_||q(this,o,d,2,32767,-32768),this[d]=o>>>8,this[d+1]=255&o,d+2},f.prototype.writeInt32LE=function(o,d,_){return o=+o,d>>>=0,_||q(this,o,d,4,2147483647,-2147483648),this[d]=255&o,this[d+1]=o>>>8,this[d+2]=o>>>16,this[d+3]=o>>>24,d+4},f.prototype.writeInt32BE=function(o,d,_){return o=+o,d>>>=0,_||q(this,o,d,4,2147483647,-2147483648),0>o&&(o=4294967295+o+1),this[d]=o>>>24,this[d+1]=o>>>16,this[d+2]=o>>>8,this[d+3]=255&o,d+4},f.prototype.writeFloatLE=function(o,d,_){return Le(this,o,d,!0,_)},f.prototype.writeFloatBE=function(o,d,_){return Le(this,o,d,!1,_)},f.prototype.writeDoubleLE=function(o,d,_){return Ie(this,o,d,!0,_)},f.prototype.writeDoubleBE=function(o,d,_){return Ie(this,o,d,!1,_)},f.prototype.copy=function(o,d,_,x){if(!f.isBuffer(o))throw new TypeError("argument should be a Buffer");if(_||(_=0),x||x===0||(x=this.length),d>=o.length&&(d=o.length),d||(d=0),0<x&&x<_&&(x=_),x===_||o.length===0||this.length===0)return 0;if(0>d)throw new RangeError("targetStart out of bounds");if(0>_||_>=this.length)throw new RangeError("Index out of range");if(0>x)throw new RangeError("sourceEnd out of bounds");x>this.length&&(x=this.length),o.length-d<x-_&&(x=o.length-d+_);var N=x-_;if(this===o&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(d,_,x);else if(this===o&&_<d&&d<x)for(var z=N-1;0<=z;--z)o[z+d]=this[z+_];else Uint8Array.prototype.set.call(o,this.subarray(_,x),d);return N},f.prototype.fill=function(o,d,_,x){if(typeof o=="string"){if(typeof d=="string"?(x=d,d=0,_=this.length):typeof _=="string"&&(x=_,_=this.length),x!==void 0&&typeof x!="string")throw new TypeError("encoding must be a string");if(typeof x=="string"&&!f.isEncoding(x))throw new TypeError("Unknown encoding: "+x);if(o.length===1){var N=o.charCodeAt(0);(x==="utf8"&&128>N||x==="latin1")&&(o=N)}}else typeof o=="number"&&(o&=255);if(0>d||this.length<d||this.length<_)throw new RangeError("Out of range index");if(_<=d)return this;d>>>=0,_=_===void 0?this.length:_>>>0,o||(o=0);var z;if(typeof o=="number")for(z=d;z<_;++z)this[z]=o;else{var W=f.isBuffer(o)?o:f.from(o,x),oe=W.length;if(oe===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(z=0;z<_-d;++z)this[z+d]=W[z%oe]}return this};var y=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,s("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(s,l,a){(function(c){(function(){function h(){let f;try{f=a.storage.getItem("debug")}catch{}return!f&&typeof c<"u"&&"env"in c&&(f=c.env.DEBUG),f}a.formatArgs=function(f){if(f[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+f[0]+(this.useColors?"%c ":" ")+"+"+l.exports.humanize(this.diff),!this.useColors)return;const p="color: "+this.color;f.splice(1,0,p,"color: inherit");let g=0,m=0;f[0].replace(/%[a-zA-Z%]/g,k=>{k==="%%"||(g++,k==="%c"&&(m=g))}),f.splice(m,0,p)},a.save=function(f){try{f?a.storage.setItem("debug",f):a.storage.removeItem("debug")}catch{}},a.load=h,a.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},a.storage=function(){try{return localStorage}catch{}}(),a.destroy=(()=>{let f=!1;return()=>{f||(f=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),a.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],a.log=console.debug||console.log||(()=>{}),l.exports=s("./common")(a);const{formatters:u}=l.exports;u.j=function(f){try{return JSON.stringify(f)}catch(p){return"[UnexpectedJSONParseError]: "+p.message}}}).call(this)}).call(this,s("_process"))},{"./common":5,_process:12}],5:[function(s,l){l.exports=function(a){function c(f){function p(...k){if(!p.enabled)return;const L=p,T=+new Date,M=T-(g||T);L.diff=M,L.prev=g,L.curr=T,g=T,k[0]=c.coerce(k[0]),typeof k[0]!="string"&&k.unshift("%O");let b=0;k[0]=k[0].replace(/%([a-zA-Z%])/g,(w,E)=>{if(w==="%%")return"%";b++;const S=c.formatters[E];if(typeof S=="function"){const v=k[b];w=S.call(L,v),k.splice(b,1),b--}return w}),c.formatArgs.call(L,k),(L.log||c.log).apply(L,k)}let g,m=null;return p.namespace=f,p.useColors=c.useColors(),p.color=c.selectColor(f),p.extend=h,p.destroy=c.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>m===null?c.enabled(f):m,set:k=>{m=k}}),typeof c.init=="function"&&c.init(p),p}function h(f,p){const g=c(this.namespace+(typeof p>"u"?":":p)+f);return g.log=this.log,g}function u(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}return c.debug=c,c.default=c,c.coerce=function(f){return f instanceof Error?f.stack||f.message:f},c.disable=function(){const f=[...c.names.map(u),...c.skips.map(u).map(p=>"-"+p)].join(",");return c.enable(""),f},c.enable=function(f){c.save(f),c.names=[],c.skips=[];let p;const g=(typeof f=="string"?f:"").split(/[\s,]+/),m=g.length;for(p=0;p<m;p++)g[p]&&(f=g[p].replace(/\*/g,".*?"),f[0]==="-"?c.skips.push(new RegExp("^"+f.substr(1)+"$")):c.names.push(new RegExp("^"+f+"$")))},c.enabled=function(f){if(f[f.length-1]==="*")return!0;let p,g;for(p=0,g=c.skips.length;p<g;p++)if(c.skips[p].test(f))return!1;for(p=0,g=c.names.length;p<g;p++)if(c.names[p].test(f))return!0;return!1},c.humanize=s("ms"),c.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(a).forEach(f=>{c[f]=a[f]}),c.names=[],c.skips=[],c.formatters={},c.selectColor=function(f){let p=0;for(let g=0;g<f.length;g++)p=(p<<5)-p+f.charCodeAt(g),p|=0;return c.colors[r(p)%c.colors.length]},c.enable(c.load()),c}},{ms:11}],6:[function(s,l){function a(c,h){for(const u in h)Object.defineProperty(c,u,{value:h[u],enumerable:!0,configurable:!0});return c}l.exports=function(c,h,u){if(!c||typeof c=="string")throw new TypeError("Please pass an Error to err-code");u||(u={}),typeof h=="object"&&(u=h,h=""),h&&(u.code=h);try{return a(c,u)}catch{u.message=c.message,u.stack=c.stack;const f=function(){};return f.prototype=Object.create(Object.getPrototypeOf(c)),a(new f,u)}}},{}],7:[function(s,l){function a(C){console&&console.warn&&console.warn(C)}function c(){c.init.call(this)}function h(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}function u(C){return C._maxListeners===void 0?c.defaultMaxListeners:C._maxListeners}function f(C,A,I,B){var V,H,K;if(h(I),H=C._events,H===void 0?(H=C._events=Object.create(null),C._eventsCount=0):(H.newListener!==void 0&&(C.emit("newListener",A,I.listener?I.listener:I),H=C._events),K=H[A]),K===void 0)K=H[A]=I,++C._eventsCount;else if(typeof K=="function"?K=H[A]=B?[I,K]:[K,I]:B?K.unshift(I):K.push(I),V=u(C),0<V&&K.length>V&&!K.warned){K.warned=!0;var J=new Error("Possible EventEmitter memory leak detected. "+K.length+" "+(A+" listeners added. Use emitter.setMaxListeners() to increase limit"));J.name="MaxListenersExceededWarning",J.emitter=C,J.type=A,J.count=K.length,a(J)}return C}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(C,A,I){var B={fired:!1,wrapFn:void 0,target:C,type:A,listener:I},V=p.bind(B);return V.listener=I,B.wrapFn=V,V}function m(C,A,I){var B=C._events;if(B===void 0)return[];var V=B[A];return V===void 0?[]:typeof V=="function"?I?[V.listener||V]:[V]:I?M(V):L(V,V.length)}function k(C){var A=this._events;if(A!==void 0){var I=A[C];if(typeof I=="function")return 1;if(I!==void 0)return I.length}return 0}function L(C,A){for(var I=Array(A),B=0;B<A;++B)I[B]=C[B];return I}function T(C,A){for(;A+1<C.length;A++)C[A]=C[A+1];C.pop()}function M(C){for(var A=Array(C.length),I=0;I<A.length;++I)A[I]=C[I].listener||C[I];return A}function b(C,A,I){typeof C.on=="function"&&w(C,"error",A,I)}function w(C,A,I,B){if(typeof C.on=="function")B.once?C.once(A,I):C.on(A,I);else if(typeof C.addEventListener=="function")C.addEventListener(A,function V(H){B.once&&C.removeEventListener(A,V),I(H)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}var E,S=typeof Reflect=="object"?Reflect:null,v=S&&typeof S.apply=="function"?S.apply:function(C,A,I){return Function.prototype.apply.call(C,A,I)};E=S&&typeof S.ownKeys=="function"?S.ownKeys:Object.getOwnPropertySymbols?function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:function(C){return Object.getOwnPropertyNames(C)};var R=Number.isNaN||function(C){return C!==C};l.exports=c,l.exports.once=function(C,A){return new Promise(function(I,B){function V(K){C.removeListener(A,H),B(K)}function H(){typeof C.removeListener=="function"&&C.removeListener("error",V),I([].slice.call(arguments))}w(C,A,H,{once:!0}),A!=="error"&&b(C,V,{once:!0})})},c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var D=10;Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return D},set:function(C){if(typeof C!="number"||0>C||R(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");D=C}}),c.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(C){if(typeof C!="number"||0>C||R(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this},c.prototype.getMaxListeners=function(){return u(this)},c.prototype.emit=function(C){for(var A=[],I=1;I<arguments.length;I++)A.push(arguments[I]);var B=C==="error",V=this._events;if(V!==void 0)B=B&&V.error===void 0;else if(!B)return!1;if(B){var H;if(0<A.length&&(H=A[0]),H instanceof Error)throw H;var K=new Error("Unhandled error."+(H?" ("+H.message+")":""));throw K.context=H,K}var J=V[C];if(J===void 0)return!1;if(typeof J=="function")v(J,this,A);else for(var Q=J.length,F=L(J,Q),I=0;I<Q;++I)v(F[I],this,A);return!0},c.prototype.addListener=function(C,A){return f(this,C,A,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(C,A){return f(this,C,A,!0)},c.prototype.once=function(C,A){return h(A),this.on(C,g(this,C,A)),this},c.prototype.prependOnceListener=function(C,A){return h(A),this.prependListener(C,g(this,C,A)),this},c.prototype.removeListener=function(C,A){var I,B,V,H,K;if(h(A),B=this._events,B===void 0)return this;if(I=B[C],I===void 0)return this;if(I===A||I.listener===A)--this._eventsCount==0?this._events=Object.create(null):(delete B[C],B.removeListener&&this.emit("removeListener",C,I.listener||A));else if(typeof I!="function"){for(V=-1,H=I.length-1;0<=H;H--)if(I[H]===A||I[H].listener===A){K=I[H].listener,V=H;break}if(0>V)return this;V===0?I.shift():T(I,V),I.length===1&&(B[C]=I[0]),B.removeListener!==void 0&&this.emit("removeListener",C,K||A)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(C){var A,I,B;if(I=this._events,I===void 0)return this;if(I.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):I[C]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete I[C]),this;if(arguments.length===0){var V,H=Object.keys(I);for(B=0;B<H.length;++B)V=H[B],V!=="removeListener"&&this.removeAllListeners(V);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=I[C],typeof A=="function")this.removeListener(C,A);else if(A!==void 0)for(B=A.length-1;0<=B;B--)this.removeListener(C,A[B]);return this},c.prototype.listeners=function(C){return m(this,C,!0)},c.prototype.rawListeners=function(C){return m(this,C,!1)},c.listenerCount=function(C,A){return typeof C.listenerCount=="function"?C.listenerCount(A):k.call(C,A)},c.prototype.listenerCount=k,c.prototype.eventNames=function(){return 0<this._eventsCount?E(this._events):[]}},{}],8:[function(s,l){l.exports=function(){if(typeof globalThis>"u")return null;var a={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return a.RTCPeerConnection?a:null}},{}],9:[function(s,l,a){a.read=function(c,h,u,f,p){var g,m,k=8*p-f-1,L=(1<<k)-1,T=L>>1,M=-7,b=u?p-1:0,w=u?-1:1,E=c[h+b];for(b+=w,g=E&(1<<-M)-1,E>>=-M,M+=k;0<M;g=256*g+c[h+b],b+=w,M-=8);for(m=g&(1<<-M)-1,g>>=-M,M+=f;0<M;m=256*m+c[h+b],b+=w,M-=8);if(g===0)g=1-T;else{if(g===L)return m?NaN:(E?-1:1)*(1/0);m+=i(2,f),g-=T}return(E?-1:1)*m*i(2,g-f)},a.write=function(c,h,u,f,p,g){var m,k,L,T=Math.LN2,M=Math.log,b=8*g-p-1,w=(1<<b)-1,E=w>>1,S=p===23?i(2,-24)-i(2,-77):0,v=f?0:g-1,R=f?1:-1,D=0>h||h===0&&0>1/h?1:0;for(h=r(h),isNaN(h)||h===1/0?(k=isNaN(h)?1:0,m=w):(m=n(M(h)/T),1>h*(L=i(2,-m))&&(m--,L*=2),h+=1<=m+E?S/L:S*i(2,1-E),2<=h*L&&(m++,L/=2),m+E>=w?(k=0,m=w):1<=m+E?(k=(h*L-1)*i(2,p),m+=E):(k=h*i(2,E-1)*i(2,p),m=0));8<=p;c[u+v]=255&k,v+=R,k/=256,p-=8);for(m=m<<p|k,b+=p;0<b;c[u+v]=255&m,v+=R,m/=256,b-=8);c[u+v-R]|=128*D}},{}],10:[function(s,l){l.exports=typeof Object.create=="function"?function(a,c){c&&(a.super_=c,a.prototype=Object.create(c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:function(a,c){if(c){a.super_=c;var h=function(){};h.prototype=c.prototype,a.prototype=new h,a.prototype.constructor=a}}},{}],11:[function(s,l){var a=Math.round;function c(p){if(p+="",!(100<p.length)){var g=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(g){var m=parseFloat(g[1]),k=(g[2]||"ms").toLowerCase();return k==="years"||k==="year"||k==="yrs"||k==="yr"||k==="y"?315576e5*m:k==="weeks"||k==="week"||k==="w"?6048e5*m:k==="days"||k==="day"||k==="d"?864e5*m:k==="hours"||k==="hour"||k==="hrs"||k==="hr"||k==="h"?36e5*m:k==="minutes"||k==="minute"||k==="mins"||k==="min"||k==="m"?6e4*m:k==="seconds"||k==="second"||k==="secs"||k==="sec"||k==="s"?1e3*m:k==="milliseconds"||k==="millisecond"||k==="msecs"||k==="msec"||k==="ms"?m:void 0}}}function h(p){var g=r(p);return 864e5<=g?a(p/864e5)+"d":36e5<=g?a(p/36e5)+"h":6e4<=g?a(p/6e4)+"m":1e3<=g?a(p/1e3)+"s":p+"ms"}function u(p){var g=r(p);return 864e5<=g?f(p,g,864e5,"day"):36e5<=g?f(p,g,36e5,"hour"):6e4<=g?f(p,g,6e4,"minute"):1e3<=g?f(p,g,1e3,"second"):p+" ms"}function f(p,g,m,k){return a(p/m)+" "+k+(g>=1.5*m?"s":"")}l.exports=function(p,g){g=g||{};var m=typeof p;if(m=="string"&&0<p.length)return c(p);if(m==="number"&&isFinite(p))return g.long?u(p):h(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))}},{}],12:[function(s,l){function a(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function h(S){if(k===setTimeout)return setTimeout(S,0);if((k===a||!k)&&setTimeout)return k=setTimeout,setTimeout(S,0);try{return k(S,0)}catch{try{return k.call(null,S,0)}catch{return k.call(this,S,0)}}}function u(S){if(L===clearTimeout)return clearTimeout(S);if((L===c||!L)&&clearTimeout)return L=clearTimeout,clearTimeout(S);try{return L(S)}catch{try{return L.call(null,S)}catch{return L.call(this,S)}}}function f(){w&&M&&(w=!1,M.length?b=M.concat(b):E=-1,b.length&&p())}function p(){if(!w){var S=h(f);w=!0;for(var v=b.length;v;){for(M=b,b=[];++E<v;)M&&M[E].run();E=-1,v=b.length}M=null,w=!1,u(S)}}function g(S,v){this.fun=S,this.array=v}function m(){}var k,L,T=l.exports={};(function(){try{k=typeof setTimeout=="function"?setTimeout:a}catch{k=a}try{L=typeof clearTimeout=="function"?clearTimeout:c}catch{L=c}})();var M,b=[],w=!1,E=-1;T.nextTick=function(S){var v=Array(arguments.length-1);if(1<arguments.length)for(var R=1;R<arguments.length;R++)v[R-1]=arguments[R];b.push(new g(S,v)),b.length!==1||w||h(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},T.title="browser",T.browser=!0,T.env={},T.argv=[],T.version="",T.versions={},T.on=m,T.addListener=m,T.once=m,T.off=m,T.removeListener=m,T.removeAllListeners=m,T.emit=m,T.prependListener=m,T.prependOnceListener=m,T.listeners=function(){return[]},T.binding=function(){throw new Error("process.binding is not supported")},T.cwd=function(){return"/"},T.chdir=function(){throw new Error("process.chdir is not supported")},T.umask=function(){return 0}},{}],13:[function(s,l){(function(a){(function(){let c;l.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?a:window):h=>(c||(c=Promise.resolve())).then(h).catch(u=>setTimeout(()=>{throw u},0))}).call(this)}).call(this,typeof bt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:bt)},{}],14:[function(s,l){(function(a,c){(function(){var h=s("safe-buffer").Buffer,u=c.crypto||c.msCrypto;l.exports=u&&u.getRandomValues?function(f,p){if(f>4294967295)throw new RangeError("requested too many random bytes");var g=h.allocUnsafe(f);if(0<f)if(65536<f)for(var m=0;m<f;m+=65536)u.getRandomValues(g.slice(m,m+65536));else u.getRandomValues(g);return typeof p=="function"?a.nextTick(function(){p(null,g)}):g}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,s("_process"),typeof bt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:bt)},{_process:12,"safe-buffer":30}],15:[function(s,l){function a(m,k){m.prototype=Object.create(k.prototype),m.prototype.constructor=m,m.__proto__=k}function c(m,k,L){function T(b,w,E){return typeof k=="string"?k:k(b,w,E)}L||(L=Error);var M=function(b){function w(E,S,v){return b.call(this,T(E,S,v))||this}return a(w,b),w}(L);M.prototype.name=L.name,M.prototype.code=m,g[m]=M}function h(m,k){if(Array.isArray(m)){var L=m.length;return m=m.map(function(T){return T+""}),2<L?"one of ".concat(k," ").concat(m.slice(0,L-1).join(", "),", or ")+m[L-1]:L===2?"one of ".concat(k," ").concat(m[0]," or ").concat(m[1]):"of ".concat(k," ").concat(m[0])}return"of ".concat(k," ").concat(m+"")}function u(m,k,L){return m.substr(!L||0>L?0:+L,k.length)===k}function f(m,k,L){return(L===void 0||L>m.length)&&(L=m.length),m.substring(L-k.length,L)===k}function p(m,k,L){return typeof L!="number"&&(L=0),!(L+k.length>m.length)&&m.indexOf(k,L)!==-1}var g={};c("ERR_INVALID_OPT_VALUE",function(m,k){return'The value "'+k+'" is invalid for option "'+m+'"'},TypeError),c("ERR_INVALID_ARG_TYPE",function(m,k,L){var T;typeof k=="string"&&u(k,"not ")?(T="must not be",k=k.replace(/^not /,"")):T="must be";var M;if(f(m," argument"))M="The ".concat(m," ").concat(T," ").concat(h(k,"type"));else{var b=p(m,".")?"property":"argument";M='The "'.concat(m,'" ').concat(b," ").concat(T," ").concat(h(k,"type"))}return M+=". Received type ".concat(typeof L),M},TypeError),c("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),c("ERR_METHOD_NOT_IMPLEMENTED",function(m){return"The "+m+" method is not implemented"}),c("ERR_STREAM_PREMATURE_CLOSE","Premature close"),c("ERR_STREAM_DESTROYED",function(m){return"Cannot call "+m+" after a stream was destroyed"}),c("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),c("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),c("ERR_STREAM_WRITE_AFTER_END","write after end"),c("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),c("ERR_UNKNOWN_ENCODING",function(m){return"Unknown encoding: "+m},TypeError),c("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),l.exports.codes=g},{}],16:[function(s,l){(function(a){(function(){function c(T){return this instanceof c?(p.call(this,T),g.call(this,T),this.allowHalfOpen=!0,void(T&&(T.readable===!1&&(this.readable=!1),T.writable===!1&&(this.writable=!1),T.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h))))):new c(T)}function h(){this._writableState.ended||a.nextTick(u,this)}function u(T){T.end()}var f=Object.keys||function(T){var M=[];for(var b in T)M.push(b);return M};l.exports=c;var p=s("./_stream_readable"),g=s("./_stream_writable");s("inherits")(c,p);for(var m,k=f(g.prototype),L=0;L<k.length;L++)m=k[L],c.prototype[m]||(c.prototype[m]=g.prototype[m]);Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(T){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=T,this._writableState.destroyed=T)}})}).call(this)}).call(this,s("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(s,l){function a(h){return this instanceof a?void c.call(this,h):new a(h)}l.exports=a;var c=s("./_stream_transform");s("inherits")(a,c),a.prototype._transform=function(h,u,f){f(null,h)}},{"./_stream_transform":19,inherits:10}],18:[function(s,l){(function(a,c){(function(){function h(y){return fe.from(y)}function u(y){return fe.isBuffer(y)||y instanceof ee}function f(y,o,d){return typeof y.prependListener=="function"?y.prependListener(o,d):void(y._events&&y._events[o]?Array.isArray(y._events[o])?y._events[o].unshift(d):y._events[o]=[d,y._events[o]]:y.on(o,d))}function p(y,o,d){Q=Q||s("./_stream_duplex"),y=y||{},typeof d!="boolean"&&(d=o instanceof Q),this.objectMode=!!y.objectMode,d&&(this.objectMode=this.objectMode||!!y.readableObjectMode),this.highWaterMark=pt(this,y,"readableHighWaterMark",d),this.buffer=new ze,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=y.emitClose!==!1,this.autoDestroy=!!y.autoDestroy,this.destroyed=!1,this.defaultEncoding=y.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,y.encoding&&(!ie&&(ie=s("string_decoder/").StringDecoder),this.decoder=new ie(y.encoding),this.encoding=y.encoding)}function g(y){if(Q=Q||s("./_stream_duplex"),!(this instanceof g))return new g(y);var o=this instanceof Q;this._readableState=new p(y,this,o),this.readable=!0,y&&(typeof y.read=="function"&&(this._read=y.read),typeof y.destroy=="function"&&(this._destroy=y.destroy)),he.call(this)}function m(y,o,d,_,x){F("readableAddChunk",o);var N=y._readableState;if(o===null)N.reading=!1,b(y,N);else{var z;if(x||(z=L(N,o)),z)j(y,z);else if(!(N.objectMode||o&&0<o.length))_||(N.reading=!1,S(y,N));else if(typeof o=="string"||N.objectMode||Object.getPrototypeOf(o)===fe.prototype||(o=h(o)),_)N.endEmitted?j(y,new P):k(y,N,o,!0);else if(N.ended)j(y,new et);else{if(N.destroyed)return!1;N.reading=!1,N.decoder&&!d?(o=N.decoder.write(o),N.objectMode||o.length!==0?k(y,N,o,!1):S(y,N)):k(y,N,o,!1)}}return!N.ended&&(N.length<N.highWaterMark||N.length===0)}function k(y,o,d,_){o.flowing&&o.length===0&&!o.sync?(o.awaitDrain=0,y.emit("data",d)):(o.length+=o.objectMode?1:d.length,_?o.buffer.unshift(d):o.buffer.push(d),o.needReadable&&w(y)),S(y,o)}function L(y,o){var d;return u(o)||typeof o=="string"||o===void 0||y.objectMode||(d=new Qe("chunk",["string","Buffer","Uint8Array"],o)),d}function T(y){return 1073741824<=y?y=1073741824:(y--,y|=y>>>1,y|=y>>>2,y|=y>>>4,y|=y>>>8,y|=y>>>16,y++),y}function M(y,o){return 0>=y||o.length===0&&o.ended?0:o.objectMode?1:y===y?(y>o.highWaterMark&&(o.highWaterMark=T(y)),y<=o.length?y:o.ended?o.length:(o.needReadable=!0,0)):o.flowing&&o.length?o.buffer.head.data.length:o.length}function b(y,o){if(F("onEofChunk"),!o.ended){if(o.decoder){var d=o.decoder.end();d&&d.length&&(o.buffer.push(d),o.length+=o.objectMode?1:d.length)}o.ended=!0,o.sync?w(y):(o.needReadable=!1,!o.emittedReadable&&(o.emittedReadable=!0,E(y)))}}function w(y){var o=y._readableState;F("emitReadable",o.needReadable,o.emittedReadable),o.needReadable=!1,o.emittedReadable||(F("emitReadable",o.flowing),o.emittedReadable=!0,a.nextTick(E,y))}function E(y){var o=y._readableState;F("emitReadable_",o.destroyed,o.length,o.ended),!o.destroyed&&(o.length||o.ended)&&(y.emit("readable"),o.emittedReadable=!1),o.needReadable=!o.flowing&&!o.ended&&o.length<=o.highWaterMark,B(y)}function S(y,o){o.readingMore||(o.readingMore=!0,a.nextTick(v,y,o))}function v(y,o){for(;!o.reading&&!o.ended&&(o.length<o.highWaterMark||o.flowing&&o.length===0);){var d=o.length;if(F("maybeReadMore read 0"),y.read(0),d===o.length)break}o.readingMore=!1}function R(y){return function(){var o=y._readableState;F("pipeOnDrain",o.awaitDrain),o.awaitDrain&&o.awaitDrain--,o.awaitDrain===0&&ue(y,"data")&&(o.flowing=!0,B(y))}}function D(y){var o=y._readableState;o.readableListening=0<y.listenerCount("readable"),o.resumeScheduled&&!o.paused?o.flowing=!0:0<y.listenerCount("data")&&y.resume()}function C(y){F("readable nexttick read 0"),y.read(0)}function A(y,o){o.resumeScheduled||(o.resumeScheduled=!0,a.nextTick(I,y,o))}function I(y,o){F("resume",o.reading),o.reading||y.read(0),o.resumeScheduled=!1,y.emit("resume"),B(y),o.flowing&&!o.reading&&y.read(0)}function B(y){var o=y._readableState;for(F("flow",o.flowing);o.flowing&&y.read()!==null;);}function V(y,o){if(o.length===0)return null;var d;return o.objectMode?d=o.buffer.shift():!y||y>=o.length?(d=o.decoder?o.buffer.join(""):o.buffer.length===1?o.buffer.first():o.buffer.concat(o.length),o.buffer.clear()):d=o.buffer.consume(y,o.decoder),d}function H(y){var o=y._readableState;F("endReadable",o.endEmitted),o.endEmitted||(o.ended=!0,a.nextTick(K,o,y))}function K(y,o){if(F("endReadableNT",y.endEmitted,y.length),!y.endEmitted&&y.length===0&&(y.endEmitted=!0,o.readable=!1,o.emit("end"),y.autoDestroy)){var d=o._writableState;(!d||d.autoDestroy&&d.finished)&&o.destroy()}}function J(y,o){for(var d=0,_=y.length;d<_;d++)if(y[d]===o)return d;return-1}l.exports=g;var Q;g.ReadableState=p;var F;s("events").EventEmitter;var ue=function(y,o){return y.listeners(o).length},he=s("./internal/streams/stream"),fe=s("buffer").Buffer,ee=c.Uint8Array||function(){},q=s("util");F=q&&q.debuglog?q.debuglog("stream"):function(){};var ie,Le,Ie,ze=s("./internal/streams/buffer_list"),gt=s("./internal/streams/destroy"),Ke=s("./internal/streams/state"),pt=Ke.getHighWaterMark,Bt=s("../errors").codes,Qe=Bt.ERR_INVALID_ARG_TYPE,et=Bt.ERR_STREAM_PUSH_AFTER_EOF,O=Bt.ERR_METHOD_NOT_IMPLEMENTED,P=Bt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;s("inherits")(g,he);var j=gt.errorOrDestroy,Y=["error","close","destroy","pause","resume"];Object.defineProperty(g.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(y){this._readableState&&(this._readableState.destroyed=y)}}),g.prototype.destroy=gt.destroy,g.prototype._undestroy=gt.undestroy,g.prototype._destroy=function(y,o){o(y)},g.prototype.push=function(y,o){var d,_=this._readableState;return _.objectMode?d=!0:typeof y=="string"&&(o=o||_.defaultEncoding,o!==_.encoding&&(y=fe.from(y,o),o=""),d=!0),m(this,y,o,!1,d)},g.prototype.unshift=function(y){return m(this,y,null,!0,!1)},g.prototype.isPaused=function(){return this._readableState.flowing===!1},g.prototype.setEncoding=function(y){ie||(ie=s("string_decoder/").StringDecoder);var o=new ie(y);this._readableState.decoder=o,this._readableState.encoding=this._readableState.decoder.encoding;for(var d=this._readableState.buffer.head,_="";d!==null;)_+=o.write(d.data),d=d.next;return this._readableState.buffer.clear(),_!==""&&this._readableState.buffer.push(_),this._readableState.length=_.length,this},g.prototype.read=function(y){F("read",y),y=parseInt(y,10);var o=this._readableState,d=y;if(y!==0&&(o.emittedReadable=!1),y===0&&o.needReadable&&((o.highWaterMark===0?0<o.length:o.length>=o.highWaterMark)||o.ended))return F("read: emitReadable",o.length,o.ended),o.length===0&&o.ended?H(this):w(this),null;if(y=M(y,o),y===0&&o.ended)return o.length===0&&H(this),null;var _=o.needReadable;F("need readable",_),(o.length===0||o.length-y<o.highWaterMark)&&(_=!0,F("length less than watermark",_)),o.ended||o.reading?(_=!1,F("reading or ended",_)):_&&(F("do read"),o.reading=!0,o.sync=!0,o.length===0&&(o.needReadable=!0),this._read(o.highWaterMark),o.sync=!1,!o.reading&&(y=M(d,o)));var x;return x=0<y?V(y,o):null,x===null?(o.needReadable=o.length<=o.highWaterMark,y=0):(o.length-=y,o.awaitDrain=0),o.length===0&&(!o.ended&&(o.needReadable=!0),d!==y&&o.ended&&H(this)),x!==null&&this.emit("data",x),x},g.prototype._read=function(){j(this,new O("_read()"))},g.prototype.pipe=function(y,o){function d(xn,Rn){F("onunpipe"),xn===ae&&Rn&&Rn.hasUnpiped===!1&&(Rn.hasUnpiped=!0,x())}function _(){F("onend"),y.end()}function x(){F("cleanup"),y.removeListener("close",W),y.removeListener("finish",oe),y.removeListener("drain",Sn),y.removeListener("error",z),y.removeListener("unpipe",d),ae.removeListener("end",_),ae.removeListener("end",_e),ae.removeListener("data",N),dr=!0,se.awaitDrain&&(!y._writableState||y._writableState.needDrain)&&Sn()}function N(xn){F("ondata");var Rn=y.write(xn);F("dest.write",Rn),Rn===!1&&((se.pipesCount===1&&se.pipes===y||1<se.pipesCount&&J(se.pipes,y)!==-1)&&!dr&&(F("false write response, pause",se.awaitDrain),se.awaitDrain++),ae.pause())}function z(xn){F("onerror",xn),_e(),y.removeListener("error",z),ue(y,"error")===0&&j(y,xn)}function W(){y.removeListener("finish",oe),_e()}function oe(){F("onfinish"),y.removeListener("close",W),_e()}function _e(){F("unpipe"),ae.unpipe(y)}var ae=this,se=this._readableState;switch(se.pipesCount){case 0:se.pipes=y;break;case 1:se.pipes=[se.pipes,y];break;default:se.pipes.push(y)}se.pipesCount+=1,F("pipe count=%d opts=%j",se.pipesCount,o);var Ne=(!o||o.end!==!1)&&y!==a.stdout&&y!==a.stderr,nn=Ne?_:_e;se.endEmitted?a.nextTick(nn):ae.once("end",nn),y.on("unpipe",d);var Sn=R(ae);y.on("drain",Sn);var dr=!1;return ae.on("data",N),f(y,"error",z),y.once("close",W),y.once("finish",oe),y.emit("pipe",ae),se.flowing||(F("pipe resume"),ae.resume()),y},g.prototype.unpipe=function(y){var o=this._readableState,d={hasUnpiped:!1};if(o.pipesCount===0)return this;if(o.pipesCount===1)return y&&y!==o.pipes?this:(y||(y=o.pipes),o.pipes=null,o.pipesCount=0,o.flowing=!1,y&&y.emit("unpipe",this,d),this);if(!y){var _=o.pipes,x=o.pipesCount;o.pipes=null,o.pipesCount=0,o.flowing=!1;for(var N=0;N<x;N++)_[N].emit("unpipe",this,{hasUnpiped:!1});return this}var z=J(o.pipes,y);return z===-1?this:(o.pipes.splice(z,1),o.pipesCount-=1,o.pipesCount===1&&(o.pipes=o.pipes[0]),y.emit("unpipe",this,d),this)},g.prototype.on=function(y,o){var d=he.prototype.on.call(this,y,o),_=this._readableState;return y==="data"?(_.readableListening=0<this.listenerCount("readable"),_.flowing!==!1&&this.resume()):y=="readable"&&!_.endEmitted&&!_.readableListening&&(_.readableListening=_.needReadable=!0,_.flowing=!1,_.emittedReadable=!1,F("on readable",_.length,_.reading),_.length?w(this):!_.reading&&a.nextTick(C,this)),d},g.prototype.addListener=g.prototype.on,g.prototype.removeListener=function(y,o){var d=he.prototype.removeListener.call(this,y,o);return y==="readable"&&a.nextTick(D,this),d},g.prototype.removeAllListeners=function(y){var o=he.prototype.removeAllListeners.apply(this,arguments);return(y==="readable"||y===void 0)&&a.nextTick(D,this),o},g.prototype.resume=function(){var y=this._readableState;return y.flowing||(F("resume"),y.flowing=!y.readableListening,A(this,y)),y.paused=!1,this},g.prototype.pause=function(){return F("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(F("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},g.prototype.wrap=function(y){var o=this,d=this._readableState,_=!1;for(var x in y.on("end",function(){if(F("wrapped end"),d.decoder&&!d.ended){var z=d.decoder.end();z&&z.length&&o.push(z)}o.push(null)}),y.on("data",function(z){if(F("wrapped data"),d.decoder&&(z=d.decoder.write(z)),!(d.objectMode&&z==null)&&(d.objectMode||z&&z.length)){var W=o.push(z);W||(_=!0,y.pause())}}),y)this[x]===void 0&&typeof y[x]=="function"&&(this[x]=function(z){return function(){return y[z].apply(y,arguments)}}(x));for(var N=0;N<Y.length;N++)y.on(Y[N],this.emit.bind(this,Y[N]));return this._read=function(z){F("wrapped _read",z),_&&(_=!1,y.resume())},this},typeof Symbol=="function"&&(g.prototype[Symbol.asyncIterator]=function(){return Le===void 0&&(Le=s("./internal/streams/async_iterator")),Le(this)}),Object.defineProperty(g.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(g.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(g.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(y){this._readableState&&(this._readableState.flowing=y)}}),g._fromList=V,Object.defineProperty(g.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(g.from=function(y,o){return Ie===void 0&&(Ie=s("./internal/streams/from")),Ie(g,y,o)})}).call(this)}).call(this,s("_process"),typeof bt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:bt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(s,l){function a(T,M){var b=this._transformState;b.transforming=!1;var w=b.writecb;if(w===null)return this.emit("error",new g);b.writechunk=null,b.writecb=null,M!=null&&this.push(M),w(T);var E=this._readableState;E.reading=!1,(E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}function c(T){return this instanceof c?(L.call(this,T),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,T&&(typeof T.transform=="function"&&(this._transform=T.transform),typeof T.flush=="function"&&(this._flush=T.flush)),void this.on("prefinish",h)):new c(T)}function h(){var T=this;typeof this._flush!="function"||this._readableState.destroyed?u(this,null,null):this._flush(function(M,b){u(T,M,b)})}function u(T,M,b){if(M)return T.emit("error",M);if(b!=null&&T.push(b),T._writableState.length)throw new k;if(T._transformState.transforming)throw new m;return T.push(null)}l.exports=c;var f=s("../errors").codes,p=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,m=f.ERR_TRANSFORM_ALREADY_TRANSFORMING,k=f.ERR_TRANSFORM_WITH_LENGTH_0,L=s("./_stream_duplex");s("inherits")(c,L),c.prototype.push=function(T,M){return this._transformState.needTransform=!1,L.prototype.push.call(this,T,M)},c.prototype._transform=function(T,M,b){b(new p("_transform()"))},c.prototype._write=function(T,M,b){var w=this._transformState;if(w.writecb=b,w.writechunk=T,w.writeencoding=M,!w.transforming){var E=this._readableState;(w.needTransform||E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}},c.prototype._read=function(){var T=this._transformState;T.writechunk===null||T.transforming?T.needTransform=!0:(T.transforming=!0,this._transform(T.writechunk,T.writeencoding,T.afterTransform))},c.prototype._destroy=function(T,M){L.prototype._destroy.call(this,T,function(b){M(b)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(s,l){(function(a,c){(function(){function h(O){var P=this;this.next=null,this.entry=null,this.finish=function(){H(P,O)}}function u(O){return F.from(O)}function f(O){return F.isBuffer(O)||O instanceof ue}function p(){}function g(O,P,j){K=K||s("./_stream_duplex"),O=O||{},typeof j!="boolean"&&(j=P instanceof K),this.objectMode=!!O.objectMode,j&&(this.objectMode=this.objectMode||!!O.writableObjectMode),this.highWaterMark=ee(this,O,"writableHighWaterMark",j),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Y=O.decodeStrings===!1;this.decodeStrings=!Y,this.defaultEncoding=O.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(y){S(P,y)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=O.emitClose!==!1,this.autoDestroy=!!O.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new h(this)}function m(O){K=K||s("./_stream_duplex");var P=this instanceof K;return P||et.call(m,this)?(this._writableState=new g(O,this,P),this.writable=!0,O&&(typeof O.write=="function"&&(this._write=O.write),typeof O.writev=="function"&&(this._writev=O.writev),typeof O.destroy=="function"&&(this._destroy=O.destroy),typeof O.final=="function"&&(this._final=O.final)),void Q.call(this)):new m(O)}function k(O,P){var j=new pt;Qe(O,j),a.nextTick(P,j)}function L(O,P,j,Y){var y;return j===null?y=new Ke:typeof j!="string"&&!P.objectMode&&(y=new ie("chunk",["string","Buffer"],j)),!y||(Qe(O,y),a.nextTick(Y,y),!1)}function T(O,P,j){return O.objectMode||O.decodeStrings===!1||typeof P!="string"||(P=F.from(P,j)),P}function M(O,P,j,Y,y,o){if(!j){var d=T(P,Y,y);Y!==d&&(j=!0,y="buffer",Y=d)}var _=P.objectMode?1:Y.length;P.length+=_;var x=P.length<P.highWaterMark;if(x||(P.needDrain=!0),P.writing||P.corked){var N=P.lastBufferedRequest;P.lastBufferedRequest={chunk:Y,encoding:y,isBuf:j,callback:o,next:null},N?N.next=P.lastBufferedRequest:P.bufferedRequest=P.lastBufferedRequest,P.bufferedRequestCount+=1}else b(O,P,!1,_,Y,y,o);return x}function b(O,P,j,Y,y,o,d){P.writelen=Y,P.writecb=d,P.writing=!0,P.sync=!0,P.destroyed?P.onwrite(new gt("write")):j?O._writev(y,P.onwrite):O._write(y,o,P.onwrite),P.sync=!1}function w(O,P,j,Y,y){--P.pendingcb,j?(a.nextTick(y,Y),a.nextTick(B,O,P),O._writableState.errorEmitted=!0,Qe(O,Y)):(y(Y),O._writableState.errorEmitted=!0,Qe(O,Y),B(O,P))}function E(O){O.writing=!1,O.writecb=null,O.length-=O.writelen,O.writelen=0}function S(O,P){var j=O._writableState,Y=j.sync,y=j.writecb;if(typeof y!="function")throw new Ie;if(E(j),P)w(O,j,Y,P,y);else{var o=C(j)||O.destroyed;o||j.corked||j.bufferProcessing||!j.bufferedRequest||D(O,j),Y?a.nextTick(v,O,j,o,y):v(O,j,o,y)}}function v(O,P,j,Y){j||R(O,P),P.pendingcb--,Y(),B(O,P)}function R(O,P){P.length===0&&P.needDrain&&(P.needDrain=!1,O.emit("drain"))}function D(O,P){P.bufferProcessing=!0;var j=P.bufferedRequest;if(O._writev&&j&&j.next){var Y=P.bufferedRequestCount,y=Array(Y),o=P.corkedRequestsFree;o.entry=j;for(var d=0,_=!0;j;)y[d]=j,j.isBuf||(_=!1),j=j.next,d+=1;y.allBuffers=_,b(O,P,!0,P.length,y,"",o.finish),P.pendingcb++,P.lastBufferedRequest=null,o.next?(P.corkedRequestsFree=o.next,o.next=null):P.corkedRequestsFree=new h(P),P.bufferedRequestCount=0}else{for(;j;){var x=j.chunk,N=j.encoding,z=j.callback,W=P.objectMode?1:x.length;if(b(O,P,!1,W,x,N,z),j=j.next,P.bufferedRequestCount--,P.writing)break}j===null&&(P.lastBufferedRequest=null)}P.bufferedRequest=j,P.bufferProcessing=!1}function C(O){return O.ending&&O.length===0&&O.bufferedRequest===null&&!O.finished&&!O.writing}function A(O,P){O._final(function(j){P.pendingcb--,j&&Qe(O,j),P.prefinished=!0,O.emit("prefinish"),B(O,P)})}function I(O,P){P.prefinished||P.finalCalled||(typeof O._final!="function"||P.destroyed?(P.prefinished=!0,O.emit("prefinish")):(P.pendingcb++,P.finalCalled=!0,a.nextTick(A,O,P)))}function B(O,P){var j=C(P);if(j&&(I(O,P),P.pendingcb===0&&(P.finished=!0,O.emit("finish"),P.autoDestroy))){var Y=O._readableState;(!Y||Y.autoDestroy&&Y.endEmitted)&&O.destroy()}return j}function V(O,P,j){P.ending=!0,B(O,P),j&&(P.finished?a.nextTick(j):O.once("finish",j)),P.ended=!0,O.writable=!1}function H(O,P,j){var Y=O.entry;for(O.entry=null;Y;){var y=Y.callback;P.pendingcb--,y(j),Y=Y.next}P.corkedRequestsFree.next=O}l.exports=m;var K;m.WritableState=g;var J={deprecate:s("util-deprecate")},Q=s("./internal/streams/stream"),F=s("buffer").Buffer,ue=c.Uint8Array||function(){},he=s("./internal/streams/destroy"),fe=s("./internal/streams/state"),ee=fe.getHighWaterMark,q=s("../errors").codes,ie=q.ERR_INVALID_ARG_TYPE,Le=q.ERR_METHOD_NOT_IMPLEMENTED,Ie=q.ERR_MULTIPLE_CALLBACK,ze=q.ERR_STREAM_CANNOT_PIPE,gt=q.ERR_STREAM_DESTROYED,Ke=q.ERR_STREAM_NULL_VALUES,pt=q.ERR_STREAM_WRITE_AFTER_END,Bt=q.ERR_UNKNOWN_ENCODING,Qe=he.errorOrDestroy;s("inherits")(m,Q),g.prototype.getBuffer=function(){for(var O=this.bufferedRequest,P=[];O;)P.push(O),O=O.next;return P},function(){try{Object.defineProperty(g.prototype,"buffer",{get:J.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var et;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(et=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(O){return!!et.call(this,O)||this===m&&O&&O._writableState instanceof g}})):et=function(O){return O instanceof this},m.prototype.pipe=function(){Qe(this,new ze)},m.prototype.write=function(O,P,j){var Y=this._writableState,y=!1,o=!Y.objectMode&&f(O);return o&&!F.isBuffer(O)&&(O=u(O)),typeof P=="function"&&(j=P,P=null),o?P="buffer":!P&&(P=Y.defaultEncoding),typeof j!="function"&&(j=p),Y.ending?k(this,j):(o||L(this,Y,O,j))&&(Y.pendingcb++,y=M(this,Y,o,O,P,j)),y},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var O=this._writableState;O.corked&&(O.corked--,!O.writing&&!O.corked&&!O.bufferProcessing&&O.bufferedRequest&&D(this,O))},m.prototype.setDefaultEncoding=function(O){if(typeof O=="string"&&(O=O.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((O+"").toLowerCase())))throw new Bt(O);return this._writableState.defaultEncoding=O,this},Object.defineProperty(m.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(O,P,j){j(new Le("_write()"))},m.prototype._writev=null,m.prototype.end=function(O,P,j){var Y=this._writableState;return typeof O=="function"?(j=O,O=null,P=null):typeof P=="function"&&(j=P,P=null),O!=null&&this.write(O,P),Y.corked&&(Y.corked=1,this.uncork()),Y.ending||V(this,Y,j),this},Object.defineProperty(m.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(m.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(O){this._writableState&&(this._writableState.destroyed=O)}}),m.prototype.destroy=he.destroy,m.prototype._undestroy=he.undestroy,m.prototype._destroy=function(O,P){P(O)}}).call(this)}).call(this,s("_process"),typeof bt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:bt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(s,l){(function(a){(function(){function c(R,D,C){return D in R?Object.defineProperty(R,D,{value:C,enumerable:!0,configurable:!0,writable:!0}):R[D]=C,R}function h(R,D){return{value:R,done:D}}function u(R){var D=R[k];if(D!==null){var C=R[E].read();C!==null&&(R[b]=null,R[k]=null,R[L]=null,D(h(C,!1)))}}function f(R){a.nextTick(u,R)}function p(R,D){return function(C,A){R.then(function(){return D[M]?void C(h(void 0,!0)):void D[w](C,A)},A)}}var g,m=s("./end-of-stream"),k=Symbol("lastResolve"),L=Symbol("lastReject"),T=Symbol("error"),M=Symbol("ended"),b=Symbol("lastPromise"),w=Symbol("handlePromise"),E=Symbol("stream"),S=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((g={get stream(){return this[E]},next:function(){var R=this,D=this[T];if(D!==null)return Promise.reject(D);if(this[M])return Promise.resolve(h(void 0,!0));if(this[E].destroyed)return new Promise(function(B,V){a.nextTick(function(){R[T]?V(R[T]):B(h(void 0,!0))})});var C,A=this[b];if(A)C=new Promise(p(A,this));else{var I=this[E].read();if(I!==null)return Promise.resolve(h(I,!1));C=new Promise(this[w])}return this[b]=C,C}},c(g,Symbol.asyncIterator,function(){return this}),c(g,"return",function(){var R=this;return new Promise(function(D,C){R[E].destroy(null,function(A){return A?void C(A):void D(h(void 0,!0))})})}),g),S);l.exports=function(R){var D,C=Object.create(v,(D={},c(D,E,{value:R,writable:!0}),c(D,k,{value:null,writable:!0}),c(D,L,{value:null,writable:!0}),c(D,T,{value:null,writable:!0}),c(D,M,{value:R._readableState.endEmitted,writable:!0}),c(D,w,{value:function(A,I){var B=C[E].read();B?(C[b]=null,C[k]=null,C[L]=null,A(h(B,!1))):(C[k]=A,C[L]=I)},writable:!0}),D));return C[b]=null,m(R,function(A){if(A&&A.code!=="ERR_STREAM_PREMATURE_CLOSE"){var I=C[L];return I!==null&&(C[b]=null,C[k]=null,C[L]=null,I(A)),void(C[T]=A)}var B=C[k];B!==null&&(C[b]=null,C[k]=null,C[L]=null,B(h(void 0,!0))),C[M]=!0}),R.on("readable",f.bind(null,C)),C}}).call(this)}).call(this,s("_process"))},{"./end-of-stream":24,_process:12}],22:[function(s,l){function a(b,w){var E=Object.keys(b);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(b);w&&(S=S.filter(function(v){return Object.getOwnPropertyDescriptor(b,v).enumerable})),E.push.apply(E,S)}return E}function c(b){for(var w,E=1;E<arguments.length;E++)w=arguments[E]==null?{}:arguments[E],E%2?a(Object(w),!0).forEach(function(S){h(b,S,w[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(w)):a(Object(w)).forEach(function(S){Object.defineProperty(b,S,Object.getOwnPropertyDescriptor(w,S))});return b}function h(b,w,E){return w in b?Object.defineProperty(b,w,{value:E,enumerable:!0,configurable:!0,writable:!0}):b[w]=E,b}function u(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}function f(b,w){for(var E,S=0;S<w.length;S++)E=w[S],E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(b,E.key,E)}function p(b,w,E){return w&&f(b.prototype,w),E&&f(b,E),b}function g(b,w,E){k.prototype.copy.call(b,w,E)}var m=s("buffer"),k=m.Buffer,L=s("util"),T=L.inspect,M=T&&T.custom||"inspect";l.exports=function(){function b(){u(this,b),this.head=null,this.tail=null,this.length=0}return p(b,[{key:"push",value:function(w){var E={data:w,next:null};0<this.length?this.tail.next=E:this.head=E,this.tail=E,++this.length}},{key:"unshift",value:function(w){var E={data:w,next:this.head};this.length===0&&(this.tail=E),this.head=E,++this.length}},{key:"shift",value:function(){if(this.length!==0){var w=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,w}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(w){if(this.length===0)return"";for(var E=this.head,S=""+E.data;E=E.next;)S+=w+E.data;return S}},{key:"concat",value:function(w){if(this.length===0)return k.alloc(0);for(var E=k.allocUnsafe(w>>>0),S=this.head,v=0;S;)g(S.data,E,v),v+=S.data.length,S=S.next;return E}},{key:"consume",value:function(w,E){var S;return w<this.head.data.length?(S=this.head.data.slice(0,w),this.head.data=this.head.data.slice(w)):w===this.head.data.length?S=this.shift():S=E?this._getString(w):this._getBuffer(w),S}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(w){var E=this.head,S=1,v=E.data;for(w-=v.length;E=E.next;){var R=E.data,D=w>R.length?R.length:w;if(v+=D===R.length?R:R.slice(0,w),w-=D,w===0){D===R.length?(++S,this.head=E.next?E.next:this.tail=null):(this.head=E,E.data=R.slice(D));break}++S}return this.length-=S,v}},{key:"_getBuffer",value:function(w){var E=k.allocUnsafe(w),S=this.head,v=1;for(S.data.copy(E),w-=S.data.length;S=S.next;){var R=S.data,D=w>R.length?R.length:w;if(R.copy(E,E.length-w,0,D),w-=D,w===0){D===R.length?(++v,this.head=S.next?S.next:this.tail=null):(this.head=S,S.data=R.slice(D));break}++v}return this.length-=v,E}},{key:M,value:function(w,E){return T(this,c({},E,{depth:0,customInspect:!1}))}}]),b}()},{buffer:3,util:2}],23:[function(s,l){(function(a){(function(){function c(f,p){u(f,p),h(f)}function h(f){f._writableState&&!f._writableState.emitClose||f._readableState&&!f._readableState.emitClose||f.emit("close")}function u(f,p){f.emit("error",p)}l.exports={destroy:function(f,p){var g=this,m=this._readableState&&this._readableState.destroyed,k=this._writableState&&this._writableState.destroyed;return m||k?(p?p(f):f&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,a.nextTick(u,this,f)):a.nextTick(u,this,f)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(f||null,function(L){!p&&L?g._writableState?g._writableState.errorEmitted?a.nextTick(h,g):(g._writableState.errorEmitted=!0,a.nextTick(c,g,L)):a.nextTick(c,g,L):p?(a.nextTick(h,g),p(L)):a.nextTick(h,g)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(f,p){var g=f._readableState,m=f._writableState;g&&g.autoDestroy||m&&m.autoDestroy?f.destroy(p):f.emit("error",p)}}}).call(this)}).call(this,s("_process"))},{_process:12}],24:[function(s,l){function a(p){var g=!1;return function(){if(!g){g=!0;for(var m=arguments.length,k=Array(m),L=0;L<m;L++)k[L]=arguments[L];p.apply(this,k)}}}function c(){}function h(p){return p.setHeader&&typeof p.abort=="function"}function u(p,g,m){if(typeof g=="function")return u(p,null,g);g||(g={}),m=a(m||c);var k=g.readable||g.readable!==!1&&p.readable,L=g.writable||g.writable!==!1&&p.writable,T=function(){p.writable||b()},M=p._writableState&&p._writableState.finished,b=function(){L=!1,M=!0,k||m.call(p)},w=p._readableState&&p._readableState.endEmitted,E=function(){k=!1,w=!0,L||m.call(p)},S=function(D){m.call(p,D)},v=function(){var D;return k&&!w?(p._readableState&&p._readableState.ended||(D=new f),m.call(p,D)):L&&!M?(p._writableState&&p._writableState.ended||(D=new f),m.call(p,D)):void 0},R=function(){p.req.on("finish",b)};return h(p)?(p.on("complete",b),p.on("abort",v),p.req?R():p.on("request",R)):L&&!p._writableState&&(p.on("end",T),p.on("close",T)),p.on("end",E),p.on("finish",b),g.error!==!1&&p.on("error",S),p.on("close",v),function(){p.removeListener("complete",b),p.removeListener("abort",v),p.removeListener("request",R),p.req&&p.req.removeListener("finish",b),p.removeListener("end",T),p.removeListener("close",T),p.removeListener("finish",b),p.removeListener("end",E),p.removeListener("error",S),p.removeListener("close",v)}}var f=s("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;l.exports=u},{"../../../errors":15}],25:[function(s,l){l.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(s,l){function a(M){var b=!1;return function(){b||(b=!0,M.apply(void 0,arguments))}}function c(M){if(M)throw M}function h(M){return M.setHeader&&typeof M.abort=="function"}function u(M,b,w,E){E=a(E);var S=!1;M.on("close",function(){S=!0}),m===void 0&&(m=s("./end-of-stream")),m(M,{readable:b,writable:w},function(R){return R?E(R):(S=!0,void E())});var v=!1;return function(R){if(!S)return v?void 0:(v=!0,h(M)?M.abort():typeof M.destroy=="function"?M.destroy():void E(R||new T("pipe")))}}function f(M){M()}function p(M,b){return M.pipe(b)}function g(M){return M.length&&typeof M[M.length-1]=="function"?M.pop():c}var m,k=s("../../../errors").codes,L=k.ERR_MISSING_ARGS,T=k.ERR_STREAM_DESTROYED;l.exports=function(){for(var M=arguments.length,b=Array(M),w=0;w<M;w++)b[w]=arguments[w];var E=g(b);if(Array.isArray(b[0])&&(b=b[0]),2>b.length)throw new L("streams");var S,v=b.map(function(R,D){var C=D<b.length-1;return u(R,C,0<D,function(A){S||(S=A),A&&v.forEach(f),C||(v.forEach(f),E(S))})});return b.reduce(p)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(s,l){function a(h,u,f){return h.highWaterMark==null?u?h[f]:null:h.highWaterMark}var c=s("../../../errors").codes.ERR_INVALID_OPT_VALUE;l.exports={getHighWaterMark:function(h,u,f,p){var g=a(u,p,f);if(g!=null){if(!(isFinite(g)&&n(g)===g)||0>g){var m=p?f:"highWaterMark";throw new c(m,g)}return n(g)}return h.objectMode?16:16384}}},{"../../../errors":15}],28:[function(s,l){l.exports=s("events").EventEmitter},{events:7}],29:[function(s,l,a){a=l.exports=s("./lib/_stream_readable.js"),a.Stream=a,a.Readable=a,a.Writable=s("./lib/_stream_writable.js"),a.Duplex=s("./lib/_stream_duplex.js"),a.Transform=s("./lib/_stream_transform.js"),a.PassThrough=s("./lib/_stream_passthrough.js"),a.finished=s("./lib/internal/streams/end-of-stream.js"),a.pipeline=s("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(s,l,a){function c(p,g){for(var m in p)g[m]=p[m]}function h(p,g,m){return f(p,g,m)}var u=s("buffer"),f=u.Buffer;f.from&&f.alloc&&f.allocUnsafe&&f.allocUnsafeSlow?l.exports=u:(c(u,a),a.Buffer=h),h.prototype=Object.create(f.prototype),c(f,h),h.from=function(p,g,m){if(typeof p=="number")throw new TypeError("Argument must not be a number");return f(p,g,m)},h.alloc=function(p,g,m){if(typeof p!="number")throw new TypeError("Argument must be a number");var k=f(p);return g===void 0?k.fill(0):typeof m=="string"?k.fill(g,m):k.fill(g),k},h.allocUnsafe=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return f(p)},h.allocUnsafeSlow=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return u.SlowBuffer(p)}},{buffer:3}],31:[function(s,l,a){function c(v){if(!v)return"utf8";for(var R;;)switch(v){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return v;default:if(R)return;v=(""+v).toLowerCase(),R=!0}}function h(v){var R=c(v);if(typeof R!="string"&&(E.isEncoding===S||!S(v)))throw new Error("Unknown encoding: "+v);return R||v}function u(v){this.encoding=h(v);var R;switch(this.encoding){case"utf16le":this.text=k,this.end=L,R=4;break;case"utf8":this.fillLast=m,R=4;break;case"base64":this.text=T,this.end=M,R=3;break;default:return this.write=b,void(this.end=w)}this.lastNeed=0,this.lastTotal=0,this.lastChar=E.allocUnsafe(R)}function f(v){return 127>=v?0:v>>5==6?2:v>>4==14?3:v>>3==30?4:v>>6==2?-1:-2}function p(v,R,D){var C=R.length-1;if(C<D)return 0;var A=f(R[C]);return 0<=A?(0<A&&(v.lastNeed=A-1),A):--C<D||A===-2?0:(A=f(R[C]),0<=A?(0<A&&(v.lastNeed=A-2),A):--C<D||A===-2?0:(A=f(R[C]),0<=A?(0<A&&(A===2?A=0:v.lastNeed=A-3),A):0))}function g(v,R){if((192&R[0])!=128)return v.lastNeed=0,"\uFFFD";if(1<v.lastNeed&&1<R.length){if((192&R[1])!=128)return v.lastNeed=1,"\uFFFD";if(2<v.lastNeed&&2<R.length&&(192&R[2])!=128)return v.lastNeed=2,"\uFFFD"}}function m(v){var R=this.lastTotal-this.lastNeed,D=g(this,v);return D===void 0?this.lastNeed<=v.length?(v.copy(this.lastChar,R,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(v.copy(this.lastChar,R,0,v.length),void(this.lastNeed-=v.length)):D}function k(v,R){if((v.length-R)%2==0){var D=v.toString("utf16le",R);if(D){var C=D.charCodeAt(D.length-1);if(55296<=C&&56319>=C)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1],D.slice(0,-1)}return D}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=v[v.length-1],v.toString("utf16le",R,v.length-1)}function L(v){var R=v&&v.length?this.write(v):"";if(this.lastNeed){var D=this.lastTotal-this.lastNeed;return R+this.lastChar.toString("utf16le",0,D)}return R}function T(v,R){var D=(v.length-R)%3;return D==0?v.toString("base64",R):(this.lastNeed=3-D,this.lastTotal=3,D==1?this.lastChar[0]=v[v.length-1]:(this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1]),v.toString("base64",R,v.length-D))}function M(v){var R=v&&v.length?this.write(v):"";return this.lastNeed?R+this.lastChar.toString("base64",0,3-this.lastNeed):R}function b(v){return v.toString(this.encoding)}function w(v){return v&&v.length?this.write(v):""}var E=s("safe-buffer").Buffer,S=E.isEncoding||function(v){switch(v=""+v,v&&v.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};a.StringDecoder=u,u.prototype.write=function(v){if(v.length===0)return"";var R,D;if(this.lastNeed){if(R=this.fillLast(v),R===void 0)return"";D=this.lastNeed,this.lastNeed=0}else D=0;return D<v.length?R?R+this.text(v,D):this.text(v,D):R||""},u.prototype.end=function(v){var R=v&&v.length?this.write(v):"";return this.lastNeed?R+"\uFFFD":R},u.prototype.text=function(v,R){var D=p(this,v,R);if(!this.lastNeed)return v.toString("utf8",R);this.lastTotal=D;var C=v.length-(D-this.lastNeed);return v.copy(this.lastChar,0,C),v.toString("utf8",R,C)},u.prototype.fillLast=function(v){return this.lastNeed<=v.length?(v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,v.length),void(this.lastNeed-=v.length))}},{"safe-buffer":30}],32:[function(s,l){(function(a){(function(){function c(h){try{if(!a.localStorage)return!1}catch{return!1}var u=a.localStorage[h];return u!=null&&(u+"").toLowerCase()==="true"}l.exports=function(h,u){function f(){if(!p){if(c("throwDeprecation"))throw new Error(u);c("traceDeprecation")?console.trace(u):console.warn(u),p=!0}return h.apply(this,arguments)}if(c("noDeprecation"))return h;var p=!1;return f}}).call(this)}).call(this,typeof bt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:bt)},{}],"/":[function(s,l){function a(M){return M.replace(/a=ice-options:trickle\s\n/g,"")}function c(M){console.warn(M)}const h=s("debug")("simple-peer"),u=s("get-browser-rtc"),f=s("randombytes"),p=s("readable-stream"),g=s("queue-microtask"),m=s("err-code"),{Buffer:k}=s("buffer"),L=65536;class T extends p.Duplex{constructor(b){if(b=Object.assign({allowHalfOpen:!1},b),super(b),this._id=f(4).toString("hex").slice(0,7),this._debug("new peer %o",b),this.channelName=b.initiator?b.channelName||f(20).toString("hex"):null,this.initiator=b.initiator||!1,this.channelConfig=b.channelConfig||T.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},T.config,b.config),this.offerOptions=b.offerOptions||{},this.answerOptions=b.answerOptions||{},this.sdpTransform=b.sdpTransform||(w=>w),this.streams=b.streams||(b.stream?[b.stream]:[]),this.trickle=b.trickle===void 0||b.trickle,this.allowHalfTrickle=b.allowHalfTrickle!==void 0&&b.allowHalfTrickle,this.iceCompleteTimeout=b.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=b.wrtc&&typeof b.wrtc=="object"?b.wrtc:u(),!this._wrtc)throw m(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(w){return void this.destroy(m(w,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=w=>{this._onIceCandidate(w)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(w=>{this.destroy(m(w,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=w=>{this._setupData(w)},this.streams&&this.streams.forEach(w=>{this.addStream(w)}),this._pc.ontrack=w=>{this._onTrack(w)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(b){if(!this.destroying){if(this.destroyed)throw m(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof b=="string")try{b=JSON.parse(b)}catch{b={}}this._debug("signal()"),b.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),b.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(b.transceiverRequest.kind,b.transceiverRequest.init)),b.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(b.candidate):this._pendingCandidates.push(b.candidate)),b.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(b)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(w=>{this._addIceCandidate(w)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(w=>{this.destroy(m(w,"ERR_SET_REMOTE_DESCRIPTION"))}),b.sdp||b.candidate||b.renegotiate||b.transceiverRequest||this.destroy(m(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(b){const w=new this._wrtc.RTCIceCandidate(b);this._pc.addIceCandidate(w).catch(E=>{!w.address||w.address.endsWith(".local")?c("Ignoring unsupported ICE candidate."):this.destroy(m(E,"ERR_ADD_ICE_CANDIDATE"))})}send(b){if(!this.destroying){if(this.destroyed)throw m(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(b)}}addTransceiver(b,w){if(!this.destroying){if(this.destroyed)throw m(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(b,w),this._needsNegotiation()}catch(E){this.destroy(m(E,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:b,init:w}})}}addStream(b){if(!this.destroying){if(this.destroyed)throw m(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),b.getTracks().forEach(w=>{this.addTrack(w,b)})}}addTrack(b,w){if(this.destroying)return;if(this.destroyed)throw m(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const E=this._senderMap.get(b)||new Map;let S=E.get(w);if(!S)S=this._pc.addTrack(b,w),E.set(w,S),this._senderMap.set(b,E),this._needsNegotiation();else throw S.removed?m(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):m(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(b,w,E){if(this.destroying)return;if(this.destroyed)throw m(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const S=this._senderMap.get(b),v=S?S.get(E):null;if(!v)throw m(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");w&&this._senderMap.set(w,S),v.replaceTrack==null?this.destroy(m(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):v.replaceTrack(w)}removeTrack(b,w){if(this.destroying)return;if(this.destroyed)throw m(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const E=this._senderMap.get(b),S=E?E.get(w):null;if(!S)throw m(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{S.removed=!0,this._pc.removeTrack(S)}catch(v){v.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(S):this.destroy(m(v,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(b){if(!this.destroying){if(this.destroyed)throw m(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),b.getTracks().forEach(w=>{this.removeTrack(w,b)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,g(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw m(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(b){this._destroy(b,()=>{})}_destroy(b,w){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",b&&(b.message||b)),g(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",b&&(b.message||b)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,b&&this.emit("error",b),this.emit("close"),w()}))}_setupData(b){if(!b.channel)return this.destroy(m(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=b.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=L),this.channelName=this._channel.label,this._channel.onmessage=E=>{this._onChannelMessage(E)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=E=>{const S=E.error instanceof Error?E.error:new Error(`Datachannel error: ${E.message} ${E.filename}:${E.lineno}:${E.colno}`);this.destroy(m(S,"ERR_DATA_CHANNEL"))};let w=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(w&&this._onChannelClose(),w=!0):w=!1},5e3)}_read(){}_write(b,w,E){if(this.destroyed)return E(m(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(b)}catch(S){return this.destroy(m(S,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>L?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=E):E(null)}else this._debug("write before connect"),this._chunk=b,this._cb=E}_onFinish(){if(!this.destroyed){const b=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?b():this.once("connect",b)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(b=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(b.sdp=a(b.sdp)),b.sdp=this.sdpTransform(b.sdp);const w=()=>{if(!this.destroyed){const E=this._pc.localDescription||b;this._debug("signal"),this.emit("signal",{type:E.type,sdp:E.sdp})}};this._pc.setLocalDescription(b).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?w():this.once("_iceComplete",w))}).catch(E=>{this.destroy(m(E,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(b=>{this.destroy(m(b,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(b=>{b.mid||!b.sender.track||b.requested||(b.requested=!0,this.addTransceiver(b.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(b=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(b.sdp=a(b.sdp)),b.sdp=this.sdpTransform(b.sdp);const w=()=>{if(!this.destroyed){const E=this._pc.localDescription||b;this._debug("signal"),this.emit("signal",{type:E.type,sdp:E.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(b).then(()=>{this.destroyed||(this.trickle||this._iceComplete?w():this.once("_iceComplete",w))}).catch(E=>{this.destroy(m(E,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(b=>{this.destroy(m(b,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(m(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const b=this._pc.iceConnectionState,w=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",b,w),this.emit("iceStateChange",b,w),(b==="connected"||b==="completed")&&(this._pcReady=!0,this._maybeReady()),b==="failed"&&this.destroy(m(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),b==="closed"&&this.destroy(m(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(b){const w=E=>(Object.prototype.toString.call(E.values)==="[object Array]"&&E.values.forEach(S=>{Object.assign(E,S)}),E);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(E=>{const S=[];E.forEach(v=>{S.push(w(v))}),b(null,S)},E=>b(E)):0<this._pc.getStats.length?this._pc.getStats(E=>{if(this.destroyed)return;const S=[];E.result().forEach(v=>{const R={};v.names().forEach(D=>{R[D]=v.stat(D)}),R.id=v.id,R.type=v.type,R.timestamp=v.timestamp,S.push(w(R))}),b(null,S)},E=>b(E)):b(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const b=()=>{this.destroyed||this.getStats((w,E)=>{if(this.destroyed)return;w&&(E=[]);const S={},v={},R={};let D=!1;E.forEach(A=>{(A.type==="remotecandidate"||A.type==="remote-candidate")&&(S[A.id]=A),(A.type==="localcandidate"||A.type==="local-candidate")&&(v[A.id]=A),(A.type==="candidatepair"||A.type==="candidate-pair")&&(R[A.id]=A)});const C=A=>{D=!0;let I=v[A.localCandidateId];I&&(I.ip||I.address)?(this.localAddress=I.ip||I.address,this.localPort=+I.port):I&&I.ipAddress?(this.localAddress=I.ipAddress,this.localPort=+I.portNumber):typeof A.googLocalAddress=="string"&&(I=A.googLocalAddress.split(":"),this.localAddress=I[0],this.localPort=+I[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let B=S[A.remoteCandidateId];B&&(B.ip||B.address)?(this.remoteAddress=B.ip||B.address,this.remotePort=+B.port):B&&B.ipAddress?(this.remoteAddress=B.ipAddress,this.remotePort=+B.portNumber):typeof A.googRemoteAddress=="string"&&(B=A.googRemoteAddress.split(":"),this.remoteAddress=B[0],this.remotePort=+B[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(E.forEach(A=>{A.type==="transport"&&A.selectedCandidatePairId&&C(R[A.selectedCandidatePairId]),(A.type==="googCandidatePair"&&A.googActiveConnection==="true"||(A.type==="candidatepair"||A.type==="candidate-pair")&&A.selected)&&C(A)}),!D&&(!Object.keys(R).length||Object.keys(v).length))return void setTimeout(b,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(I){return this.destroy(m(I,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const A=this._cb;this._cb=null,A(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};b()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>L)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(b=>{this._pc.removeTrack(b),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(b){this.destroyed||(b.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:b.candidate.candidate,sdpMLineIndex:b.candidate.sdpMLineIndex,sdpMid:b.candidate.sdpMid}}):!b.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),b.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(b){if(this.destroyed)return;let w=b.data;w instanceof ArrayBuffer&&(w=k.from(w)),this.push(w)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const b=this._cb;this._cb=null,b(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(b){this.destroyed||b.streams.forEach(w=>{this._debug("on track"),this.emit("track",b.track,w),this._remoteTracks.push({track:b.track,stream:w}),this._remoteStreams.some(E=>E.id===w.id)||(this._remoteStreams.push(w),g(()=>{this._debug("on stream"),this.emit("stream",w)}))})}_debug(){const b=[].slice.call(arguments);b[0]="["+this._id+"] "+b[0],h.apply(null,b)}}T.WEBRTC_SUPPORT=!!u(),T.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},T.channelConfig={},l.exports=T},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(ca);var Vd=ca.exports;const qd=mp(Vd),Zi=0,Wi=1,ha=2,da=(e,t)=>{$(e,Zi);const n=Mh(t);be(e,n)},ua=(e,t,n)=>{$(e,Wi),be(e,Ah(t,n))},Zd=(e,t,n)=>ua(t,n,Ce(e)),fa=(e,t,n)=>{try{xh(t,Ce(e),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},Wd=(e,t)=>{$(e,ha),be(e,t)},Kd=fa,Yd=(e,t,n,r)=>{const i=X(e);switch(i){case Zi:Zd(e,t,n);break;case Wi:fa(e,n,r);break;case ha:Kd(e,n,r);break;default:throw new Error("Unknown message type")}return i},Ki=3e4;class $d extends ur{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const n=vt();this.getLocalState()!==null&&Ki/2<=n-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const r=[];this.meta.forEach((i,s)=>{s!==this.clientID&&Ki<=n-i.lastUpdated&&this.states.has(s)&&r.push(s)}),r.length>0&&Yi(this,r,"timeout")},tt(Ki/10)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const n=this.clientID,r=this.meta.get(n),i=r===void 0?0:r.clock+1,s=this.states.get(n);t===null?this.states.delete(n):this.states.set(n,t),this.meta.set(n,{clock:i,lastUpdated:vt()});const l=[],a=[],c=[],h=[];t===null?h.push(n):s==null?t!=null&&l.push(n):(a.push(n),In(s,t)||c.push(n)),(l.length>0||c.length>0||h.length>0)&&this.emit("change",[{added:l,updated:c,removed:h},"local"]),this.emit("update",[{added:l,updated:a,removed:h},"local"])}setLocalStateField(t,n){const r=this.getLocalState();r!==null&&this.setLocalState({...r,[t]:n})}getStates(){return this.states}}const Yi=(e,t,n)=>{const r=[];for(let i=0;i<t.length;i++){const s=t[i];if(e.states.has(s)){if(e.states.delete(s),s===e.clientID){const l=e.meta.get(s);e.meta.set(s,{clock:l.clock+1,lastUpdated:vt()})}r.push(s)}}r.length>0&&(e.emit("change",[{added:[],updated:[],removed:r},n]),e.emit("update",[{added:[],updated:[],removed:r},n]))},qr=(e,t,n=e.states)=>{const r=t.length,i=ke();$(i,r);for(let s=0;s<r;s++){const l=t[s],a=n.get(l)||null,c=e.meta.get(l).clock;$(i,l),$(i,c),nt(i,JSON.stringify(a))}return me(i)},Jd=(e,t,n)=>{const r=st(t),i=vt(),s=[],l=[],a=[],c=[],h=X(r);for(let u=0;u<h;u++){const f=X(r);let p=X(r);const g=JSON.parse(yt(r)),m=e.meta.get(f),k=e.states.get(f),L=m===void 0?0:m.clock;(L<p||L===p&&g===null&&e.states.has(f))&&(g===null?f===e.clientID&&e.getLocalState()!=null?p++:e.states.delete(f):e.states.set(f,g),e.meta.set(f,{clock:p,lastUpdated:i}),m===void 0&&g!==null?s.push(f):m!==void 0&&g===null?c.push(f):g!==null&&(In(g,k)||a.push(f),l.push(f)))}(s.length>0||a.length>0||c.length>0)&&e.emit("change",[{added:s,updated:a,removed:c},n]),(s.length>0||l.length>0||c.length>0)&&e.emit("update",[{added:s,updated:l,removed:c},n])},Gd=(e,t)=>{const n=di(e).buffer,r=di(t).buffer;return crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveKey"]).then(i=>crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},ga=(e,t)=>{if(!t)return wi(e);const n=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,e).then(r=>{const i=ke();return nt(i,"AES-GCM"),be(i,n),be(i,new Uint8Array(r)),me(i)})},Xd=(e,t)=>{const n=ke();return rn(n,e),ga(me(n),t)},pa=(e,t)=>{if(!t)return wi(e);const n=st(e);yt(n)!=="AES-GCM"&&Pc(rt("Unknown encryption algorithm"));const r=Ce(n),i=Ce(n);return crypto.subtle.decrypt({name:"AES-GCM",iv:r},t,i).then(s=>new Uint8Array(s))},Qd=(e,t)=>pa(e,t).then(n=>sn(st(new Uint8Array(n)))),Ge=gh("y-webrtc"),pn=0,_a=3,Zn=1,$i=4,Zr=new Map,Yt=new Map,ma=e=>{let t=!0;e.webrtcConns.forEach(n=>{n.synced||(t=!1)}),(!t&&e.synced||t&&!e.synced)&&(e.synced=t,e.provider.emit("synced",[{synced:t}]),Ge("synced ",Ve,e.name,Vt," with all peers"))},ba=(e,t,n)=>{const r=st(t),i=ke(),s=X(r);if(e===void 0)return null;const l=e.awareness,a=e.doc;let c=!1;switch(s){case pn:{$(i,pn);const h=Yd(r,i,a,e);h===Wi&&!e.synced&&n(),h===Zi&&(c=!0);break}case _a:$(i,Zn),be(i,qr(l,Array.from(l.getStates().keys()))),c=!0;break;case Zn:Jd(l,Ce(r),e);break;case $i:{const h=Ht(r)===1,u=yt(r);if(u!==e.peerId&&(e.bcConns.has(u)&&!h||!e.bcConns.has(u)&&h)){const f=[],p=[];h?(e.bcConns.add(u),p.push(u)):(e.bcConns.delete(u),f.push(u)),e.provider.emit("peers",[{added:p,removed:f,webrtcPeers:Array.from(e.webrtcConns.keys()),bcPeers:Array.from(e.bcConns)}]),va(e)}break}default:return console.error("Unable to compute message"),i}return c?i:null},eu=(e,t)=>{const n=e.room;return Ge("received message from ",Ve,e.remotePeerId,Ei," (",n.name,")",Vt,vr),ba(n,t,()=>{e.synced=!0,Ge("synced ",Ve,n.name,Vt," with ",Ve,e.remotePeerId),ma(n)})},Ji=(e,t)=>{Ge("send message to ",Ve,e.remotePeerId,Vt,Ei," (",e.room.name,")",vr);try{e.peer.send(me(t))}catch{}},tu=(e,t)=>{Ge("broadcast message in ",Ve,e.name,Vt),e.webrtcConns.forEach(n=>{try{n.peer.send(t)}catch{}})};class wa{constructor(t,n,r,i){Ge("establishing connection to ",Ve,r),this.room=i,this.remotePeerId=r,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new qd({initiator:n,...i.provider.peerOpts}),this.peer.on("signal",s=>{Xi(t,i,{to:r,from:i.peerId,type:"signal",signal:s})}),this.peer.on("connect",()=>{Ge("connected to ",Ve,r),this.connected=!0;const s=i.provider.doc,l=i.awareness,a=ke();$(a,pn),da(a,s),Ji(this,a);const c=l.getStates();if(c.size>0){const h=ke();$(h,Zn),be(h,qr(l,Array.from(c.keys()))),Ji(this,h)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,i.webrtcConns.has(this.remotePeerId)&&(i.webrtcConns.delete(this.remotePeerId),i.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}])),ma(i),this.peer.destroy(),Ge("closed connection to ",Ve,r),Gi(i)}),this.peer.on("error",s=>{Ge("Error in connection to ",Ve,r,": ",s),Gi(i)}),this.peer.on("data",s=>{const l=eu(this,s);l!==null&&Ji(this,l)})}destroy(){this.peer.destroy()}}const Nt=(e,t)=>ga(t,e.key).then(n=>e.mux(()=>Hd(e.name,n))),ya=(e,t)=>{e.bcconnected&&Nt(e,t),tu(e,t)},Gi=e=>{Zr.forEach(t=>{t.connected&&(t.send({type:"subscribe",topics:[e.name]}),e.webrtcConns.size<e.provider.maxConns&&Xi(t,e,{type:"announce",from:e.peerId}))})},va=e=>{if(e.provider.filterBcConns){const t=ke();$(t,$i),On(t,1),nt(t,e.peerId),Nt(e,me(t))}};class nu{constructor(t,n,r,i){this.peerId=Ys(),this.doc=t,this.awareness=n.awareness,this.provider=n,this.synced=!1,this.name=r,this.key=i,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=la(),this.bcconnected=!1,this._bcSubscriber=s=>pa(new Uint8Array(s),i).then(l=>this.mux(()=>{const a=ba(this,l,()=>{});a&&Nt(this,me(a))})),this._docUpdateHandler=(s,l)=>{const a=ke();$(a,pn),Wd(a,s),ya(this,me(a))},this._awarenessUpdateHandler=({added:s,updated:l,removed:a},c)=>{const h=s.concat(l).concat(a),u=ke();$(u,Zn),be(u,qr(this.awareness,h)),ya(this,me(u))},this._beforeUnloadHandler=()=>{Yi(this.awareness,[t.clientID],"window unload"),Yt.forEach(s=>{s.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),Gi(this);const t=this.name;Ud(t,this._bcSubscriber),this.bcconnected=!0,va(this);const n=ke();$(n,pn),da(n,this.doc),Nt(this,me(n));const r=ke();$(r,pn),ua(r,this.doc),Nt(this,me(r));const i=ke();$(i,_a),Nt(this,me(i));const s=ke();$(s,Zn),be(s,qr(this.awareness,[this.doc.clientID])),Nt(this,me(s))}disconnect(){Zr.forEach(n=>{n.connected&&n.send({type:"unsubscribe",topics:[this.name]})}),Yi(this.awareness,[this.doc.clientID],"disconnect");const t=ke();$(t,$i),On(t,0),nt(t,this.peerId),Nt(this,me(t)),Fd(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(n=>n.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const ru=(e,t,n,r)=>{if(Yt.has(n))throw rt(`A Yjs Doc connected to room "${n}" already exists!`);const i=new nu(e,t,n,r);return Yt.set(n,i),i},Xi=(e,t,n)=>{t.key?Xd(n,t.key).then(r=>{e.send({type:"publish",topic:t.name,data:no(r)})}):e.send({type:"publish",topic:t.name,data:n})};class iu extends zd{constructor(t){super(t),this.providers=new Set,this.on("connect",()=>{Ge(`connected (${t})`);const n=Array.from(Yt.keys());this.send({type:"subscribe",topics:n}),Yt.forEach(r=>Xi(this,r,{type:"announce",from:r.peerId}))}),this.on("message",n=>{switch(n.type){case"publish":{const r=n.topic,i=Yt.get(r);if(i==null||typeof r!="string")return;const s=l=>{const a=i.webrtcConns,c=i.peerId;if(l==null||l.from===c||l.to!==void 0&&l.to!==c||i.bcConns.has(l.from))return;const h=a.has(l.from)?()=>{}:()=>i.provider.emit("peers",[{removed:[],added:[l.from],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}]);switch(l.type){case"announce":a.size<i.provider.maxConns&&(Fe(a,l.from,()=>new wa(this,!0,l.from,i)),h());break;case"signal":l.to===c&&(Fe(a,l.from,()=>new wa(this,!1,l.from,i)).peer.signal(l.signal),h());break}};i.key?typeof n.data=="string"&&Qd(ro(n.data),i.key).then(s):s(n.data)}}}),this.on("disconnect",()=>Ge(`disconnect (${t})`))}}class su extends ur{constructor(t,n,{signaling:r=["wss://y-webrtc-eu.fly.dev"],password:i=null,awareness:s=new $d(n),maxConns:l=20+tt(Oc()*15),filterBcConns:a=!0,peerOpts:c={}}={}){super(),this.roomName=t,this.doc=n,this.filterBcConns=a,this.awareness=s,this.shouldConnect=!1,this.signalingUrls=r,this.signalingConns=[],this.maxConns=l,this.peerOpts=c,this.key=i?Gd(i,t):wi(null),this.room=null,this.key.then(h=>{this.room=ru(n,this,t,h),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),n.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(t=>{const n=Fe(Zr,t,()=>new iu(t));this.signalingConns.push(n),n.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(t=>{t.providers.delete(this),t.providers.size===0&&(t.destroy(),Zr.delete(t.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),Yt.delete(this.roomName)}),super.destroy()}}class ou{constructor(t,n,r){this.start=t,this.end=n,this.direction=r}}const au=(e,t,n)=>{const r=e.getSelection();if(r!==null){const i=r.getStartPosition(),s=r.getEndPosition(),l=Sr(n,t.getOffsetAt(i)),a=Sr(n,t.getOffsetAt(s));return new ou(l,a,r.getDirection())}return null},lu=(e,t,n,r)=>{const i=xr(n.start,r),s=xr(n.end,r);if(i!==null&&s!==null&&i.type===t&&s.type===t){const l=e.getModel(),a=l.getPositionAt(i.index),c=l.getPositionAt(s.index);return Os.createWithDirection(a.lineNumber,a.column,c.lineNumber,c.column,n.direction)}return null};class cu{constructor(t,n,r=new Set,i=null){this.doc=t.doc,this.ytext=t,this.monacoModel=n,this.editors=r,this.mux=la(),this._savedSelections=new Map,this._beforeTransaction=()=>{this.mux(()=>{this._savedSelections=new Map,r.forEach(s=>{if(s.getModel()===n){const l=au(s,n,t);l!==null&&this._savedSelections.set(s,l)}})})},this.doc.on("beforeAllTransactions",this._beforeTransaction),this._decorations=new Map,this._rerenderDecorations=()=>{r.forEach(s=>{if(i&&s.getModel()===n){const l=this._decorations.get(s)||[],a=[];i.getStates().forEach((c,h)=>{if(h!==this.doc.clientID&&c.selection!=null&&c.selection.anchor!=null&&c.selection.head!=null){const u=xr(c.selection.anchor,this.doc),f=xr(c.selection.head,this.doc);if(u!==null&&f!==null&&u.type===t&&f.type===t){let p,g,m,k;u.index<f.index?(p=n.getPositionAt(u.index),g=n.getPositionAt(f.index),m="yRemoteSelectionHead yRemoteSelectionHead-"+h,k=null):(p=n.getPositionAt(f.index),g=n.getPositionAt(u.index),m=null,k="yRemoteSelectionHead yRemoteSelectionHead-"+h),a.push({range:new Sp(p.lineNumber,p.column,g.lineNumber,g.column),options:{className:"yRemoteSelection yRemoteSelection-"+h,afterContentClassName:m,beforeContentClassName:k}})}}}),this._decorations.set(s,s.deltaDecorations(l,a))}else this._decorations.delete(s)})},this._ytextObserver=s=>{this.mux(()=>{let l=0;s.delta.forEach(a=>{if(a.retain!==void 0)l+=a.retain;else if(a.insert!==void 0){const c=n.getPositionAt(l),h=new Os(c.lineNumber,c.column,c.lineNumber,c.column),u=a.insert;n.applyEdits([{range:h,text:u}]),l+=u.length}else if(a.delete!==void 0){const c=n.getPositionAt(l),h=n.getPositionAt(l+a.delete),u=new Os(c.lineNumber,c.column,h.lineNumber,h.column);n.applyEdits([{range:u,text:""}])}else throw He()}),this._savedSelections.forEach((a,c)=>{const h=lu(c,t,a,this.doc);h!==null&&c.setSelection(h)})}),this._rerenderDecorations()},t.observe(this._ytextObserver);{const s=t.toString();n.getValue()!==s&&n.setValue(s)}this._monacoChangeHandler=n.onDidChangeContent(s=>{this.mux(()=>{this.doc.transact(()=>{s.changes.sort((l,a)=>a.rangeOffset-l.rangeOffset).forEach(l=>{t.delete(l.rangeOffset,l.rangeLength),t.insert(l.rangeOffset,l.text)})},this)})}),n.onWillDispose(()=>{this.destroy()}),i&&(r.forEach(s=>{s.onDidChangeCursorSelection(()=>{if(s.getModel()===n){const l=s.getSelection();if(l===null)return;let a=n.getOffsetAt(l.getStartPosition()),c=n.getOffsetAt(l.getEndPosition());if(l.getDirection()===xp.RTL){const h=a;a=c,c=h}i.setLocalStateField("selection",{anchor:Sr(t,a),head:Sr(t,c)})}}),i.on("change",this._rerenderDecorations)}),this.awareness=i)}destroy(){this._monacoChangeHandler.dispose(),this.ytext.unobserve(this._ytextObserver),this.doc.off("beforeAllTransactions",this._beforeTransaction),this.awareness&&this.awareness.off("change",this._rerenderDecorations)}}const hu=4,ka=0,Ea=1,du=2;function _n(e){let t=e.length;for(;--t>=0;)e[t]=0}const uu=0,Ca=1,fu=2,gu=3,pu=258,Qi=29,Wn=256,Kn=Wn+1+Qi,mn=30,es=19,Sa=2*Kn+1,$t=15,ts=16,_u=7,ns=256,xa=16,Ra=17,Ta=18,rs=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Wr=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),mu=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Aa=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),bu=512,Ct=new Array((Kn+2)*2);_n(Ct);const Yn=new Array(mn*2);_n(Yn);const $n=new Array(bu);_n($n);const Jn=new Array(pu-gu+1);_n(Jn);const is=new Array(Qi);_n(is);const Kr=new Array(mn);_n(Kr);function ss(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let Da,La,Na;function os(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const Ma=e=>e<256?$n[e]:$n[256+(e>>>7)],Gn=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},Pe=(e,t,n)=>{e.bi_valid>ts-n?(e.bi_buf|=t<<e.bi_valid&65535,Gn(e,e.bi_buf),e.bi_buf=t>>ts-e.bi_valid,e.bi_valid+=n-ts):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},ht=(e,t,n)=>{Pe(e,n[t*2],n[t*2+1])},Oa=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},wu=e=>{e.bi_valid===16?(Gn(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},yu=(e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let h,u,f,p,g,m,k=0;for(p=0;p<=$t;p++)e.bl_count[p]=0;for(n[e.heap[e.heap_max]*2+1]=0,h=e.heap_max+1;h<Sa;h++)u=e.heap[h],p=n[n[u*2+1]*2+1]+1,p>c&&(p=c,k++),n[u*2+1]=p,!(u>r)&&(e.bl_count[p]++,g=0,u>=a&&(g=l[u-a]),m=n[u*2],e.opt_len+=m*(p+g),s&&(e.static_len+=m*(i[u*2+1]+g)));if(k!==0){do{for(p=c-1;e.bl_count[p]===0;)p--;e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[c]--,k-=2}while(k>0);for(p=c;p!==0;p--)for(u=e.bl_count[p];u!==0;)f=e.heap[--h],!(f>r)&&(n[f*2+1]!==p&&(e.opt_len+=(p-n[f*2+1])*n[f*2],n[f*2+1]=p),u--)}},Ia=(e,t,n)=>{const r=new Array($t+1);let i=0,s,l;for(s=1;s<=$t;s++)i=i+n[s-1]<<1,r[s]=i;for(l=0;l<=t;l++){let a=e[l*2+1];a!==0&&(e[l*2]=Oa(r[a]++,a))}},vu=()=>{let e,t,n,r,i;const s=new Array($t+1);for(n=0,r=0;r<Qi-1;r++)for(is[r]=n,e=0;e<1<<rs[r];e++)Jn[n++]=r;for(Jn[n-1]=r,i=0,r=0;r<16;r++)for(Kr[r]=i,e=0;e<1<<Wr[r];e++)$n[i++]=r;for(i>>=7;r<mn;r++)for(Kr[r]=i<<7,e=0;e<1<<Wr[r]-7;e++)$n[256+i++]=r;for(t=0;t<=$t;t++)s[t]=0;for(e=0;e<=143;)Ct[e*2+1]=8,e++,s[8]++;for(;e<=255;)Ct[e*2+1]=9,e++,s[9]++;for(;e<=279;)Ct[e*2+1]=7,e++,s[7]++;for(;e<=287;)Ct[e*2+1]=8,e++,s[8]++;for(Ia(Ct,Kn+1,s),e=0;e<mn;e++)Yn[e*2+1]=5,Yn[e*2]=Oa(e,5);Da=new ss(Ct,rs,Wn+1,Kn,$t),La=new ss(Yn,Wr,0,mn,$t),Na=new ss(new Array(0),mu,0,es,_u)},Pa=e=>{let t;for(t=0;t<Kn;t++)e.dyn_ltree[t*2]=0;for(t=0;t<mn;t++)e.dyn_dtree[t*2]=0;for(t=0;t<es;t++)e.bl_tree[t*2]=0;e.dyn_ltree[ns*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},za=e=>{e.bi_valid>8?Gn(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Ba=(e,t,n,r)=>{const i=t*2,s=n*2;return e[i]<e[s]||e[i]===e[s]&&r[t]<=r[n]},as=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&Ba(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Ba(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},ja=(e,t,n)=>{let r,i,s=0,l,a;if(e.sym_next!==0)do r=e.pending_buf[e.sym_buf+s++]&255,r+=(e.pending_buf[e.sym_buf+s++]&255)<<8,i=e.pending_buf[e.sym_buf+s++],r===0?ht(e,i,t):(l=Jn[i],ht(e,l+Wn+1,t),a=rs[l],a!==0&&(i-=is[l],Pe(e,i,a)),r--,l=Ma(r),ht(e,l,n),a=Wr[l],a!==0&&(r-=Kr[l],Pe(e,r,a)));while(s<e.sym_next);ht(e,ns,t)},ls=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let l,a,c=-1,h;for(e.heap_len=0,e.heap_max=Sa,l=0;l<s;l++)n[l*2]!==0?(e.heap[++e.heap_len]=c=l,e.depth[l]=0):n[l*2+1]=0;for(;e.heap_len<2;)h=e.heap[++e.heap_len]=c<2?++c:0,n[h*2]=1,e.depth[h]=0,e.opt_len--,i&&(e.static_len-=r[h*2+1]);for(t.max_code=c,l=e.heap_len>>1;l>=1;l--)as(e,n,l);h=s;do l=e.heap[1],e.heap[1]=e.heap[e.heap_len--],as(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=l,e.heap[--e.heap_max]=a,n[h*2]=n[l*2]+n[a*2],e.depth[h]=(e.depth[l]>=e.depth[a]?e.depth[l]:e.depth[a])+1,n[l*2+1]=n[a*2+1]=h,e.heap[1]=h++,as(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],yu(e,t),Ia(n,c,e.bl_count)},Ua=(e,t,n)=>{let r,i=-1,s,l=t[0*2+1],a=0,c=7,h=4;for(l===0&&(c=138,h=3),t[(n+1)*2+1]=65535,r=0;r<=n;r++)s=l,l=t[(r+1)*2+1],!(++a<c&&s===l)&&(a<h?e.bl_tree[s*2]+=a:s!==0?(s!==i&&e.bl_tree[s*2]++,e.bl_tree[xa*2]++):a<=10?e.bl_tree[Ra*2]++:e.bl_tree[Ta*2]++,a=0,i=s,l===0?(c=138,h=3):s===l?(c=6,h=3):(c=7,h=4))},Fa=(e,t,n)=>{let r,i=-1,s,l=t[0*2+1],a=0,c=7,h=4;for(l===0&&(c=138,h=3),r=0;r<=n;r++)if(s=l,l=t[(r+1)*2+1],!(++a<c&&s===l)){if(a<h)do ht(e,s,e.bl_tree);while(--a!==0);else s!==0?(s!==i&&(ht(e,s,e.bl_tree),a--),ht(e,xa,e.bl_tree),Pe(e,a-3,2)):a<=10?(ht(e,Ra,e.bl_tree),Pe(e,a-3,3)):(ht(e,Ta,e.bl_tree),Pe(e,a-11,7));a=0,i=s,l===0?(c=138,h=3):s===l?(c=6,h=3):(c=7,h=4)}},ku=e=>{let t;for(Ua(e,e.dyn_ltree,e.l_desc.max_code),Ua(e,e.dyn_dtree,e.d_desc.max_code),ls(e,e.bl_desc),t=es-1;t>=3&&e.bl_tree[Aa[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},Eu=(e,t,n,r)=>{let i;for(Pe(e,t-257,5),Pe(e,n-1,5),Pe(e,r-4,4),i=0;i<r;i++)Pe(e,e.bl_tree[Aa[i]*2+1],3);Fa(e,e.dyn_ltree,t-1),Fa(e,e.dyn_dtree,n-1)},Cu=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return ka;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Ea;for(n=32;n<Wn;n++)if(e.dyn_ltree[n*2]!==0)return Ea;return ka};let Ha=!1;const Su=e=>{Ha||(vu(),Ha=!0),e.l_desc=new os(e.dyn_ltree,Da),e.d_desc=new os(e.dyn_dtree,La),e.bl_desc=new os(e.bl_tree,Na),e.bi_buf=0,e.bi_valid=0,Pa(e)},Va=(e,t,n,r)=>{Pe(e,(uu<<1)+(r?1:0),3),za(e),Gn(e,n),Gn(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},xu=e=>{Pe(e,Ca<<1,3),ht(e,ns,Ct),wu(e)},Ru=(e,t,n,r)=>{let i,s,l=0;e.level>0?(e.strm.data_type===du&&(e.strm.data_type=Cu(e)),ls(e,e.l_desc),ls(e,e.d_desc),l=ku(e),i=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=i&&(i=s)):i=s=n+5,n+4<=i&&t!==-1?Va(e,t,n,r):e.strategy===hu||s===i?(Pe(e,(Ca<<1)+(r?1:0),3),ja(e,Ct,Yn)):(Pe(e,(fu<<1)+(r?1:0),3),Eu(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),ja(e,e.dyn_ltree,e.dyn_dtree)),Pa(e),r&&za(e)},Tu=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(Jn[n]+Wn+1)*2]++,e.dyn_dtree[Ma(t)*2]++),e.sym_next===e.sym_end);var Au=Su,Du=Va,Lu=Ru,Nu=Tu,Mu=xu,Ou={_tr_init:Au,_tr_stored_block:Du,_tr_flush_block:Lu,_tr_tally:Nu,_tr_align:Mu},Xn=(e,t,n,r)=>{let i=e&65535|0,s=e>>>16&65535|0,l=0;for(;n!==0;){l=n>2e3?2e3:n,n-=l;do i=i+t[r++]|0,s=s+i|0;while(--l);i%=65521,s%=65521}return i|s<<16|0};const Iu=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},Pu=new Uint32Array(Iu());var Se=(e,t,n,r)=>{const i=Pu,s=r+n;e^=-1;for(let l=r;l<s;l++)e=e>>>8^i[(e^t[l])&255];return e^-1},Jt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},bn={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:zu,_tr_stored_block:cs,_tr_flush_block:Bu,_tr_tally:Mt,_tr_align:ju}=Ou,{Z_NO_FLUSH:Ot,Z_PARTIAL_FLUSH:Uu,Z_FULL_FLUSH:Fu,Z_FINISH:We,Z_BLOCK:qa,Z_OK:De,Z_STREAM_END:Za,Z_STREAM_ERROR:dt,Z_DATA_ERROR:Hu,Z_BUF_ERROR:hs,Z_DEFAULT_COMPRESSION:Vu,Z_FILTERED:qu,Z_HUFFMAN_ONLY:Yr,Z_RLE:Zu,Z_FIXED:Wu,Z_DEFAULT_STRATEGY:Ku,Z_UNKNOWN:Yu,Z_DEFLATED:$r}=bn,$u=9,Ju=15,Gu=8,Xu=29,Qu=256,ds=Qu+1+Xu,ef=30,tf=19,nf=2*ds+1,rf=15,le=3,It=258,ut=It+le+1,sf=32,wn=42,us=57,fs=69,gs=73,ps=91,_s=103,Gt=113,Qn=666,Oe=1,yn=2,Xt=3,vn=4,of=3,Qt=(e,t)=>(e.msg=Jt[t],t),Wa=e=>e*2-(e>4?9:0),Pt=e=>{let t=e.length;for(;--t>=0;)e[t]=0},af=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do n=e.head[--r],e.head[r]=n>=i?n-i:0;while(--t);t=i,r=t;do n=e.prev[--r],e.prev[r]=n>=i?n-i:0;while(--t)};let lf=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,zt=lf;const je=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},Ue=(e,t)=>{Bu(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,je(e.strm)},de=(e,t)=>{e.pending_buf[e.pending++]=t},er=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},ms=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),e.state.wrap===1?e.adler=Xn(e.adler,t,i,n):e.state.wrap===2&&(e.adler=Se(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},Ka=(e,t)=>{let n=e.max_chain_length,r=e.strstart,i,s,l=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-ut?e.strstart-(e.w_size-ut):0,h=e.window,u=e.w_mask,f=e.prev,p=e.strstart+It;let g=h[r+l-1],m=h[r+l];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do if(i=t,!(h[i+l]!==m||h[i+l-1]!==g||h[i]!==h[r]||h[++i]!==h[r+1])){r+=2,i++;do;while(h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&r<p);if(s=It-(p-r),r=p-It,s>l){if(e.match_start=t,l=s,s>=a)break;g=h[r+l-1],m=h[r+l]}}while((t=f[t&u])>c&&--n!==0);return l<=e.lookahead?l:e.lookahead},kn=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-ut)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),af(e),r+=t),e.strm.avail_in===0)break;if(n=ms(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=le)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=zt(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=zt(e,e.ins_h,e.window[i+le-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<le)););}while(e.lookahead<ut&&e.strm.avail_in!==0)},Ya=(e,t)=>{let n=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,r,i,s,l=0,a=e.strm.avail_in;do{if(r=65535,s=e.bi_valid+42>>3,e.strm.avail_out<s||(s=e.strm.avail_out-s,i=e.strstart-e.block_start,r>i+e.strm.avail_in&&(r=i+e.strm.avail_in),r>s&&(r=s),r<n&&(r===0&&t!==We||t===Ot||r!==i+e.strm.avail_in)))break;l=t===We&&r===i+e.strm.avail_in?1:0,cs(e,0,0,l),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,je(e.strm),i&&(i>r&&(i=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,r-=i),r&&(ms(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(l===0);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),l?vn:t!==Ot&&t!==We&&e.strm.avail_in===0&&e.strstart===e.block_start?yn:(s=e.window_size-e.strstart,e.strm.avail_in>s&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,s+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),s>e.strm.avail_in&&(s=e.strm.avail_in),s&&(ms(e.strm,e.window,e.strstart,s),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.high_water<e.strstart&&(e.high_water=e.strstart),s=e.bi_valid+42>>3,s=e.pending_buf_size-s>65535?65535:e.pending_buf_size-s,n=s>e.w_size?e.w_size:s,i=e.strstart-e.block_start,(i>=n||(i||t===We)&&t!==Ot&&e.strm.avail_in===0&&i<=s)&&(r=i>s?s:i,l=t===We&&e.strm.avail_in===0&&r===i?1:0,cs(e,e.block_start,r,l),e.block_start+=r,je(e.strm)),l?Xt:Oe)},bs=(e,t)=>{let n,r;for(;;){if(e.lookahead<ut){if(kn(e),e.lookahead<ut&&t===Ot)return Oe;if(e.lookahead===0)break}if(n=0,e.lookahead>=le&&(e.ins_h=zt(e,e.ins_h,e.window[e.strstart+le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-ut&&(e.match_length=Ka(e,n)),e.match_length>=le)if(r=Mt(e,e.strstart-e.match_start,e.match_length-le),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=le){e.match_length--;do e.strstart++,e.ins_h=zt(e,e.ins_h,e.window[e.strstart+le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=zt(e,e.ins_h,e.window[e.strstart+1]);else r=Mt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Ue(e,!1),e.strm.avail_out===0))return Oe}return e.insert=e.strstart<le-1?e.strstart:le-1,t===We?(Ue(e,!0),e.strm.avail_out===0?Xt:vn):e.sym_next&&(Ue(e,!1),e.strm.avail_out===0)?Oe:yn},En=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<ut){if(kn(e),e.lookahead<ut&&t===Ot)return Oe;if(e.lookahead===0)break}if(n=0,e.lookahead>=le&&(e.ins_h=zt(e,e.ins_h,e.window[e.strstart+le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=le-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-ut&&(e.match_length=Ka(e,n),e.match_length<=5&&(e.strategy===qu||e.match_length===le&&e.strstart-e.match_start>4096)&&(e.match_length=le-1)),e.prev_length>=le&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-le,r=Mt(e,e.strstart-1-e.prev_match,e.prev_length-le),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=zt(e,e.ins_h,e.window[e.strstart+le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=le-1,e.strstart++,r&&(Ue(e,!1),e.strm.avail_out===0))return Oe}else if(e.match_available){if(r=Mt(e,0,e.window[e.strstart-1]),r&&Ue(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Oe}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Mt(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<le-1?e.strstart:le-1,t===We?(Ue(e,!0),e.strm.avail_out===0?Xt:vn):e.sym_next&&(Ue(e,!1),e.strm.avail_out===0)?Oe:yn},cf=(e,t)=>{let n,r,i,s;const l=e.window;for(;;){if(e.lookahead<=It){if(kn(e),e.lookahead<=It&&t===Ot)return Oe;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=le&&e.strstart>0&&(i=e.strstart-1,r=l[i],r===l[++i]&&r===l[++i]&&r===l[++i])){s=e.strstart+It;do;while(r===l[++i]&&r===l[++i]&&r===l[++i]&&r===l[++i]&&r===l[++i]&&r===l[++i]&&r===l[++i]&&r===l[++i]&&i<s);e.match_length=It-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=le?(n=Mt(e,1,e.match_length-le),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Mt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Ue(e,!1),e.strm.avail_out===0))return Oe}return e.insert=0,t===We?(Ue(e,!0),e.strm.avail_out===0?Xt:vn):e.sym_next&&(Ue(e,!1),e.strm.avail_out===0)?Oe:yn},hf=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(kn(e),e.lookahead===0)){if(t===Ot)return Oe;break}if(e.match_length=0,n=Mt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Ue(e,!1),e.strm.avail_out===0))return Oe}return e.insert=0,t===We?(Ue(e,!0),e.strm.avail_out===0?Xt:vn):e.sym_next&&(Ue(e,!1),e.strm.avail_out===0)?Oe:yn};function ft(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const tr=[new ft(0,0,0,0,Ya),new ft(4,4,8,4,bs),new ft(4,5,16,8,bs),new ft(4,6,32,32,bs),new ft(4,4,16,16,En),new ft(8,16,32,32,En),new ft(8,16,128,128,En),new ft(8,32,128,256,En),new ft(32,128,258,1024,En),new ft(32,258,258,4096,En)],df=e=>{e.window_size=2*e.w_size,Pt(e.head),e.max_lazy_match=tr[e.level].max_lazy,e.good_match=tr[e.level].good_length,e.nice_match=tr[e.level].nice_length,e.max_chain_length=tr[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=le-1,e.match_available=0,e.ins_h=0};function uf(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=$r,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(nf*2),this.dyn_dtree=new Uint16Array((2*ef+1)*2),this.bl_tree=new Uint16Array((2*tf+1)*2),Pt(this.dyn_ltree),Pt(this.dyn_dtree),Pt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(rf+1),this.heap=new Uint16Array(2*ds+1),Pt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*ds+1),Pt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const nr=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==wn&&t.status!==us&&t.status!==fs&&t.status!==gs&&t.status!==ps&&t.status!==_s&&t.status!==Gt&&t.status!==Qn?1:0},$a=e=>{if(nr(e))return Qt(e,dt);e.total_in=e.total_out=0,e.data_type=Yu;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?us:t.wrap?wn:Gt,e.adler=t.wrap===2?0:1,t.last_flush=-2,zu(t),De},Ja=e=>{const t=$a(e);return t===De&&df(e.state),t},ff=(e,t)=>nr(e)||e.state.wrap!==2?dt:(e.state.gzhead=t,De),Ga=(e,t,n,r,i,s)=>{if(!e)return dt;let l=1;if(t===Vu&&(t=6),r<0?(l=0,r=-r):r>15&&(l=2,r-=16),i<1||i>$u||n!==$r||r<8||r>15||t<0||t>9||s<0||s>Wu||r===8&&l!==1)return Qt(e,dt);r===8&&(r=9);const a=new uf;return e.state=a,a.strm=e,a.status=wn,a.wrap=l,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+le-1)/le),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=t,a.strategy=s,a.method=n,Ja(e)},gf=(e,t)=>Ga(e,t,$r,Ju,Gu,Ku),pf=(e,t)=>{if(nr(e)||t>qa||t<0)return e?Qt(e,dt):dt;const n=e.state;if(!e.output||e.avail_in!==0&&!e.input||n.status===Qn&&t!==We)return Qt(e,e.avail_out===0?hs:dt);const r=n.last_flush;if(n.last_flush=t,n.pending!==0){if(je(e),e.avail_out===0)return n.last_flush=-1,De}else if(e.avail_in===0&&Wa(t)<=Wa(r)&&t!==We)return Qt(e,hs);if(n.status===Qn&&e.avail_in!==0)return Qt(e,hs);if(n.status===wn&&n.wrap===0&&(n.status=Gt),n.status===wn){let i=$r+(n.w_bits-8<<4)<<8,s=-1;if(n.strategy>=Yr||n.level<2?s=0:n.level<6?s=1:n.level===6?s=2:s=3,i|=s<<6,n.strstart!==0&&(i|=sf),i+=31-i%31,er(n,i),n.strstart!==0&&(er(n,e.adler>>>16),er(n,e.adler&65535)),e.adler=1,n.status=Gt,je(e),n.pending!==0)return n.last_flush=-1,De}if(n.status===us){if(e.adler=0,de(n,31),de(n,139),de(n,8),n.gzhead)de(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),de(n,n.gzhead.time&255),de(n,n.gzhead.time>>8&255),de(n,n.gzhead.time>>16&255),de(n,n.gzhead.time>>24&255),de(n,n.level===9?2:n.strategy>=Yr||n.level<2?4:0),de(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(de(n,n.gzhead.extra.length&255),de(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Se(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=fs;else if(de(n,0),de(n,0),de(n,0),de(n,0),de(n,0),de(n,n.level===9?2:n.strategy>=Yr||n.level<2?4:0),de(n,of),n.status=Gt,je(e),n.pending!==0)return n.last_flush=-1,De}if(n.status===fs){if(n.gzhead.extra){let i=n.pending,s=(n.gzhead.extra.length&65535)-n.gzindex;for(;n.pending+s>n.pending_buf_size;){let a=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+a),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>i&&(e.adler=Se(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex+=a,je(e),n.pending!==0)return n.last_flush=-1,De;i=0,s-=a}let l=new Uint8Array(n.gzhead.extra);n.pending_buf.set(l.subarray(n.gzindex,n.gzindex+s),n.pending),n.pending+=s,n.gzhead.hcrc&&n.pending>i&&(e.adler=Se(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=gs}if(n.status===gs){if(n.gzhead.name){let i=n.pending,s;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Se(e.adler,n.pending_buf,n.pending-i,i)),je(e),n.pending!==0)return n.last_flush=-1,De;i=0}n.gzindex<n.gzhead.name.length?s=n.gzhead.name.charCodeAt(n.gzindex++)&255:s=0,de(n,s)}while(s!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Se(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=ps}if(n.status===ps){if(n.gzhead.comment){let i=n.pending,s;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Se(e.adler,n.pending_buf,n.pending-i,i)),je(e),n.pending!==0)return n.last_flush=-1,De;i=0}n.gzindex<n.gzhead.comment.length?s=n.gzhead.comment.charCodeAt(n.gzindex++)&255:s=0,de(n,s)}while(s!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Se(e.adler,n.pending_buf,n.pending-i,i))}n.status=_s}if(n.status===_s){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(je(e),n.pending!==0))return n.last_flush=-1,De;de(n,e.adler&255),de(n,e.adler>>8&255),e.adler=0}if(n.status=Gt,je(e),n.pending!==0)return n.last_flush=-1,De}if(e.avail_in!==0||n.lookahead!==0||t!==Ot&&n.status!==Qn){let i=n.level===0?Ya(n,t):n.strategy===Yr?hf(n,t):n.strategy===Zu?cf(n,t):tr[n.level].func(n,t);if((i===Xt||i===vn)&&(n.status=Qn),i===Oe||i===Xt)return e.avail_out===0&&(n.last_flush=-1),De;if(i===yn&&(t===Uu?ju(n):t!==qa&&(cs(n,0,0,!1),t===Fu&&(Pt(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),je(e),e.avail_out===0))return n.last_flush=-1,De}return t!==We?De:n.wrap<=0?Za:(n.wrap===2?(de(n,e.adler&255),de(n,e.adler>>8&255),de(n,e.adler>>16&255),de(n,e.adler>>24&255),de(n,e.total_in&255),de(n,e.total_in>>8&255),de(n,e.total_in>>16&255),de(n,e.total_in>>24&255)):(er(n,e.adler>>>16),er(n,e.adler&65535)),je(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?De:Za)},_f=e=>{if(nr(e))return dt;const t=e.state.status;return e.state=null,t===Gt?Qt(e,Hu):De},mf=(e,t)=>{let n=t.length;if(nr(e))return dt;const r=e.state,i=r.wrap;if(i===2||i===1&&r.status!==wn||r.lookahead)return dt;if(i===1&&(e.adler=Xn(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){i===0&&(Pt(r.head),r.strstart=0,r.block_start=0,r.insert=0);let c=new Uint8Array(r.w_size);c.set(t.subarray(n-r.w_size,n),0),t=c,n=r.w_size}const s=e.avail_in,l=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,kn(r);r.lookahead>=le;){let c=r.strstart,h=r.lookahead-(le-1);do r.ins_h=zt(r,r.ins_h,r.window[c+le-1]),r.prev[c&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=c,c++;while(--h);r.strstart=c,r.lookahead=le-1,kn(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=le-1,r.match_available=0,e.next_in=l,e.input=a,e.avail_in=s,r.wrap=i,De};var bf=gf,wf=Ga,yf=Ja,vf=$a,kf=ff,Ef=pf,Cf=_f,Sf=mf,xf="pako deflate (from Nodeca project)",rr={deflateInit:bf,deflateInit2:wf,deflateReset:yf,deflateResetKeep:vf,deflateSetHeader:kf,deflate:Ef,deflateEnd:Cf,deflateSetDictionary:Sf,deflateInfo:xf};const Rf=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Tf=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)Rf(n,r)&&(e[r]=n[r])}}return e},Af=e=>{let t=0;for(let r=0,i=e.length;r<i;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,i=0,s=e.length;r<s;r++){let l=e[r];n.set(l,i),i+=l.length}return n},Jr={assign:Tf,flattenChunks:Af};let Xa=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Xa=!1}const ir=new Uint8Array(256);for(let e=0;e<256;e++)ir[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;ir[254]=ir[254]=1;var Df=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,r,i,s,l=e.length,a=0;for(i=0;i<l;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<l&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),s=0,i=0;s<a;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<l&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|n&63):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|n&63):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|n&63);return t};const Lf=(e,t)=>{if(t<65534&&e.subarray&&Xa)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n};var Nf=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,i;const s=new Array(n*2);for(i=0,r=0;r<n;){let l=e[r++];if(l<128){s[i++]=l;continue}let a=ir[l];if(a>4){s[i++]=65533,r+=a-1;continue}for(l&=a===2?31:a===3?15:7;a>1&&r<n;)l=l<<6|e[r++]&63,a--;if(a>1){s[i++]=65533;continue}l<65536?s[i++]=l:(l-=65536,s[i++]=55296|l>>10&1023,s[i++]=56320|l&1023)}return Lf(s,i)},Mf=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+ir[e[n]]>t?n:t},sr={string2buf:Df,buf2string:Nf,utf8border:Mf};function Of(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Qa=Of;const el=Object.prototype.toString,{Z_NO_FLUSH:If,Z_SYNC_FLUSH:Pf,Z_FULL_FLUSH:zf,Z_FINISH:Bf,Z_OK:Gr,Z_STREAM_END:jf,Z_DEFAULT_COMPRESSION:Uf,Z_DEFAULT_STRATEGY:Ff,Z_DEFLATED:Hf}=bn;function or(e){this.options=Jr.assign({level:Uf,method:Hf,chunkSize:16384,windowBits:15,memLevel:8,strategy:Ff},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qa,this.strm.avail_out=0;let n=rr.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Gr)throw new Error(Jt[n]);if(t.header&&rr.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=sr.string2buf(t.dictionary):el.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,n=rr.deflateSetDictionary(this.strm,r),n!==Gr)throw new Error(Jt[n]);this._dict_set=!0}}or.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,s;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?Bf:If,typeof e=="string"?n.input=sr.string2buf(e):el.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(s===Pf||s===zf)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(i=rr.deflate(n,s),i===jf)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=rr.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Gr;if(n.avail_out===0){this.onData(n.output);continue}if(s>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0},or.prototype.onData=function(e){this.chunks.push(e)},or.prototype.onEnd=function(e){e===Gr&&(this.result=Jr.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function ws(e,t){const n=new or(t);if(n.push(e,!0),n.err)throw n.msg||Jt[n.err];return n.result}function Vf(e,t){return t=t||{},t.raw=!0,ws(e,t)}function qf(e,t){return t=t||{},t.gzip=!0,ws(e,t)}var Zf=or,Wf=ws,Kf=Vf,Yf=qf,$f=bn,Jf={Deflate:Zf,deflate:Wf,deflateRaw:Kf,gzip:Yf,constants:$f};const Xr=16209,Gf=16191;var Xf=function(e,t){let n,r,i,s,l,a,c,h,u,f,p,g,m,k,L,T,M,b,w,E,S,v,R,D;const C=e.state;n=e.next_in,R=e.input,r=n+(e.avail_in-5),i=e.next_out,D=e.output,s=i-(t-e.avail_out),l=i+(e.avail_out-257),a=C.dmax,c=C.wsize,h=C.whave,u=C.wnext,f=C.window,p=C.hold,g=C.bits,m=C.lencode,k=C.distcode,L=(1<<C.lenbits)-1,T=(1<<C.distbits)-1;e:do{g<15&&(p+=R[n++]<<g,g+=8,p+=R[n++]<<g,g+=8),M=m[p&L];t:for(;;){if(b=M>>>24,p>>>=b,g-=b,b=M>>>16&255,b===0)D[i++]=M&65535;else if(b&16){w=M&65535,b&=15,b&&(g<b&&(p+=R[n++]<<g,g+=8),w+=p&(1<<b)-1,p>>>=b,g-=b),g<15&&(p+=R[n++]<<g,g+=8,p+=R[n++]<<g,g+=8),M=k[p&T];n:for(;;){if(b=M>>>24,p>>>=b,g-=b,b=M>>>16&255,b&16){if(E=M&65535,b&=15,g<b&&(p+=R[n++]<<g,g+=8,g<b&&(p+=R[n++]<<g,g+=8)),E+=p&(1<<b)-1,E>a){e.msg="invalid distance too far back",C.mode=Xr;break e}if(p>>>=b,g-=b,b=i-s,E>b){if(b=E-b,b>h&&C.sane){e.msg="invalid distance too far back",C.mode=Xr;break e}if(S=0,v=f,u===0){if(S+=c-b,b<w){w-=b;do D[i++]=f[S++];while(--b);S=i-E,v=D}}else if(u<b){if(S+=c+u-b,b-=u,b<w){w-=b;do D[i++]=f[S++];while(--b);if(S=0,u<w){b=u,w-=b;do D[i++]=f[S++];while(--b);S=i-E,v=D}}}else if(S+=u-b,b<w){w-=b;do D[i++]=f[S++];while(--b);S=i-E,v=D}for(;w>2;)D[i++]=v[S++],D[i++]=v[S++],D[i++]=v[S++],w-=3;w&&(D[i++]=v[S++],w>1&&(D[i++]=v[S++]))}else{S=i-E;do D[i++]=D[S++],D[i++]=D[S++],D[i++]=D[S++],w-=3;while(w>2);w&&(D[i++]=D[S++],w>1&&(D[i++]=D[S++]))}}else if(b&64){e.msg="invalid distance code",C.mode=Xr;break e}else{M=k[(M&65535)+(p&(1<<b)-1)];continue n}break}}else if(b&64)if(b&32){C.mode=Gf;break e}else{e.msg="invalid literal/length code",C.mode=Xr;break e}else{M=m[(M&65535)+(p&(1<<b)-1)];continue t}break}}while(n<r&&i<l);w=g>>3,n-=w,g-=w<<3,p&=(1<<g)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?5+(r-n):5-(n-r),e.avail_out=i<l?257+(l-i):257-(i-l),C.hold=p,C.bits=g};const Cn=15,tl=852,nl=592,rl=0,ys=1,il=2,Qf=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),eg=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),tg=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ng=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ar=(e,t,n,r,i,s,l,a)=>{const c=a.bits;let h=0,u=0,f=0,p=0,g=0,m=0,k=0,L=0,T=0,M=0,b,w,E,S,v,R=null,D;const C=new Uint16Array(Cn+1),A=new Uint16Array(Cn+1);let I=null,B,V,H;for(h=0;h<=Cn;h++)C[h]=0;for(u=0;u<r;u++)C[t[n+u]]++;for(g=c,p=Cn;p>=1&&C[p]===0;p--);if(g>p&&(g=p),p===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,a.bits=1,0;for(f=1;f<p&&C[f]===0;f++);for(g<f&&(g=f),L=1,h=1;h<=Cn;h++)if(L<<=1,L-=C[h],L<0)return-1;if(L>0&&(e===rl||p!==1))return-1;for(A[1]=0,h=1;h<Cn;h++)A[h+1]=A[h]+C[h];for(u=0;u<r;u++)t[n+u]!==0&&(l[A[t[n+u]]++]=u);if(e===rl?(R=I=l,D=20):e===ys?(R=Qf,I=eg,D=257):(R=tg,I=ng,D=0),M=0,u=0,h=f,v=s,m=g,k=0,E=-1,T=1<<g,S=T-1,e===ys&&T>tl||e===il&&T>nl)return 1;for(;;){B=h-k,l[u]+1<D?(V=0,H=l[u]):l[u]>=D?(V=I[l[u]-D],H=R[l[u]-D]):(V=32+64,H=0),b=1<<h-k,w=1<<m,f=w;do w-=b,i[v+(M>>k)+w]=B<<24|V<<16|H|0;while(w!==0);for(b=1<<h-1;M&b;)b>>=1;if(b!==0?(M&=b-1,M+=b):M=0,u++,--C[h]===0){if(h===p)break;h=t[n+l[u]]}if(h>g&&(M&S)!==E){for(k===0&&(k=g),v+=f,m=h-k,L=1<<m;m+k<p&&(L-=C[m+k],!(L<=0));)m++,L<<=1;if(T+=1<<m,e===ys&&T>tl||e===il&&T>nl)return 1;E=M&S,i[E]=g<<24|m<<16|v-s|0}}return M!==0&&(i[v+M]=h-k<<24|64<<16|0),a.bits=g,0};const rg=0,sl=1,ol=2,{Z_FINISH:al,Z_BLOCK:ig,Z_TREES:Qr,Z_OK:en,Z_STREAM_END:sg,Z_NEED_DICT:og,Z_STREAM_ERROR:Xe,Z_DATA_ERROR:ll,Z_MEM_ERROR:cl,Z_BUF_ERROR:ag,Z_DEFLATED:hl}=bn,ei=16180,dl=16181,ul=16182,fl=16183,gl=16184,pl=16185,_l=16186,ml=16187,bl=16188,wl=16189,ti=16190,St=16191,vs=16192,yl=16193,ks=16194,vl=16195,kl=16196,El=16197,Cl=16198,ni=16199,ri=16200,Sl=16201,xl=16202,Rl=16203,Tl=16204,Al=16205,Es=16206,Dl=16207,Ll=16208,pe=16209,Nl=16210,Ml=16211,lg=852,cg=592,hg=15,dg=hg,Ol=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function ug(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const tn=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<ei||t.mode>Ml?1:0},Il=e=>{if(tn(e))return Xe;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=ei,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(lg),t.distcode=t.distdyn=new Int32Array(cg),t.sane=1,t.back=-1,en},Pl=e=>{if(tn(e))return Xe;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Il(e)},zl=(e,t)=>{let n;if(tn(e))return Xe;const r=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Xe:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,Pl(e))},Bl=(e,t)=>{if(!e)return Xe;const n=new ug;e.state=n,n.strm=e,n.window=null,n.mode=ei;const r=zl(e,t);return r!==en&&(e.state=null),r},fg=e=>Bl(e,dg);let jl=!0,Cs,Ss;const gg=e=>{if(jl){Cs=new Int32Array(512),Ss=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ar(sl,e.lens,0,288,Cs,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ar(ol,e.lens,0,32,Ss,0,e.work,{bits:5}),jl=!1}e.lencode=Cs,e.lenbits=9,e.distcode=Ss,e.distbits=5},Ul=(e,t,n,r)=>{let i;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(t.subarray(n-r,n-r+i),s.wnext),r-=i,r?(s.window.set(t.subarray(n-r,n),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},pg=(e,t)=>{let n,r,i,s,l,a,c,h,u,f,p,g,m,k,L=0,T,M,b,w,E,S,v,R;const D=new Uint8Array(4);let C,A;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(tn(e)||!e.output||!e.input&&e.avail_in!==0)return Xe;n=e.state,n.mode===St&&(n.mode=vs),l=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,r=e.input,a=e.avail_in,h=n.hold,u=n.bits,f=a,p=c,R=en;e:for(;;)switch(n.mode){case ei:if(n.wrap===0){n.mode=vs;break}for(;u<16;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(n.wrap&2&&h===35615){n.wbits===0&&(n.wbits=15),n.check=0,D[0]=h&255,D[1]=h>>>8&255,n.check=Se(n.check,D,2,0),h=0,u=0,n.mode=dl;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((h&255)<<8)+(h>>8))%31){e.msg="incorrect header check",n.mode=pe;break}if((h&15)!==hl){e.msg="unknown compression method",n.mode=pe;break}if(h>>>=4,u-=4,v=(h&15)+8,n.wbits===0&&(n.wbits=v),v>15||v>n.wbits){e.msg="invalid window size",n.mode=pe;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=h&512?wl:St,h=0,u=0;break;case dl:for(;u<16;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(n.flags=h,(n.flags&255)!==hl){e.msg="unknown compression method",n.mode=pe;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=pe;break}n.head&&(n.head.text=h>>8&1),n.flags&512&&n.wrap&4&&(D[0]=h&255,D[1]=h>>>8&255,n.check=Se(n.check,D,2,0)),h=0,u=0,n.mode=ul;case ul:for(;u<32;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.head&&(n.head.time=h),n.flags&512&&n.wrap&4&&(D[0]=h&255,D[1]=h>>>8&255,D[2]=h>>>16&255,D[3]=h>>>24&255,n.check=Se(n.check,D,4,0)),h=0,u=0,n.mode=fl;case fl:for(;u<16;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.head&&(n.head.xflags=h&255,n.head.os=h>>8),n.flags&512&&n.wrap&4&&(D[0]=h&255,D[1]=h>>>8&255,n.check=Se(n.check,D,2,0)),h=0,u=0,n.mode=gl;case gl:if(n.flags&1024){for(;u<16;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.length=h,n.head&&(n.head.extra_len=h),n.flags&512&&n.wrap&4&&(D[0]=h&255,D[1]=h>>>8&255,n.check=Se(n.check,D,2,0)),h=0,u=0}else n.head&&(n.head.extra=null);n.mode=pl;case pl:if(n.flags&1024&&(g=n.length,g>a&&(g=a),g&&(n.head&&(v=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(s,s+g),v)),n.flags&512&&n.wrap&4&&(n.check=Se(n.check,r,g,s)),a-=g,s+=g,n.length-=g),n.length))break e;n.length=0,n.mode=_l;case _l:if(n.flags&2048){if(a===0)break e;g=0;do v=r[s+g++],n.head&&v&&n.length<65536&&(n.head.name+=String.fromCharCode(v));while(v&&g<a);if(n.flags&512&&n.wrap&4&&(n.check=Se(n.check,r,g,s)),a-=g,s+=g,v)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=ml;case ml:if(n.flags&4096){if(a===0)break e;g=0;do v=r[s+g++],n.head&&v&&n.length<65536&&(n.head.comment+=String.fromCharCode(v));while(v&&g<a);if(n.flags&512&&n.wrap&4&&(n.check=Se(n.check,r,g,s)),a-=g,s+=g,v)break e}else n.head&&(n.head.comment=null);n.mode=bl;case bl:if(n.flags&512){for(;u<16;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(n.wrap&4&&h!==(n.check&65535)){e.msg="header crc mismatch",n.mode=pe;break}h=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=St;break;case wl:for(;u<32;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}e.adler=n.check=Ol(h),h=0,u=0,n.mode=ti;case ti:if(n.havedict===0)return e.next_out=l,e.avail_out=c,e.next_in=s,e.avail_in=a,n.hold=h,n.bits=u,og;e.adler=n.check=1,n.mode=St;case St:if(t===ig||t===Qr)break e;case vs:if(n.last){h>>>=u&7,u-=u&7,n.mode=Es;break}for(;u<3;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}switch(n.last=h&1,h>>>=1,u-=1,h&3){case 0:n.mode=yl;break;case 1:if(gg(n),n.mode=ni,t===Qr){h>>>=2,u-=2;break e}break;case 2:n.mode=kl;break;case 3:e.msg="invalid block type",n.mode=pe}h>>>=2,u-=2;break;case yl:for(h>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if((h&65535)!==(h>>>16^65535)){e.msg="invalid stored block lengths",n.mode=pe;break}if(n.length=h&65535,h=0,u=0,n.mode=ks,t===Qr)break e;case ks:n.mode=vl;case vl:if(g=n.length,g){if(g>a&&(g=a),g>c&&(g=c),g===0)break e;i.set(r.subarray(s,s+g),l),a-=g,s+=g,c-=g,l+=g,n.length-=g;break}n.mode=St;break;case kl:for(;u<14;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(n.nlen=(h&31)+257,h>>>=5,u-=5,n.ndist=(h&31)+1,h>>>=5,u-=5,n.ncode=(h&15)+4,h>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=pe;break}n.have=0,n.mode=El;case El:for(;n.have<n.ncode;){for(;u<3;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.lens[I[n.have++]]=h&7,h>>>=3,u-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},R=ar(rg,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,R){e.msg="invalid code lengths set",n.mode=pe;break}n.have=0,n.mode=Cl;case Cl:for(;n.have<n.nlen+n.ndist;){for(;L=n.lencode[h&(1<<n.lenbits)-1],T=L>>>24,M=L>>>16&255,b=L&65535,!(T<=u);){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(b<16)h>>>=T,u-=T,n.lens[n.have++]=b;else{if(b===16){for(A=T+2;u<A;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(h>>>=T,u-=T,n.have===0){e.msg="invalid bit length repeat",n.mode=pe;break}v=n.lens[n.have-1],g=3+(h&3),h>>>=2,u-=2}else if(b===17){for(A=T+3;u<A;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}h>>>=T,u-=T,v=0,g=3+(h&7),h>>>=3,u-=3}else{for(A=T+7;u<A;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}h>>>=T,u-=T,v=0,g=11+(h&127),h>>>=7,u-=7}if(n.have+g>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=pe;break}for(;g--;)n.lens[n.have++]=v}}if(n.mode===pe)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=pe;break}if(n.lenbits=9,C={bits:n.lenbits},R=ar(sl,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,R){e.msg="invalid literal/lengths set",n.mode=pe;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},R=ar(ol,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,R){e.msg="invalid distances set",n.mode=pe;break}if(n.mode=ni,t===Qr)break e;case ni:n.mode=ri;case ri:if(a>=6&&c>=258){e.next_out=l,e.avail_out=c,e.next_in=s,e.avail_in=a,n.hold=h,n.bits=u,Xf(e,p),l=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,r=e.input,a=e.avail_in,h=n.hold,u=n.bits,n.mode===St&&(n.back=-1);break}for(n.back=0;L=n.lencode[h&(1<<n.lenbits)-1],T=L>>>24,M=L>>>16&255,b=L&65535,!(T<=u);){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(M&&!(M&240)){for(w=T,E=M,S=b;L=n.lencode[S+((h&(1<<w+E)-1)>>w)],T=L>>>24,M=L>>>16&255,b=L&65535,!(w+T<=u);){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}h>>>=w,u-=w,n.back+=w}if(h>>>=T,u-=T,n.back+=T,n.length=b,M===0){n.mode=Al;break}if(M&32){n.back=-1,n.mode=St;break}if(M&64){e.msg="invalid literal/length code",n.mode=pe;break}n.extra=M&15,n.mode=Sl;case Sl:if(n.extra){for(A=n.extra;u<A;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.length+=h&(1<<n.extra)-1,h>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=xl;case xl:for(;L=n.distcode[h&(1<<n.distbits)-1],T=L>>>24,M=L>>>16&255,b=L&65535,!(T<=u);){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(!(M&240)){for(w=T,E=M,S=b;L=n.distcode[S+((h&(1<<w+E)-1)>>w)],T=L>>>24,M=L>>>16&255,b=L&65535,!(w+T<=u);){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}h>>>=w,u-=w,n.back+=w}if(h>>>=T,u-=T,n.back+=T,M&64){e.msg="invalid distance code",n.mode=pe;break}n.offset=b,n.extra=M&15,n.mode=Rl;case Rl:if(n.extra){for(A=n.extra;u<A;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.offset+=h&(1<<n.extra)-1,h>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=pe;break}n.mode=Tl;case Tl:if(c===0)break e;if(g=p-c,n.offset>g){if(g=n.offset-g,g>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=pe;break}g>n.wnext?(g-=n.wnext,m=n.wsize-g):m=n.wnext-g,g>n.length&&(g=n.length),k=n.window}else k=i,m=l-n.offset,g=n.length;g>c&&(g=c),c-=g,n.length-=g;do i[l++]=k[m++];while(--g);n.length===0&&(n.mode=ri);break;case Al:if(c===0)break e;i[l++]=n.length,c--,n.mode=ri;break;case Es:if(n.wrap){for(;u<32;){if(a===0)break e;a--,h|=r[s++]<<u,u+=8}if(p-=c,e.total_out+=p,n.total+=p,n.wrap&4&&p&&(e.adler=n.check=n.flags?Se(n.check,i,p,l-p):Xn(n.check,i,p,l-p)),p=c,n.wrap&4&&(n.flags?h:Ol(h))!==n.check){e.msg="incorrect data check",n.mode=pe;break}h=0,u=0}n.mode=Dl;case Dl:if(n.wrap&&n.flags){for(;u<32;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(n.wrap&4&&h!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=pe;break}h=0,u=0}n.mode=Ll;case Ll:R=sg;break e;case pe:R=ll;break e;case Nl:return cl;case Ml:default:return Xe}return e.next_out=l,e.avail_out=c,e.next_in=s,e.avail_in=a,n.hold=h,n.bits=u,(n.wsize||p!==e.avail_out&&n.mode<pe&&(n.mode<Es||t!==al))&&Ul(e,e.output,e.next_out,p-e.avail_out),f-=e.avail_in,p-=e.avail_out,e.total_in+=f,e.total_out+=p,n.total+=p,n.wrap&4&&p&&(e.adler=n.check=n.flags?Se(n.check,i,p,e.next_out-p):Xn(n.check,i,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(n.mode===St?128:0)+(n.mode===ni||n.mode===ks?256:0),(f===0&&p===0||t===al)&&R===en&&(R=ag),R},_g=e=>{if(tn(e))return Xe;let t=e.state;return t.window&&(t.window=null),e.state=null,en},mg=(e,t)=>{if(tn(e))return Xe;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,en):Xe},bg=(e,t)=>{const n=t.length;let r,i,s;return tn(e)||(r=e.state,r.wrap!==0&&r.mode!==ti)?Xe:r.mode===ti&&(i=1,i=Xn(i,t,n,0),i!==r.check)?ll:(s=Ul(e,t,n,n),s?(r.mode=Nl,cl):(r.havedict=1,en))};var wg=Pl,yg=zl,vg=Il,kg=fg,Eg=Bl,Cg=pg,Sg=_g,xg=mg,Rg=bg,Tg="pako inflate (from Nodeca project)",xt={inflateReset:wg,inflateReset2:yg,inflateResetKeep:vg,inflateInit:kg,inflateInit2:Eg,inflate:Cg,inflateEnd:Sg,inflateGetHeader:xg,inflateSetDictionary:Rg,inflateInfo:Tg};function Ag(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Dg=Ag;const Fl=Object.prototype.toString,{Z_NO_FLUSH:Lg,Z_FINISH:Ng,Z_OK:lr,Z_STREAM_END:xs,Z_NEED_DICT:Rs,Z_STREAM_ERROR:Mg,Z_DATA_ERROR:Hl,Z_MEM_ERROR:Og}=bn;function cr(e){this.options=Jr.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qa,this.strm.avail_out=0;let n=xt.inflateInit2(this.strm,t.windowBits);if(n!==lr)throw new Error(Jt[n]);if(this.header=new Dg,xt.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=sr.string2buf(t.dictionary):Fl.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=xt.inflateSetDictionary(this.strm,t.dictionary),n!==lr)))throw new Error(Jt[n])}cr.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,l,a;if(this.ended)return!1;for(t===~~t?l=t:l=t===!0?Ng:Lg,Fl.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),s=xt.inflate(n,l),s===Rs&&i&&(s=xt.inflateSetDictionary(n,i),s===lr?s=xt.inflate(n,l):s===Hl&&(s=Rs));n.avail_in>0&&s===xs&&n.state.wrap>0&&e[n.next_in]!==0;)xt.inflateReset(n),s=xt.inflate(n,l);switch(s){case Mg:case Hl:case Rs:case Og:return this.onEnd(s),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(n.avail_out===0||s===xs))if(this.options.to==="string"){let c=sr.utf8border(n.output,n.next_out),h=n.next_out-c,u=sr.buf2string(n.output,c);n.next_out=h,n.avail_out=r-h,h&&n.output.set(n.output.subarray(c,c+h),0),this.onData(u)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===lr&&a===0)){if(s===xs)return s=xt.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0},cr.prototype.onData=function(e){this.chunks.push(e)},cr.prototype.onEnd=function(e){e===lr&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Jr.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Ts(e,t){const n=new cr(t);if(n.push(e),n.err)throw n.msg||Jt[n.err];return n.result}function Ig(e,t){return t=t||{},t.raw=!0,Ts(e,t)}var Pg=cr,zg=Ts,Bg=Ig,jg=Ts,Ug=bn,Fg={Inflate:Pg,inflate:zg,inflateRaw:Bg,ungzip:jg,constants:Ug};const{Deflate:Op,deflate:Hg,deflateRaw:Ip,gzip:Pp}=Jf,{Inflate:zp,inflate:Vg,inflateRaw:Bp,ungzip:jp}=Fg;var qg=Hg,Zg=Vg;const hr=Tp("code");function Wg(e){let t,n,r="code",i,s,l="tree",a,c;return{c(){t=te("div"),n=te("button"),n.textContent=r,i=xe(),s=te("button"),s.textContent=l,this.h()},l(h){t=ne(h,"DIV",{class:!0});var u=ce(t);n=ne(u,"BUTTON",{class:!0,"data-svelte-h":!0}),Me(n)!=="svelte-1tzsrcf"&&(n.textContent=r),i=Re(u),s=ne(u,"BUTTON",{class:!0,"data-svelte-h":!0}),Me(s)!=="svelte-1f7s8uy"&&(s.textContent=l),u.forEach(G),this.h()},h(){U(n,"class","svelte-6hveha"),Te(n,"active",e[0]=="code"),U(s,"class","svelte-6hveha"),Te(s,"active",e[0]=="tree"),U(t,"class","row flex svelte-6hveha")},m(h,u){Ye(h,t,u),Z(t,n),Z(t,i),Z(t,s),a||(c=[$e(n,"click",e[1]),$e(s,"click",e[2])],a=!0)},p(h,[u]){u&1&&Te(n,"active",h[0]=="code"),u&1&&Te(s,"active",h[0]=="tree")},i:As,o:As,d(h){h&&G(t),a=!1,Ds(c)}}}function Kg(e,t,n){let r;return Yl(e,hr,i=>n(0,r=i)),[r,()=>{hr.set("code")},()=>{hr.set("tree")}]}class Yg extends $l{constructor(t){super(),Jl(this,t,Kg,Wg,Kl,{})}}function $g(e){let t,n=`create lobby
                    <svg width="24" height="24" fill="#bdbdbd" version="1.0" viewBox="0 0 24 24" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><g><path d="M16.5,14c-1.5,0-2.7,0.4-3.6,0.9c1.4,1.2,2,2.6,2.1,2.7l0.1,0.2V20h8v-2C23,18,21.4,14,16.5,14z"></path></g><g><circle cx="16.5" cy="8.5" r="3.5"></circle></g></g><g><path d="M4,8.5C4,6.6,5.6,5,7.5,5S11,6.6,11,8.5c0,1.9-1.6,3.5-3.5,3.5S4,10.4,4,8.5z M7.5,14C2.6,14,1,18,1,18v2h13v-2   C14,18,12.4,14,7.5,14z"></path></g></svg>`,r,i;return{c(){t=te("button"),t.innerHTML=n,this.h()},l(s){t=ne(s,"BUTTON",{class:!0,"data-svelte-h":!0}),Me(t)!=="svelte-1b5uz4i"&&(t.innerHTML=n),this.h()},h(){U(t,"class","flex items-center gap-2 gray-border p-1 px-3 rounded-md hidden svelte-8inrpd")},m(s,l){Ye(s,t,l),r||(i=$e(t,"click",e[13]),r=!0)},p:As,d(s){s&&G(t),r=!1,i()}}}function Jg(e){let t,n,r,i,s,l,a,c,h;function u(g,m){return g[9]?Gg:Xg}let f=u(e),p=f(e);return{c(){t=te("div"),n=te("input"),i=xe(),s=te("button"),l=te("div"),a=te("clipboard-copy"),p.c(),this.h()},l(g){t=ne(g,"DIV",{class:!0});var m=ce(t);n=ne(m,"INPUT",{class:!0,type:!0}),i=Re(m),s=ne(m,"BUTTON",{});var k=ce(s);l=ne(k,"DIV",{class:!0});var L=ce(l);a=ne(L,"CLIPBOARD-COPY",{value:!0});var T=ce(a);p.l(T),T.forEach(G),L.forEach(G),k.forEach(G),m.forEach(G),this.h()},h(){var g;U(n,"class","w-full input-monospace svelte-8inrpd"),U(n,"type","text"),n.readOnly=!0,n.value=r=(g=e[6])==null?void 0:g.split("=")[1],ii(a,"value",e[6]),U(l,"class","h-full copy-btn flex items-center justify-center px-4 svelte-8inrpd"),U(t,"class","flex")},m(g,m){Ye(g,t,m),Z(t,n),Z(t,i),Z(t,s),Z(s,l),Z(l,a),p.m(a,null),c||(h=$e(s,"click",e[12]),c=!0)},p(g,m){var k;m&64&&r!==(r=(k=g[6])==null?void 0:k.split("=")[1])&&n.value!==r&&(n.value=r),f!==(f=u(g))&&(p.d(1),p=f(g),p&&(p.c(),p.m(a,null))),m&64&&ii(a,"value",g[6])},d(g){g&&G(t),p.d(),c=!1,h()}}}function Gg(e){let t,n;return{c(){t=_t("svg"),n=_t("path"),this.h()},l(r){t=mt(r,"svg",{"aria-hidden":!0,height:!0,viewBox:!0,version:!0,width:!0,"data-view-component":!0,class:!0});var i=ce(t);n=mt(i,"path",{fill:!0,d:!0}),ce(n).forEach(G),i.forEach(G),this.h()},h(){U(n,"fill","lightgreen"),U(n,"d","M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"),U(t,"aria-hidden","true"),U(t,"height","16"),U(t,"viewBox","0 0 16 16"),U(t,"version","1.1"),U(t,"width","16"),U(t,"data-view-component","true"),U(t,"class","")},m(r,i){Ye(r,t,i),Z(t,n)},d(r){r&&G(t)}}}function Xg(e){let t,n,r;return{c(){t=_t("svg"),n=_t("path"),r=_t("path"),this.h()},l(i){t=mt(i,"svg",{"aria-hidden":!0,height:!0,viewBox:!0,version:!0,width:!0,"data-view-component":!0,class:!0});var s=ce(t);n=mt(s,"path",{d:!0,class:!0}),ce(n).forEach(G),r=mt(s,"path",{d:!0,class:!0}),ce(r).forEach(G),s.forEach(G),this.h()},h(){U(n,"d","M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"),U(n,"class","svelte-8inrpd"),U(r,"d","M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"),U(r,"class","svelte-8inrpd"),U(t,"aria-hidden","true"),U(t,"height","16"),U(t,"viewBox","0 0 16 16"),U(t,"version","1.1"),U(t,"width","16"),U(t,"data-view-component","true"),U(t,"class","octicon svelte-8inrpd")},m(i,s){Ye(i,t,s),Z(t,n),Z(t,r)},d(i){i&&G(t)}}}function Vl(e){let t,n='<div class="ios-buttons svelte-8inrpd"><div class="ios-button close svelte-8inrpd"></div> <div class="ios-button minimize svelte-8inrpd"></div> <div class="ios-button maximize svelte-8inrpd"></div></div>';return{c(){t=te("div"),t.innerHTML=n},l(r){t=ne(r,"DIV",{"data-svelte-h":!0}),Me(t)!=="svelte-1sh1ecu"&&(t.innerHTML=n)},m(r,i){Ye(r,t,i)},d(r){r&&G(t)}}}function ql(e){let t,n;return{c(){t=te("div"),n=ap(e[5]),this.h()},l(r){t=ne(r,"DIV",{class:!0});var i=ce(t);n=lp(i,e[5]),i.forEach(G),this.h()},h(){U(t,"class","grow p-3 pt-2 text-red-400 overflow-y-scroll")},m(r,i){Ye(r,t,i),Z(t,n)},p(r,i){i&32&&cp(n,r[5])},d(r){r&&G(t)}}}function Zl(e){let t,n,r='<svg width="32" height="32" viewBox="0 0 98 96" xmlns="http://www.w3.org/2000/svg"><path fill="#bdbdbd" fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"></path></svg>',i,s,l,a,c,h,u,f,p,g,m,k="v1",L,T="v0",M,b,w,E,S="Mainnet",v,R="Testnet",D,C,A=`compile
                    <img src="command_line.png" class="w-4" alt=""/>`,I,B;function V(Q,F){return Q[8]?Qg:ep}let H=V(e),K=H(e),J=e[2]=="v0"&&Wl(e);return{c(){t=te("div"),n=te("a"),n.innerHTML=r,i=xe(),s=te("div"),l=te("div"),a=te("input"),c=xe(),h=te("button"),u=te("div"),f=te("clipboard-copy"),K.c(),p=xe(),g=te("select"),m=te("option"),m.textContent=k,L=te("option"),L.textContent=T,M=xe(),J&&J.c(),b=xe(),w=te("select"),E=te("option"),E.textContent=S,v=te("option"),v.textContent=R,D=xe(),C=te("button"),C.innerHTML=A,this.h()},l(Q){t=ne(Q,"DIV",{class:!0});var F=ce(t);n=ne(F,"A",{class:!0,href:!0,"data-svelte-h":!0}),Me(n)!=="svelte-gsk1jy"&&(n.innerHTML=r),i=Re(F),s=ne(F,"DIV",{class:!0});var ue=ce(s);l=ne(ue,"DIV",{class:!0});var he=ce(l);a=ne(he,"INPUT",{class:!0,type:!0}),c=Re(he),h=ne(he,"BUTTON",{});var fe=ce(h);u=ne(fe,"DIV",{class:!0});var ee=ce(u);f=ne(ee,"CLIPBOARD-COPY",{value:!0});var q=ce(f);K.l(q),q.forEach(G),ee.forEach(G),fe.forEach(G),he.forEach(G),ue.forEach(G),p=Re(F),g=ne(F,"SELECT",{name:!0,id:!0,class:!0,style:!0});var ie=ce(g);m=ne(ie,"OPTION",{"data-svelte-h":!0}),Me(m)!=="svelte-118r9sm"&&(m.textContent=k),L=ne(ie,"OPTION",{"data-svelte-h":!0}),Me(L)!=="svelte-sm54j8"&&(L.textContent=T),ie.forEach(G),M=Re(F),J&&J.l(F),b=Re(F),w=ne(F,"SELECT",{name:!0,id:!0,class:!0,style:!0});var Le=ce(w);E=ne(Le,"OPTION",{"data-svelte-h":!0}),Me(E)!=="svelte-25qg8g"&&(E.textContent=S),v=ne(Le,"OPTION",{"data-svelte-h":!0}),Me(v)!=="svelte-mfwbwu"&&(v.textContent=R),Le.forEach(G),D=Re(F),C=ne(F,"BUTTON",{class:!0,"data-svelte-h":!0}),Me(C)!=="svelte-9cox89"&&(C.innerHTML=A),F.forEach(G),this.h()},h(){U(n,"class","ml-2"),U(n,"href","https://github.com/SavonarolaLabs/escript-online"),U(a,"class","w-full input-monospace svelte-8inrpd"),U(a,"type","text"),a.readOnly=!0,a.value=e[4],ii(f,"value",e[4]),U(u,"class","h-full copy-btn flex items-center justify-center px-4 svelte-8inrpd"),U(l,"class","flex"),U(s,"class","grow"),m.__value="v1",Tn(m,m.__value),L.__value="v0",Tn(L,L.__value),U(g,"name","network"),U(g,"id","network"),U(g,"class","bg-black flex items-center gap-2 m-2 px-3 py-2 custom-select svelte-8inrpd"),Rt(g,"-webkit-appearance","none",1),Rt(g,"-moz-appearance","none",1),e[2]===void 0&&Ls(()=>e[17].call(g)),E.__value=Ms.Mainnet,Tn(E,E.__value),v.__value=Ms.Testnet,Tn(v,v.__value),U(w,"name","network"),U(w,"id","network"),U(w,"class","bg-black flex items-center gap-2 m-2 px-3 py-2 custom-select svelte-8inrpd"),Rt(w,"-webkit-appearance","none",1),Rt(w,"-moz-appearance","none",1),e[1]===void 0&&Ls(()=>e[19].call(w)),U(C,"class","btn flex items-center gap-2 m-2 px-3 py-2 svelte-8inrpd"),U(t,"class","w-full flex items-center p-2 gap-4")},m(Q,F){Ye(Q,t,F),Z(t,n),Z(t,i),Z(t,s),Z(s,l),Z(l,a),Z(l,c),Z(l,h),Z(h,u),Z(u,f),K.m(f,null),Z(t,p),Z(t,g),Z(g,m),Z(g,L),An(g,e[2],!0),Z(t,M),J&&J.m(t,null),Z(t,b),Z(t,w),Z(w,E),Z(w,v),An(w,e[1],!0),Z(t,D),Z(t,C),I||(B=[$e(h,"click",e[11]),$e(g,"change",e[17]),$e(w,"change",e[19]),$e(C,"click",e[10])],I=!0)},p(Q,F){F&16&&a.value!==Q[4]&&(a.value=Q[4]),H!==(H=V(Q))&&(K.d(1),K=H(Q),K&&(K.c(),K.m(f,null))),F&16&&ii(f,"value",Q[4]),F&4&&An(g,Q[2]),Q[2]=="v0"?J?J.p(Q,F):(J=Wl(Q),J.c(),J.m(t,b)):J&&(J.d(1),J=null),F&2&&An(w,Q[1])},d(Q){Q&&G(t),K.d(),J&&J.d(),I=!1,Ds(B)}}}function Qg(e){let t,n;return{c(){t=_t("svg"),n=_t("path"),this.h()},l(r){t=mt(r,"svg",{"aria-hidden":!0,height:!0,viewBox:!0,version:!0,width:!0,"data-view-component":!0,class:!0});var i=ce(t);n=mt(i,"path",{fill:!0,d:!0}),ce(n).forEach(G),i.forEach(G),this.h()},h(){U(n,"fill","lightgreen"),U(n,"d","M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"),U(t,"aria-hidden","true"),U(t,"height","16"),U(t,"viewBox","0 0 16 16"),U(t,"version","1.1"),U(t,"width","16"),U(t,"data-view-component","true"),U(t,"class","")},m(r,i){Ye(r,t,i),Z(t,n)},d(r){r&&G(t)}}}function ep(e){let t,n,r;return{c(){t=_t("svg"),n=_t("path"),r=_t("path"),this.h()},l(i){t=mt(i,"svg",{"aria-hidden":!0,height:!0,viewBox:!0,version:!0,width:!0,"data-view-component":!0,class:!0});var s=ce(t);n=mt(s,"path",{d:!0,class:!0}),ce(n).forEach(G),r=mt(s,"path",{d:!0,class:!0}),ce(r).forEach(G),s.forEach(G),this.h()},h(){U(n,"d","M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"),U(n,"class","svelte-8inrpd"),U(r,"d","M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"),U(r,"class","svelte-8inrpd"),U(t,"aria-hidden","true"),U(t,"height","16"),U(t,"viewBox","0 0 16 16"),U(t,"version","1.1"),U(t,"width","16"),U(t,"data-view-component","true"),U(t,"class","octicon svelte-8inrpd")},m(i,s){Ye(i,t,s),Z(t,n),Z(t,r)},d(i){i&&G(t)}}}function Wl(e){let t,n,r="includeSize: false \xA0\xA0",i,s="includeSize: true \xA0\xA0",l,a;return{c(){t=te("select"),n=te("option"),n.textContent=r,i=te("option"),i.textContent=s,this.h()},l(c){t=ne(c,"SELECT",{name:!0,id:!0,class:!0,style:!0});var h=ce(t);n=ne(h,"OPTION",{"data-svelte-h":!0}),Me(n)!=="svelte-mccm59"&&(n.textContent=r),i=ne(h,"OPTION",{"data-svelte-h":!0}),Me(i)!=="svelte-pk2sn9"&&(i.textContent=s),h.forEach(G),this.h()},h(){n.__value=!1,Tn(n,n.__value),i.__value=!0,Tn(i,i.__value),U(t,"name","includeSize"),U(t,"id","includeSize"),U(t,"class","bg-black flex items-center gap-2 m-2 px-3 py-2 custom-select svelte-8inrpd"),Rt(t,"-webkit-appearance","none",1),Rt(t,"-moz-appearance","none",1),e[3]===void 0&&Ls(()=>e[18].call(t))},m(c,h){Ye(c,t,h),Z(t,n),Z(t,i),An(t,e[3],!0),l||(a=$e(t,"change",e[18]),l=!0)},p(c,h){h&8&&An(t,c[3])},d(c){c&&G(t),l=!1,a()}}}function tp(e){let t,n,r,i,s,l,a,c="ErgoScript",h,u,f,p,g,m,k=`copy as html
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="ml-2"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.46447 3.46447C2 4.92893 2 7.28595 2 12C2 16.714 2 19.0711 3.46447 20.5355C4.92893 22 7.28595 22 12 22C16.714 22 19.0711 22 20.5355 20.5355C22 19.0711 22 16.714 22 12C22 7.28595 22 4.92893 20.5355 3.46447C19.0711 2 16.714 2 12 2C7.28595 2 4.92893 2 3.46447 3.46447ZM13.4881 6.44591C13.8882 6.55311 14.1256 6.96437 14.0184 7.36447L11.4302 17.0237C11.323 17.4238 10.9117 17.6613 10.5116 17.5541C10.1115 17.4468 9.8741 17.0356 9.98131 16.6355L12.5695 6.97624C12.6767 6.57614 13.088 6.3387 13.4881 6.44591ZM14.9697 8.46967C15.2626 8.17678 15.7374 8.17678 16.0303 8.46967L16.2387 8.67801C16.874 9.3133 17.4038 9.84308 17.7678 10.3202C18.1521 10.8238 18.4216 11.3559 18.4216 12C18.4216 12.6441 18.1521 13.1762 17.7678 13.6798C17.4038 14.1569 16.874 14.6867 16.2387 15.322L16.0303 15.5303C15.7374 15.8232 15.2626 15.8232 14.9697 15.5303C14.6768 15.2374 14.6768 14.7626 14.9697 14.4697L15.1412 14.2981C15.8229 13.6164 16.2797 13.1574 16.5753 12.7699C16.8577 12.3998 16.9216 12.1843 16.9216 12C16.9216 11.8157 16.8577 11.6002 16.5753 11.2301C16.2797 10.8426 15.8229 10.3836 15.1412 9.70191L14.9697 9.53033C14.6768 9.23744 14.6768 8.76257 14.9697 8.46967ZM7.96986 8.46967C8.26275 8.17678 8.73762 8.17678 9.03052 8.46967C9.32341 8.76257 9.32341 9.23744 9.03052 9.53033L8.85894 9.70191C8.17729 10.3836 7.72052 10.8426 7.42488 11.2301C7.14245 11.6002 7.07861 11.8157 7.07861 12C7.07861 12.1843 7.14245 12.3998 7.42488 12.7699C7.72052 13.1574 8.17729 13.6164 8.85894 14.2981L9.03052 14.4697C9.32341 14.7626 9.32341 15.2374 9.03052 15.5303C8.73762 15.8232 8.26275 15.8232 7.96986 15.5303L7.76151 15.322C7.12617 14.6867 6.59638 14.1569 6.23235 13.6798C5.84811 13.1762 5.57861 12.6441 5.57861 12C5.57861 11.3559 5.84811 10.8238 6.23235 10.3202C6.59638 9.84308 7.12617 9.31331 7.76151 8.67801L7.96986 8.46967Z" fill="#bdbdbd"></path></svg>`,L,T,M=`flex
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="ml-2"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.77778 21H14.2222C17.3433 21 18.9038 21 20.0248 20.2646C20.51 19.9462 20.9267 19.5371 21.251 19.0607C22 17.9601 22 16.4279 22 13.3636C22 10.2994 22 8.76721 21.251 7.6666C20.9267 7.19014 20.51 6.78104 20.0248 6.46268C19.3044 5.99013 18.4027 5.82123 17.022 5.76086C16.3631 5.76086 15.7959 5.27068 15.6667 4.63636C15.4728 3.68489 14.6219 3 13.6337 3H10.3663C9.37805 3 8.52715 3.68489 8.33333 4.63636C8.20412 5.27068 7.63685 5.76086 6.978 5.76086C5.59733 5.82123 4.69555 5.99013 3.97524 6.46268C3.48995 6.78104 3.07328 7.19014 2.74902 7.6666C2 8.76721 2 10.2994 2 13.3636C2 16.4279 2 17.9601 2.74902 19.0607C3.07328 19.5371 3.48995 19.9462 3.97524 20.2646C5.09624 21 6.65675 21 9.77778 21ZM12 9.27273C9.69881 9.27273 7.83333 11.1043 7.83333 13.3636C7.83333 15.623 9.69881 17.4545 12 17.4545C14.3012 17.4545 16.1667 15.623 16.1667 13.3636C16.1667 11.1043 14.3012 9.27273 12 9.27273ZM12 10.9091C10.6193 10.9091 9.5 12.008 9.5 13.3636C9.5 14.7192 10.6193 15.8182 12 15.8182C13.3807 15.8182 14.5 14.7192 14.5 13.3636C14.5 12.008 13.3807 10.9091 12 10.9091ZM16.7222 10.0909C16.7222 9.63904 17.0953 9.27273 17.5556 9.27273H18.6667C19.1269 9.27273 19.5 9.63904 19.5 10.0909C19.5 10.5428 19.1269 10.9091 18.6667 10.9091H17.5556C17.0953 10.9091 16.7222 10.5428 16.7222 10.0909Z" fill="#bdbdbd"></path></svg>`,b,w,E=`save code as bookmark
                <svg class="ml-2 octicon svelte-8inrpd" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 1792 1792"><path d="M1420 128q23 0 44 9 33 13 52.5 41t19.5 62v1289q0 34-19.5 62t-52.5 41q-19 8-44 8-48 0-83-32l-441-424-441 424q-36 33-83 33-23 0-44-9-33-13-52.5-41t-19.5-62V240q0-34 19.5-62t52.5-41q21-9 44-9h1048z" class="svelte-8inrpd"></path></svg>`,S,v,R,D,C,A,I,B,V,H,K,J;u=new Yg({});function Q(q,ie){return q[6]?Jg:$g}let F=Q(e),ue=F(e),he=e[7]&&Vl(),fe=e[5]&&ql(e),ee=!e[7]&&Zl(e);return{c(){t=te("div"),n=te("div"),r=te("div"),i=te("img"),l=xe(),a=te("div"),a.textContent=c,h=xe(),dp(u.$$.fragment),f=xe(),p=te("div"),ue.c(),g=xe(),m=te("button"),m.innerHTML=k,L=xe(),T=te("button"),T.innerHTML=M,b=xe(),w=te("button"),w.innerHTML=E,S=xe(),v=te("div"),R=te("div"),he&&he.c(),D=xe(),C=te("div"),A=xe(),I=te("div"),fe&&fe.c(),B=xe(),ee&&ee.c(),this.h()},l(q){t=ne(q,"DIV",{class:!0});var ie=ce(t);n=ne(ie,"DIV",{class:!0});var Le=ce(n);r=ne(Le,"DIV",{class:!0});var Ie=ce(r);i=ne(Ie,"IMG",{src:!0,alt:!0,class:!0,style:!0}),l=Re(Ie),a=ne(Ie,"DIV",{class:!0,"data-svelte-h":!0}),Me(a)!=="svelte-8vajyo"&&(a.textContent=c),h=Re(Ie),up(u.$$.fragment,Ie),Ie.forEach(G),f=Re(Le),p=ne(Le,"DIV",{class:!0});var ze=ce(p);ue.l(ze),g=Re(ze),m=ne(ze,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),Me(m)!=="svelte-czbnmr"&&(m.innerHTML=k),L=Re(ze),T=ne(ze,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),Me(T)!=="svelte-g6lu7c"&&(T.innerHTML=M),b=Re(ze),w=ne(ze,"BUTTON",{class:!0,"data-svelte-h":!0}),Me(w)!=="svelte-2onzqt"&&(w.innerHTML=E),ze.forEach(G),Le.forEach(G),S=Re(ie),v=ne(ie,"DIV",{class:!0});var gt=ce(v);R=ne(gt,"DIV",{class:!0});var Ke=ce(R);he&&he.l(Ke),D=Re(Ke),C=ne(Ke,"DIV",{class:!0}),ce(C).forEach(G),Ke.forEach(G),gt.forEach(G),A=Re(ie),I=ne(ie,"DIV",{class:!0,style:!0});var pt=ce(I);fe&&fe.l(pt),B=Re(pt),ee&&ee.l(pt),pt.forEach(G),ie.forEach(G),this.h()},h(){sp(i.src,s="logo.png")||U(i,"src",s),U(i,"alt",""),U(i,"class","ml-4"),Rt(i,"width","30px"),U(a,"class","text-2xl font-bold p-4 pl-2"),U(r,"class","flex items-center"),U(m,"class","flex items-center px-2 py-1 gray-border svelte-8inrpd"),Rt(m,"border-style","dashed"),U(T,"class","flex items-center px-2 py-1 gray-border svelte-8inrpd"),Rt(T,"border-style","dashed"),U(w,"class","flex items-center rounded-full px-3 py-1 gray-border svelte-8inrpd"),U(p,"class","flex gap-4 items-center pr-2"),U(n,"class","navbar flex justify-between items-center svelte-8inrpd"),U(C,"class","w-full svelte-8inrpd"),Te(C,"h-full",e[7]),Te(C,"h-vh",!e[7]),U(R,"class","svelte-8inrpd"),Te(R,"editor-flex",e[7]),Te(R,"fake-window-header",e[7]),Te(R,"shadow-2xl",e[7]),Te(R,"w-full",!e[7]),U(v,"class","h-vh w-full flex flex-col justify-center items-center svelte-8inrpd"),Te(v,"flex-bg",e[7]),U(I,"class","footer w-full flex flex-col justify-end rounded-md svelte-8inrpd"),U(I,"style",V=e[5]?"height: 40vh;":""),U(t,"class","h-vh svelte-8inrpd")},m(q,ie){Ye(q,t,ie),Z(t,n),Z(n,r),Z(r,i),Z(r,l),Z(r,a),Z(r,h),fp(u,r,null),Z(n,f),Z(n,p),ue.m(p,null),Z(p,g),Z(p,m),Z(p,L),Z(p,T),Z(p,b),Z(p,w),Z(t,S),Z(t,v),Z(v,R),he&&he.m(R,null),Z(R,D),Z(R,C),e[16](C),Z(t,A),Z(t,I),fe&&fe.m(I,null),Z(I,B),ee&&ee.m(I,null),H=!0,K||(J=[$e(m,"click",e[14]),$e(T,"click",e[15]),$e(w,"click",np)],K=!0)},p(q,[ie]){F===(F=Q(q))&&ue?ue.p(q,ie):(ue.d(1),ue=F(q),ue&&(ue.c(),ue.m(p,g))),q[7]?he||(he=Vl(),he.c(),he.m(R,D)):he&&(he.d(1),he=null),(!H||ie&128)&&Te(C,"h-full",q[7]),(!H||ie&128)&&Te(C,"h-vh",!q[7]),(!H||ie&128)&&Te(R,"editor-flex",q[7]),(!H||ie&128)&&Te(R,"fake-window-header",q[7]),(!H||ie&128)&&Te(R,"shadow-2xl",q[7]),(!H||ie&128)&&Te(R,"w-full",!q[7]),(!H||ie&128)&&Te(v,"flex-bg",q[7]),q[5]?fe?fe.p(q,ie):(fe=ql(q),fe.c(),fe.m(I,B)):fe&&(fe.d(1),fe=null),q[7]?ee&&(ee.d(1),ee=null):ee?ee.p(q,ie):(ee=Zl(q),ee.c(),ee.m(I,null)),(!H||ie&32&&V!==(V=q[5]?"height: 40vh;":""))&&U(I,"style",V)},i(q){H||(gp(u.$$.fragment,q),H=!0)},o(q){pp(u.$$.fragment,q),H=!1},d(q){q&&G(t),_p(u),ue.d(),he&&he.d(),e[16](null),fe&&fe.d(),ee&&ee.d(),K=!1,Ds(J)}}}function np(){if(window.sidebar&&window.sidebar.addPanel)window.sidebar.addPanel(document.title,window.location.href,"");else if(window.external&&"AddFavorite"in window.external)window.external.AddFavorite(window.location.href,document.title);else if(window.opera&&window.print){var e=document.createElement("a");e.setAttribute("href",window.location.href),e.setAttribute("title","ErgoScript"),e.setAttribute("rel","sidebar"),e.click()}else alert("Your browser doesn't support adding bookmarks automatically. Please use Ctrl+D (Cmd+D on macOS) to add a bookmark manually.")}function rp(e,t,n){let r;Yl(e,hr,B=>n(23,r=B)),Gl.registerLanguage("scala",bp);let i,s,l,a=Ms.Mainnet,c="v1",h=!1,u="",f="",p="",g=!1;function m(){const B=s.getValue();try{n(4,u=Ep(B,a,c,h)),n(5,f="")}catch(V){n(4,u=""),n(5,f=V.message)}}op(async()=>{window.srust=wp,window.Address=yp,window.ErgoTree=Xl;const B=new URLSearchParams(window.location.search),V=B.get("l");if(self.MonacoEnvironment={getWorker(H,K){return new vp}},l=await ip(()=>import("../chunks/editor.main.87ee2f97.js"),["../chunks/editor.main.87ee2f97.js","../chunks/toggleHighContrast.492bfa7f.js","../chunks/preload-helper.a4192956.js","../assets/toggleHighContrast.a99fd1e1.css"],import.meta.url),s=l.editor.create(i,{value:`{
  proveDlog(CONTEXT.preHeader.minerPk)
}`,language:"scala",minimap:{enabled:!1},theme:"vs-dark",fontSize:16,automaticLayout:!0}),s.getModel().onDidChangeContent(H=>{if(r!="code")return;const K=s.getValue(),J=qg(K);let Q="";J.forEach(F=>{Q+=String.fromCharCode(F)}),window.history.replaceState(null,"","?s="+encodeURIComponent(btoa(Q)))}),V&&b(V),!V){const H=B.get("s");if(H){const K=atob(decodeURIComponent(H)),J=new Uint8Array(K.length);for(let ue=0;ue<K.length;ue++)J[ue]=K.charCodeAt(ue);const Q=Zg(J);let F="";Q.forEach(ue=>{F+=String.fromCharCode(ue)}),s.setValue(F)}}});let k=!1;function L(){k||(n(8,k=!0),setTimeout(()=>{n(8,k=!1)},3e3)),navigator.clipboard.writeText(u)}let T=!1;function M(){T||(n(9,T=!0),setTimeout(()=>{n(9,T=!1)},3e3)),navigator.clipboard.writeText(p)}function b(B,V=!1){const H=s.getValue();n(6,p=window.location.origin+"?l="+B);const K=new ln,J=new su(B,K),Q=K.getText("monaco");new cu(Q,s.getModel(),new Set([s]),J.awareness),V&&s.setValue(H),M()}const w=B=>[...Array(B)].map(()=>Math.floor(Math.random()*16).toString(16)).join("");function E(){const B=w(16);b(B,!0)}function S(){const B=Gl.highlight("scala",s.getValue()).value.replaceAll("{","&#123;").replaceAll("}","&#125;");navigator.clipboard.writeText(`
<style>
.hljs {
  color: #ddd;
}

.hljs-tag,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-strong,
.hljs-name {
  color: #f92672;
}

.hljs-code {
  color: #66d9ef;
}

.hljs-attribute,
.hljs-symbol,
.hljs-regexp,
.hljs-link {
  color: #bf79db;
}

.hljs-string,
.hljs-bullet,
.hljs-subst,
.hljs-title,
.hljs-section,
.hljs-emphasis,
.hljs-type,
.hljs-built_in,
.hljs-selector-attr,
.hljs-selector-pseudo,
.hljs-addition,
.hljs-variable,
.hljs-template-tag,
.hljs-template-variable {
  color: #a6e22e;
}

.hljs-title.class_,
.hljs-class .hljs-title {
  color: white;
}

.hljs-comment,
.hljs-quote,
.hljs-deletion,
.hljs-meta {
  color: #75715e;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-doctag,
.hljs-title,
.hljs-section,
.hljs-type,
.hljs-selector-id {
  font-weight: bold;
}

.ios-buttons {
    display: flex;
    gap: 5px;
    padding: 0.7em;
    padding-left: 1em;
}

.ios-button {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: #fff;
    cursor: pointer;
}

.ios-button.close {
    background-color: #ff3b30;
}

.ios-button.minimize {
    background-color: #ffcc00;
}

.ios-button.maximize {
    background-color: #4cd964;
}

.fake-window-header {
    border-top-left-radius: 6px;
    border-top-right-radius: 6px;
    position: sticky;
    top: 0;
    background-color: #1e1e1e;
    width:100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    color: gray;
    font-family: monospace;
}

.editor-flex {
    background: #1e1e1e;
    position: relative;
    height: 300px;
    width: 600px;
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
    overflow: scroll;
    resize: both;
    -webkit-box-shadow: 0px 0px 81px 5px rgba(0, 0, 0, 0.7);
    -moz-box-shadow: 0px 0px 81px 5px rgba(0, 0, 0, 0.7);
    box-shadow: 0px 0px 81px 5px rgba(0, 0, 0, 0.7);
}
.source-code{
    margin-left:16px;
}
</style>


<div class="editor-flex">
    <div class="fake-window-header">
                <div class="ios-buttons">
                    <div class="ios-button close" />
                    <div class="ios-button minimize" />
                    <div class="ios-button maximize" />
                </div>
                <div style="padding-right:8px;">ergoscript</div>
            </div>
            <div class="source-code">
                <pre><code class="hljs">${B}</code></pre>
            </div>   
    </div>
    `)}function v(){g?(n(7,g=!1),s.updateOptions({lineNumbers:"on"})):(n(7,g=!0),s.updateOptions({lineNumbers:"off"}))}let R="";hr.subscribe(B=>{if(B=="code"&&R!=""&&(s.setValue(R),s.updateOptions({readOnly:!1})),B=="tree"){s.updateOptions({readOnly:!0}),R=s.getValue();let V="";try{const H=kp(R,a,c);V=Xl.from_bytes(H).pretty_print()}catch(H){V=H.message}s.setValue(V)}});function D(B){hp[B?"unshift":"push"](()=>{i=B,n(0,i)})}function C(){c=Ns(this),n(2,c)}function A(){h=Ns(this),n(3,h)}function I(){a=Ns(this),n(1,a)}return[i,a,c,h,u,f,p,g,k,T,m,L,M,E,S,v,D,C,A,I]}Ql=class extends $l{constructor(e){super(),Jl(this,e,rp,tp,Kl,{})}}});export{Ap as __tla,Ql as component};
