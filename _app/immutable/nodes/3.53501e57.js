import{_ as ip}from"../chunks/preload-helper.a4192956.js";import{s as $l,e as ee,b as Ce,c as te,d as ce,D as Oe,h as Se,g as X,y as j,U as De,j as Xe,k as V,V as Qe,n as Ts,r as Ds,m as Yl,a1 as sp,z as xt,x as op,t as ap,f as lp,l as cp,_ as ii,Z as xn,H as Is,$ as Tn,B as hp,a0 as Ns,X as mt,Y as bt}from"../chunks/scheduler.a531a8fb.js";import{S as Kl,i as Jl,b as dp,d as up,m as fp,t as gp,a as pp,e as _p}from"../chunks/index.46f1c3f4.js";import{H as Gl,s as mp,N as Ls,a as bp,A as wp,E as Xl,W as yp,b as vp,c as kp,__tla as Ep}from"../chunks/scala.b8e93625.js";import{c as wt,g as Cp}from"../chunks/_commonjsHelpers.de833af9.js";import{R as Sp,S as Os,b as Ap,__tla as Rp}from"../chunks/toggleHighContrast.492bfa7f.js";import{s as dr}from"../chunks/store.845a9000.js";let Ql,xp=Promise.all([(()=>{try{return Ep}catch{}})(),(()=>{try{return Rp}catch{}})()]).then(async()=>{const et=()=>new Map,si=e=>{const t=et();return e.forEach((n,r)=>{t.set(r,n)}),t},qe=(e,t,n)=>{let r=e.get(t);return r===void 0&&e.set(t,r=n()),r},ec=(e,t)=>{const n=[];for(const[r,i]of e)n.push(t(i,r));return n},tc=(e,t)=>{for(const[n,r]of e)if(t(r,n))return!0;return!1},Bt=()=>new Set,oi=e=>e[e.length-1],nc=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},Tt=Array.from,rc=Array.isArray;class ur{constructor(){this._observers=et()}on(t,n){qe(this._observers,t,Bt).add(n)}once(t,n){const r=(...i)=>{this.off(t,r),n(...i)};this.on(t,r)}off(t,n){const r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return Tt((this._observers.get(t)||et()).values()).forEach(r=>r(...n))}destroy(){this._observers=et()}}const it=Math.floor,fr=Math.abs,ic=Math.log10,ai=(e,t)=>e<t?e:t,jt=(e,t)=>e>t?e:t,Ms=e=>e!==0?e<0:1/e<0,Us=1,Ps=2,li=4,ci=8,Dn=32,yt=64,Ze=128,gr=31,hi=63,Ft=127,sc=2147483647,zs=Number.MAX_SAFE_INTEGER,oc=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&it(e)===e),ac=String.fromCharCode,lc=e=>e.toLowerCase(),cc=/^\s*/g,hc=e=>e.replace(cc,""),dc=/([A-Z])/g,Bs=(e,t)=>hc(e.replace(dc,n=>`${t}${lc(n)}`)),uc=e=>{const t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=t.codePointAt(i);return r},In=typeof TextEncoder<"u"?new TextEncoder:null,fc=e=>In.encode(e),di=In?fc:uc;let Nn=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Nn&&Nn.decode(new Uint8Array).length===1&&(Nn=null);class Ln{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Ae=()=>new Ln,gc=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},me=e=>{const t=new Uint8Array(gc(e));let n=0;for(let r=0;r<e.bufs.length;r++){const i=e.bufs[r];t.set(i,n),n+=i.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},pc=(e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(jt(n,t)*2),e.cpos=0)},Re=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t},On=Re,Y=(e,t)=>{for(;t>Ft;)Re(e,Ze|Ft&t),t=it(t/128);Re(e,Ft&t)},ui=(e,t)=>{const n=Ms(t);for(n&&(t=-t),Re(e,(t>hi?Ze:0)|(n?yt:0)|hi&t),t=it(t/64);t>0;)Re(e,(t>Ft?Ze:0)|Ft&t),t=it(t/128)},fi=new Uint8Array(3e4),_c=fi.length/3,mc=(e,t)=>{if(t.length<_c){const n=In.encodeInto(t,fi).written||0;Y(e,n);for(let r=0;r<n;r++)Re(e,fi[r])}else be(e,di(t))},bc=(e,t)=>{const n=unescape(encodeURIComponent(t)),r=n.length;Y(e,r);for(let i=0;i<r;i++)Re(e,n.codePointAt(i))},st=In&&In.encodeInto?mc:bc,pr=(e,t)=>{const n=e.cbuf.length,r=e.cpos,i=ai(n-r,t.length),s=t.length-i;e.cbuf.set(t.subarray(0,i),r),e.cpos+=i,s>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(jt(n*2,s)),e.cbuf.set(t.subarray(i)),e.cpos=s)},be=(e,t)=>{Y(e,t.byteLength),pr(e,t)},gi=(e,t)=>{pc(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},wc=(e,t)=>gi(e,4).setFloat32(0,t,!1),yc=(e,t)=>gi(e,8).setFloat64(0,t,!1),vc=(e,t)=>gi(e,8).setBigInt64(0,t,!1),js=new DataView(new ArrayBuffer(4)),kc=e=>(js.setFloat32(0,e),js.getFloat32(0)===e),rn=(e,t)=>{switch(typeof t){case"string":Re(e,119),st(e,t);break;case"number":oc(t)&&fr(t)<=sc?(Re(e,125),ui(e,t)):kc(t)?(Re(e,124),wc(e,t)):(Re(e,123),yc(e,t));break;case"bigint":Re(e,122),vc(e,t);break;case"object":if(t===null)Re(e,126);else if(rc(t)){Re(e,117),Y(e,t.length);for(let n=0;n<t.length;n++)rn(e,t[n])}else if(t instanceof Uint8Array)Re(e,116),be(e,t);else{Re(e,118);const n=Object.keys(t);Y(e,n.length);for(let r=0;r<n.length;r++){const i=n[r];st(e,i),rn(e,t[i])}}break;case"boolean":Re(e,t?120:121);break;default:Re(e,127)}};class Fs extends Ln{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&Y(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const Hs=e=>{e.count>0&&(ui(e.encoder,e.count===1?e.s:-e.s),e.count>1&&Y(e.encoder,e.count-2))};class _r{constructor(){this.encoder=new Ln,this.s=0,this.count=0}write(t){this.s===t?this.count++:(Hs(this),this.count=1,this.s=t)}toUint8Array(){return Hs(this),me(this.encoder)}}const Zs=e=>{if(e.count>0){const t=e.diff*2+(e.count===1?0:1);ui(e.encoder,t),e.count>1&&Y(e.encoder,e.count-2)}};class pi{constructor(){this.encoder=new Ln,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(Zs(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return Zs(this),me(this.encoder)}}class Ec{constructor(){this.sarr=[],this.s="",this.lensE=new _r}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new Ln;return this.sarr.push(this.s),this.s="",st(t,this.sarr.join("")),pr(t,this.lensE.toUint8Array()),me(t)}}const ot=e=>new Error(e),at=()=>{throw ot("Method unimplemented")},$e=()=>{throw ot("Unexpected case")},Vs=ot("Unexpected end of array"),Ws=ot("Integer out of Range");class mr{constructor(t){this.arr=t,this.pos=0}}const lt=e=>new mr(e),Cc=e=>e.pos!==e.arr.length,Sc=(e,t)=>{const n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},xe=e=>Sc(e,Q(e)),Ht=e=>e.arr[e.pos++],Q=e=>{let t=0,n=1;const r=e.arr.length;for(;e.pos<r;){const i=e.arr[e.pos++];if(t=t+(i&Ft)*n,n*=128,i<Ze)return t;if(t>zs)throw Ws}throw Vs},_i=e=>{let t=e.arr[e.pos++],n=t&hi,r=64;const i=(t&yt)>0?-1:1;if(!(t&Ze))return i*n;const s=e.arr.length;for(;e.pos<s;){if(t=e.arr[e.pos++],n=n+(t&Ft)*r,r*=128,t<Ze)return i*n;if(n>zs)throw Ws}throw Vs},Ac=e=>{let t=Q(e);if(t===0)return"";{let n=String.fromCodePoint(Ht(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(Ht(e));else for(;t>0;){const r=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,i),t-=r}return decodeURIComponent(escape(n))}},Rc=e=>Nn.decode(xe(e)),vt=Nn?Rc:Ac,mi=(e,t)=>{const n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},xc=e=>mi(e,4).getFloat32(0,!1),Tc=e=>mi(e,8).getFloat64(0,!1),Dc=e=>mi(e,8).getBigInt64(0,!1),Ic=[e=>{},e=>null,_i,xc,Tc,Dc,e=>!1,e=>!0,vt,e=>{const t=Q(e),n={};for(let r=0;r<t;r++){const i=vt(e);n[i]=sn(e)}return n},e=>{const t=Q(e),n=[];for(let r=0;r<t;r++)n.push(sn(e));return n},xe],sn=e=>Ic[127-Ht(e)](e);class qs extends mr{constructor(t,n){super(t),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),Cc(this)?this.count=Q(this)+1:this.count=-1),this.count--,this.s}}class br extends mr{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=_i(this);const t=Ms(this.s);this.count=1,t&&(this.s=-this.s,this.count=Q(this)+2)}return this.count--,this.s}}class bi extends mr{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const t=_i(this),n=t&1;this.diff=it(t/2),this.count=1,n&&(this.count=Q(this)+2)}return this.s+=this.diff,this.count--,this.s}}class Nc{constructor(t){this.decoder=new br(t),this.str=vt(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),n=this.str.slice(this.spos,t);return this.spos=t,n}}const Lc=crypto.getRandomValues.bind(crypto),Oc=Math.random,$s=()=>Lc(new Uint32Array(1))[0],Mc=[1e7]+-1e3+-4e3+-8e3+-1e11,Ys=()=>Mc.replace(/[018]/g,e=>(e^$s()&15>>e/4).toString(16)),kt=Date.now,Ks=e=>new Promise(e);Promise.all.bind(Promise);const Uc=e=>Promise.reject(e),wi=e=>Promise.resolve(e),Pc=e=>e===void 0?null:e;class zc{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}}let Js=new zc,yi=!0;try{typeof localStorage<"u"&&localStorage&&(Js=localStorage,yi=!1)}catch{}const Gs=Js,Bc=e=>yi||addEventListener("storage",e),jc=e=>yi||removeEventListener("storage",e),Fc=Object.assign,Hc=Object.keys,Zc=(e,t)=>{for(const n in e)t(e[n],n)},wr=e=>Hc(e).length,Vc=e=>{for(const t in e)return!1;return!0},Wc=(e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0},Xs=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),qc=(e,t)=>e===t||wr(e)===wr(t)&&Wc(e,(n,r)=>(n!==void 0||Xs(t,r))&&t[r]===n),vi=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&vi(e,t,n+1)}},$c=()=>{},Yc=e=>e,Kc=(e,t)=>e===t,Mn=(e,t)=>{if(e==null||t==null)return Kc(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:{if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break}case Set:{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;break}case Map:{if(e.size!==t.size)return!1;for(const n of e.keys())if(!t.has(n)||!Mn(e.get(n),t.get(n)))return!1;break}case Object:if(wr(e)!==wr(t))return!1;for(const n in e)if(!Xs(e,n)||!Mn(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Mn(e[n],t[n]))return!1;break;default:return!1}return!0},Jc=(e,t)=>t.includes(e),on=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",Qs=typeof window<"u"&&typeof document<"u"&&!on;let ct;const Gc=()=>{if(ct===void 0)if(on){ct=et();const e=process.argv;let t=null;for(let n=0;n<e.length;n++){const r=e[n];r[0]==="-"?(t!==null&&ct.set(t,""),t=r):t!==null&&(ct.set(t,r),t=null)}t!==null&&ct.set(t,"")}else typeof location=="object"?(ct=et(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){const[t,n]=e.split("=");ct.set(`--${Bs(t,"-")}`,n),ct.set(`-${Bs(t,"-")}`,n)}})):ct=et();return ct},ki=e=>Gc().has(e),yr=e=>Pc(on?process.env[e.toUpperCase()]:Gs.getItem(e));(e=>ki("--"+e)||yr(e)!==null)("production");const eo=on&&Jc({}.FORCE_COLOR,["true","1","2"]),Xc=!ki("no-colors")&&(!on||process.stdout.isTTY||eo)&&(!on||ki("color")||eo||yr("COLORTERM")!==null||(yr("TERM")||"").includes("color")),to=e=>new Uint8Array(e),Qc=(e,t,n)=>new Uint8Array(e,t,n),eh=e=>new Uint8Array(e),th=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=ac(e[n]);return btoa(t)},nh=e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),rh=e=>{const t=atob(e),n=to(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},ih=e=>{const t=Buffer.from(e,"base64");return Qc(t.buffer,t.byteOffset,t.byteLength)},no=Qs?th:nh,ro=Qs?rh:ih,sh=e=>{const t=to(e.byteLength);return t.set(e),t};class oh{constructor(t,n){this.left=t,this.right=n}}const Et=(e,t)=>new oh(e,t);typeof DOMParser<"u"&&new DOMParser;const ah=e=>ec(e,(t,n)=>`${n}:${t};`).join(""),Ct=Symbol,Ye=Ct(),Zt=Ct(),io=Ct(),Ei=Ct(),so=Ct(),oo=Ct(),ao=Ct(),Ci=Ct(),vr=Ct(),lh=e=>{const t=[];let n=0;for(;n<e.length;n++){const r=e[n];r.constructor===String||r.constructor===Number||r.constructor===Object&&t.push(JSON.stringify(r))}return t},lo=[so,ao,Ci,io];let Si=0,co=kt();const ch=(e,t)=>{const n=lo[Si],r=yr("log"),i=r!==null&&(r==="*"||r==="true"||new RegExp(r,"gi").test(t));return Si=(Si+1)%lo.length,t+=": ",i?(...s)=>{const l=kt(),a=l-co;co=l,e(n,t,vr,...s.map(c=>typeof c=="string"||typeof c=="symbol"?c:JSON.stringify(c)),n," +"+a+"ms")}:$c},hh={[Ye]:Et("font-weight","bold"),[Zt]:Et("font-weight","normal"),[io]:Et("color","blue"),[so]:Et("color","green"),[Ei]:Et("color","grey"),[oo]:Et("color","red"),[ao]:Et("color","purple"),[Ci]:Et("color","orange"),[vr]:Et("color","black")},dh=e=>{const t=[],n=[],r=et();let i=[],s=0;for(;s<e.length;s++){const l=e[s],a=hh[l];if(a!==void 0)r.set(a.left,a.right);else if(l.constructor===String||l.constructor===Number){const c=ah(r);s>0||c.length>0?(t.push("%c"+l),n.push(c)):t.push(l)}else break}for(s>0&&(i=n,i.unshift(t.join("")));s<e.length;s++){const l=e[s];l instanceof Symbol||i.push(l)}return i},uh=Xc?dh:lh,ho=(...e)=>{console.log(...uh(e)),fh.forEach(t=>t.print(e))},fh=Bt(),gh=e=>ch(ho,e),uo=e=>({[Symbol.iterator](){return this},next:e}),ph=(e,t)=>uo(()=>{let n;do n=e.next();while(!n.done&&!t(n.value));return n}),Ai=(e,t)=>uo(()=>{const{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}});class Ri{constructor(t,n){this.clock=t,this.len=n}}class Un{constructor(){this.clients=new Map}}const fo=(e,t,n)=>t.clients.forEach((r,i)=>{const s=e.doc.store.clients.get(i);for(let l=0;l<r.length;l++){const a=r[l];No(e,s,a.clock,a.len,n)}}),_h=(e,t)=>{let n=0,r=e.length-1;for(;n<=r;){const i=it((n+r)/2),s=e[i],l=s.clock;if(l<=t){if(t<l+s.len)return i;n=i+1}else r=i-1}return null},go=(e,t)=>{const n=e.clients.get(t.client);return n!==void 0&&_h(n,t.clock)!==null},xi=e=>{e.clients.forEach(t=>{t.sort((i,s)=>i.clock-s.clock);let n,r;for(n=1,r=1;n<t.length;n++){const i=t[r-1],s=t[n];i.clock+i.len>=s.clock?i.len=jt(i.len,s.clock+s.len-i.clock):(r<n&&(t[r]=s),r++)}t.length=r})},mh=e=>{const t=new Un;for(let n=0;n<e.length;n++)e[n].clients.forEach((r,i)=>{if(!t.clients.has(i)){const s=r.slice();for(let l=n+1;l<e.length;l++)nc(s,e[l].clients.get(i)||[]);t.clients.set(i,s)}});return xi(t),t},kr=(e,t,n,r)=>{qe(e.clients,t,()=>[]).push(new Ri(n,r))},bh=()=>new Un,wh=e=>{const t=bh();return e.clients.forEach((n,r)=>{const i=[];for(let s=0;s<n.length;s++){const l=n[s];if(l.deleted){const a=l.id.clock;let c=l.length;if(s+1<n.length)for(let h=n[s+1];s+1<n.length&&h.deleted;h=n[++s+1])c+=h.length;i.push(new Ri(a,c))}}i.length>0&&t.clients.set(r,i)}),t},an=(e,t)=>{Y(e.restEncoder,t.clients.size),Tt(t.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{e.resetDsCurVal(),Y(e.restEncoder,n);const i=r.length;Y(e.restEncoder,i);for(let s=0;s<i;s++){const l=r[s];e.writeDsClock(l.clock),e.writeDsLen(l.len)}})},Ti=e=>{const t=new Un,n=Q(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();const i=Q(e.restDecoder),s=Q(e.restDecoder);if(s>0){const l=qe(t.clients,i,()=>[]);for(let a=0;a<s;a++)l.push(new Ri(e.readDsClock(),e.readDsLen()))}}return t},po=(e,t,n)=>{const r=new Un,i=Q(e.restDecoder);for(let s=0;s<i;s++){e.resetDsCurVal();const l=Q(e.restDecoder),a=Q(e.restDecoder),c=n.clients.get(l)||[],h=ye(n,l);for(let u=0;u<a;u++){const f=e.readDsClock(),p=f+e.readDsLen();if(f<h){h<p&&kr(r,l,h,p-h);let g=ht(c,f),b=c[g];for(!b.deleted&&b.id.clock<f&&(c.splice(g+1,0,Fr(t,b,f-b.id.clock)),g++);g<c.length&&(b=c[g++],b.id.clock<p);)b.deleted||(p<b.id.clock+b.length&&c.splice(g,0,Fr(t,b,p-b.id.clock)),b.delete(t))}else kr(r,l,f,p-f)}}if(r.clients.size>0){const s=new Vt;return Y(s.restEncoder,0),an(s,r),s.toUint8Array()}return null},_o=$s;class ln extends ur{constructor({guid:t=Ys(),collectionid:n=null,gc:r=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:l=!1,shouldLoad:a=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=_o(),this.guid=t,this.collectionid=n,this.share=new Map,this.store=new To,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=l,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=Ks(h=>{this.on("load",()=>{this.isLoaded=!0,h(this)})});const c=()=>Ks(h=>{const u=f=>{(f===void 0||f===!0)&&(this.off("sync",u),h())};this.on("sync",u)});this.on("sync",h=>{h===!1&&this.isSynced&&(this.whenSynced=c()),this.isSynced=h===void 0||h===!0,this.isLoaded||this.emit("load",[])}),this.whenSynced=c()}load(){const t=this._item;t!==null&&!this.shouldLoad&&ge(t.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Tt(this.subdocs).map(t=>t.guid))}transact(t,n=null){return ge(this,t,n)}get(t,n=Ie){const r=qe(this.share,t,()=>{const s=new n;return s._integrate(this,null),s}),i=r.constructor;if(n!==Ie&&i!==n)if(i===Ie){const s=new n;s._map=r._map,r._map.forEach(l=>{for(;l!==null;l=l.left)l.parent=s}),s._start=r._start;for(let l=s._start;l!==null;l=l.right)l.parent=s;return s._length=r._length,this.share.set(t,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return r}getArray(t=""){return this.get(t,dn)}getText(t=""){return this.get(t,gn)}getMap(t=""){return this.get(t,un)}getXmlFragment(t=""){return this.get(t,Wt)}toJSON(){const t={};return this.share.forEach((n,r)=>{t[r]=n.toJSON()}),t}destroy(){Tt(this.subdocs).forEach(n=>n.destroy());const t=this._item;if(t!==null){this._item=null;const n=t.content;n.doc=new ln({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=t,ge(t.parent.doc,r=>{const i=n.doc;t.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,n){super.on(t,n)}off(t,n){super.off(t,n)}}class mo{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return Q(this.restDecoder)}readDsLen(){return Q(this.restDecoder)}}class bo extends mo{readLeftID(){return re(Q(this.restDecoder),Q(this.restDecoder))}readRightID(){return re(Q(this.restDecoder),Q(this.restDecoder))}readClient(){return Q(this.restDecoder)}readInfo(){return Ht(this.restDecoder)}readString(){return vt(this.restDecoder)}readParentInfo(){return Q(this.restDecoder)===1}readTypeRef(){return Q(this.restDecoder)}readLen(){return Q(this.restDecoder)}readAny(){return sn(this.restDecoder)}readBuf(){return sh(xe(this.restDecoder))}readJSON(){return JSON.parse(vt(this.restDecoder))}readKey(){return vt(this.restDecoder)}}class yh{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Q(this.restDecoder),this.dsCurrVal}readDsLen(){const t=Q(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class cn extends yh{constructor(t){super(t),this.keys=[],Q(t),this.keyClockDecoder=new bi(xe(t)),this.clientDecoder=new br(xe(t)),this.leftClockDecoder=new bi(xe(t)),this.rightClockDecoder=new bi(xe(t)),this.infoDecoder=new qs(xe(t),Ht),this.stringDecoder=new Nc(xe(t)),this.parentInfoDecoder=new qs(xe(t),Ht),this.typeRefDecoder=new br(xe(t)),this.lenDecoder=new br(xe(t))}readLeftID(){return new hn(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new hn(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return sn(this.restDecoder)}readBuf(){return xe(this.restDecoder)}readJSON(){return sn(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class wo{constructor(){this.restEncoder=Ae()}toUint8Array(){return me(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){Y(this.restEncoder,t)}writeDsLen(t){Y(this.restEncoder,t)}}class Pn extends wo{writeLeftID(t){Y(this.restEncoder,t.client),Y(this.restEncoder,t.clock)}writeRightID(t){Y(this.restEncoder,t.client),Y(this.restEncoder,t.clock)}writeClient(t){Y(this.restEncoder,t)}writeInfo(t){On(this.restEncoder,t)}writeString(t){st(this.restEncoder,t)}writeParentInfo(t){Y(this.restEncoder,t?1:0)}writeTypeRef(t){Y(this.restEncoder,t)}writeLen(t){Y(this.restEncoder,t)}writeAny(t){rn(this.restEncoder,t)}writeBuf(t){be(this.restEncoder,t)}writeJSON(t){st(this.restEncoder,JSON.stringify(t))}writeKey(t){st(this.restEncoder,t)}}class yo{constructor(){this.restEncoder=Ae(),this.dsCurrVal=0}toUint8Array(){return me(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const n=t-this.dsCurrVal;this.dsCurrVal=t,Y(this.restEncoder,n)}writeDsLen(t){t===0&&$e(),Y(this.restEncoder,t-1),this.dsCurrVal+=t}}class Vt extends yo{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new pi,this.clientEncoder=new _r,this.leftClockEncoder=new pi,this.rightClockEncoder=new pi,this.infoEncoder=new Fs(On),this.stringEncoder=new Ec,this.parentInfoEncoder=new Fs(On),this.typeRefEncoder=new _r,this.lenEncoder=new _r}toUint8Array(){const t=Ae();return Y(t,0),be(t,this.keyClockEncoder.toUint8Array()),be(t,this.clientEncoder.toUint8Array()),be(t,this.leftClockEncoder.toUint8Array()),be(t,this.rightClockEncoder.toUint8Array()),be(t,me(this.infoEncoder)),be(t,this.stringEncoder.toUint8Array()),be(t,me(this.parentInfoEncoder)),be(t,this.typeRefEncoder.toUint8Array()),be(t,this.lenEncoder.toUint8Array()),pr(t,me(this.restEncoder)),me(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){rn(this.restEncoder,t)}writeBuf(t){be(this.restEncoder,t)}writeJSON(t){rn(this.restEncoder,t)}writeKey(t){const n=this.keyMap.get(t);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(n)}}const vh=(e,t,n,r)=>{r=jt(r,t[0].id.clock);const i=ht(t,r);Y(e.restEncoder,t.length-i),e.writeClient(n),Y(e.restEncoder,r);const s=t[i];s.write(e,r-s.id.clock);for(let l=i+1;l<t.length;l++)t[l].write(e,0)},Di=(e,t,n)=>{const r=new Map;n.forEach((i,s)=>{ye(t,s)>i&&r.set(s,i)}),Rr(t).forEach((i,s)=>{n.has(s)||r.set(s,0)}),Y(e.restEncoder,r.size),Tt(r.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{vh(e,t.clients.get(i),i,s)})},kh=(e,t)=>{const n=et(),r=Q(e.restDecoder);for(let i=0;i<r;i++){const s=Q(e.restDecoder),l=new Array(s),a=e.readClient();let c=Q(e.restDecoder);n.set(a,{i:0,refs:l});for(let h=0;h<s;h++){const u=e.readInfo();switch(gr&u){case 0:{const f=e.readLen();l[h]=new Ke(re(a,c),f),c+=f;break}case 10:{const f=Q(e.restDecoder);l[h]=new Je(re(a,c),f),c+=f;break}default:{const f=(u&(yt|Ze))===0,p=new we(re(a,c),null,(u&Ze)===Ze?e.readLeftID():null,null,(u&yt)===yt?e.readRightID():null,f?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,f&&(u&Dn)===Dn?e.readString():null,ia(e,u));l[h]=p,c+=p.length}}}}return n},Eh=(e,t,n)=>{const r=[];let i=Tt(n.keys()).sort((g,b)=>g-b);if(i.length===0)return null;const s=()=>{if(i.length===0)return null;let g=n.get(i[i.length-1]);for(;g.refs.length===g.i;)if(i.pop(),i.length>0)g=n.get(i[i.length-1]);else return null;return g};let l=s();if(l===null&&r.length===0)return null;const a=new To,c=new Map,h=(g,b)=>{const v=c.get(g);(v==null||v>b)&&c.set(g,b)};let u=l.refs[l.i++];const f=new Map,p=()=>{for(const g of r){const b=g.id.client,v=n.get(b);v?(v.i--,a.clients.set(b,v.refs.slice(v.i)),n.delete(b),v.i=0,v.refs=[]):a.clients.set(b,[g]),i=i.filter(D=>D!==b)}r.length=0};for(;;){if(u.constructor!==Je){const g=qe(f,u.id.client,()=>ye(t,u.id.client))-u.id.clock;if(g<0)r.push(u),h(u.id.client,u.id.clock-1),p();else{const b=u.getMissing(e,t);if(b!==null){r.push(u);const v=n.get(b)||{refs:[],i:0};if(v.refs.length===v.i)h(b,ye(t,b)),p();else{u=v.refs[v.i++];continue}}else(g===0||g<u.length)&&(u.integrate(e,g),f.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(l!==null&&l.i<l.refs.length)u=l.refs[l.i++];else{if(l=s(),l===null)break;u=l.refs[l.i++]}}if(a.clients.size>0){const g=new Vt;return Di(g,a,new Map),Y(g.restEncoder,0),{missing:c,update:g.toUint8Array()}}return null},Ch=(e,t)=>Di(e,t.doc.store,t.beforeState),Sh=(e,t,n,r=new cn(e))=>ge(t,i=>{i.local=!1;let s=!1;const l=i.doc,a=l.store,c=kh(r,l),h=Eh(i,a,c),u=a.pendingStructs;if(u){for(const[p,g]of u.missing)if(g<ye(a,p)){s=!0;break}if(h){for(const[p,g]of h.missing){const b=u.missing.get(p);(b==null||b>g)&&u.missing.set(p,g)}u.update=Dr([u.update,h.update])}}else a.pendingStructs=h;const f=po(r,i,a);if(a.pendingDs){const p=new cn(lt(a.pendingDs));Q(p.restDecoder);const g=po(p,i,a);f&&g?a.pendingDs=Dr([f,g]):a.pendingDs=f||g}else a.pendingDs=f;if(s){const p=a.pendingStructs.update;a.pendingStructs=null,vo(i.doc,p)}},n,!1),vo=(e,t,n,r=cn)=>{const i=lt(t);Sh(i,e,n,new r(i))},Ah=(e,t,n)=>vo(e,t,n,bo),Rh=(e,t,n=new Map)=>{Di(e,t.store,n),an(e,wh(t.store))},xh=(e,t=new Uint8Array([0]),n=new Vt)=>{const r=ko(t);Rh(n,e,r);const i=[n.toUint8Array()];if(e.store.pendingDs&&i.push(e.store.pendingDs),e.store.pendingStructs&&i.push(qh(e.store.pendingStructs.update,t)),i.length>1){if(n.constructor===Pn)return Vh(i.map((s,l)=>l===0?s:Yh(s)));if(n.constructor===Vt)return Dr(i)}return i[0]},Th=(e,t)=>xh(e,t,new Pn),Dh=e=>{const t=new Map,n=Q(e.restDecoder);for(let r=0;r<n;r++){const i=Q(e.restDecoder),s=Q(e.restDecoder);t.set(i,s)}return t},ko=e=>Dh(new mo(lt(e))),Eo=(e,t)=>(Y(e.restEncoder,t.size),Tt(t.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{Y(e.restEncoder,n),Y(e.restEncoder,r)}),e),Ih=(e,t)=>Eo(e,Rr(t.store)),Nh=(e,t=new yo)=>(e instanceof Map?Eo(t,e):Ih(t,e),t.toUint8Array()),Lh=e=>Nh(e,new wo);class Oh{constructor(){this.l=[]}}const Co=()=>new Oh,So=(e,t)=>e.l.push(t),Ao=(e,t)=>{const n=e.l,r=n.length;e.l=n.filter(i=>t!==i),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Ro=(e,t,n)=>vi(e.l,[t,n]);class hn{constructor(t,n){this.client=t,this.clock=n}}const Er=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,re=(e,t)=>new hn(e,t),xo=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw $e()};class Mh{constructor(t,n,r,i=0){this.type=t,this.tname=n,this.item=r,this.assoc=i}}class Uh{constructor(t,n,r=0){this.type=t,this.index=n,this.assoc=r}}const Ph=(e,t,n=0)=>new Uh(e,t,n),Cr=(e,t,n)=>{let r=null,i=null;return e._item===null?i=xo(e):r=re(e._item.id.client,e._item.id.clock),new Mh(r,i,t,n)},Sr=(e,t,n=0)=>{let r=e._start;if(n<0){if(t===0)return Cr(e,null,n);t--}for(;r!==null;){if(!r.deleted&&r.countable){if(r.length>t)return Cr(e,re(r.id.client,r.id.clock+t),n);t-=r.length}if(r.right===null&&n<0)return Cr(e,r.lastId,n);r=r.right}return Cr(e,null,n)},Ar=(e,t)=>{const n=t.store,r=e.item,i=e.type,s=e.tname,l=e.assoc;let a=null,c=0;if(r!==null){if(ye(n,r.client)<=r.clock)return null;const h=ra(n,r),u=h.item;if(!(u instanceof we))return null;if(a=u.parent,a._item===null||!a._item.deleted){c=u.deleted||!u.countable?0:h.diff+(l>=0?0:1);let f=u.left;for(;f!==null;)!f.deleted&&f.countable&&(c+=f.length),f=f.left}}else{if(s!==null)a=t.get(s);else if(i!==null){if(ye(n,i.client)<=i.clock)return null;const{item:h}=ra(n,i);if(h instanceof we&&h.content instanceof ut)a=h.content.type;else return null}else throw $e();l>=0?c=a._length:c=0}return Ph(a,c,e.assoc)},zn=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!go(t.ds,e.id),Ii=(e,t)=>{const n=qe(e.meta,Ii,Bt),r=e.doc.store;n.has(t)||(t.sv.forEach((i,s)=>{i<ye(r,s)&&Dt(e,re(s,i))}),fo(e,t.ds,i=>{}),n.add(t))};class To{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Rr=e=>{const t=new Map;return e.clients.forEach((n,r)=>{const i=n[n.length-1];t.set(r,i.id.clock+i.length)}),t},ye=(e,t)=>{const n=e.clients.get(t);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},Do=(e,t)=>{let n=e.clients.get(t.id.client);if(n===void 0)n=[],e.clients.set(t.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==t.id.clock)throw $e()}n.push(t)},ht=(e,t)=>{let n=0,r=e.length-1,i=e[r],s=i.id.clock;if(s===t)return r;let l=it(t/(s+i.length-1)*r);for(;n<=r;){if(i=e[l],s=i.id.clock,s<=t){if(t<s+i.length)return l;n=l+1}else r=l-1;l=it((n+r)/2)}throw $e()},zh=(e,t)=>{const n=e.clients.get(t.client);return n[ht(n,t.clock)]},xr=zh,Ni=(e,t,n)=>{const r=ht(t,n),i=t[r];return i.id.clock<n&&i instanceof we?(t.splice(r+1,0,Fr(e,i,n-i.id.clock)),r+1):r},Dt=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[Ni(e,n,t.clock)]},Io=(e,t,n)=>{const r=t.clients.get(n.client),i=ht(r,n.clock),s=r[i];return n.clock!==s.id.clock+s.length-1&&s.constructor!==Ke&&r.splice(i+1,0,Fr(e,s,n.clock-s.id.clock+1)),s},Bh=(e,t,n)=>{const r=e.clients.get(t.id.client);r[ht(r,t.id.clock)]=n},No=(e,t,n,r,i)=>{if(r===0)return;const s=n+r;let l=Ni(e,t,n),a;do a=t[l++],s<a.id.clock+a.length&&Ni(e,t,s),i(a);while(l<t.length&&t[l].id.clock<s)};class jh{constructor(t,n,r){this.doc=t,this.deleteSet=new Un,this.beforeState=Rr(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const Lo=(e,t)=>t.deleteSet.clients.size===0&&!tc(t.afterState,(n,r)=>t.beforeState.get(r)!==n)?!1:(xi(t.deleteSet),Ch(e,t),an(e,t.deleteSet),!0),Oo=(e,t,n)=>{const r=t._item;(r===null||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&qe(e.changed,t,Bt).add(n)},Tr=(e,t)=>{let n=e[t],r=e[t-1],i=t;for(;i>0;n=r,r=e[--i-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof we&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const s=t-i;return s&&e.splice(t+1-s,s),s},Fh=(e,t,n)=>{for(const[r,i]of e.clients.entries()){const s=t.clients.get(r);for(let l=i.length-1;l>=0;l--){const a=i[l],c=a.clock+a.len;for(let h=ht(s,a.clock),u=s[h];h<s.length&&u.id.clock<c;u=s[++h]){const f=s[h];if(a.clock+a.len<=f.id.clock)break;f instanceof we&&f.deleted&&!f.keep&&n(f)&&f.gc(t,!1)}}}},Hh=(e,t)=>{e.clients.forEach((n,r)=>{const i=t.clients.get(r);for(let s=n.length-1;s>=0;s--){const l=n[s],a=ai(i.length-1,1+ht(i,l.clock+l.len-1));for(let c=a,h=i[c];c>0&&h.id.clock>=l.clock;h=i[c])c-=1+Tr(i,c)}})},Mo=(e,t)=>{if(t<e.length){const n=e[t],r=n.doc,i=r.store,s=n.deleteSet,l=n._mergeStructs;try{xi(s),n.afterState=Rr(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const a=[];n.changed.forEach((c,h)=>a.push(()=>{(h._item===null||!h._item.deleted)&&h._callObserver(n,c)})),a.push(()=>{n.changedParentTypes.forEach((c,h)=>{h._dEH.l.length>0&&(h._item===null||!h._item.deleted)&&(c=c.filter(u=>u.target._item===null||!u.target._item.deleted),c.forEach(u=>{u.currentTarget=h,u._path=null}),c.sort((u,f)=>u.path.length-f.path.length),Ro(h._dEH,c,n))})}),a.push(()=>r.emit("afterTransaction",[n,r])),vi(a,[]),n._needFormattingCleanup&&ad(n)}finally{r.gc&&Fh(s,i,r.gcFilter),Hh(s,i),n.afterState.forEach((u,f)=>{const p=n.beforeState.get(f)||0;if(p!==u){const g=i.clients.get(f),b=jt(ht(g,p),1);for(let v=g.length-1;v>=b;)v-=1+Tr(g,v)}});for(let u=l.length-1;u>=0;u--){const{client:f,clock:p}=l[u].id,g=i.clients.get(f),b=ht(g,p);b+1<g.length&&Tr(g,b+1)>1||b>0&&Tr(g,b)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(ho(Ci,Ye,"[yjs] ",Zt,oo,"Changed the client-id because another client seems to be using it."),r.clientID=_o()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const u=new Pn;Lo(u,n)&&r.emit("update",[u.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const u=new Vt;Lo(u,n)&&r.emit("updateV2",[u.toUint8Array(),n.origin,r,n])}const{subdocsAdded:a,subdocsLoaded:c,subdocsRemoved:h}=n;(a.size>0||h.size>0||c.size>0)&&(a.forEach(u=>{u.clientID=r.clientID,u.collectionid==null&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),h.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:c,added:a,removed:h},r,n]),h.forEach(u=>u.destroy())),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):Mo(e,t+1)}}},ge=(e,t,n=null,r=!0)=>{const i=e._transactionCleanups;let s=!1,l=null;e._transaction===null&&(s=!0,e._transaction=new jh(e,n,r),i.push(e._transaction),i.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{l=t(e._transaction)}finally{if(s){const a=e._transaction===i[0];e._transaction=null,a&&Mo(i,0)}}return l};function*Zh(e){const t=Q(e.restDecoder);for(let n=0;n<t;n++){const r=Q(e.restDecoder),i=e.readClient();let s=Q(e.restDecoder);for(let l=0;l<r;l++){const a=e.readInfo();if(a===10){const c=Q(e.restDecoder);yield new Je(re(i,s),c),s+=c}else if(gr&a){const c=(a&(yt|Ze))===0,h=new we(re(i,s),null,(a&Ze)===Ze?e.readLeftID():null,null,(a&yt)===yt?e.readRightID():null,c?e.readParentInfo()?e.readString():e.readLeftID():null,c&&(a&Dn)===Dn?e.readString():null,ia(e,a));yield h,s+=h.length}else{const c=e.readLen();yield new Ke(re(i,s),c),s+=c}}}}class Li{constructor(t,n){this.gen=Zh(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Je);return this.curr}}class Oi{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const Vh=e=>Dr(e,bo,Pn),Wh=(e,t)=>{if(e.constructor===Ke){const{client:n,clock:r}=e.id;return new Ke(re(n,r+t),e.length-t)}else if(e.constructor===Je){const{client:n,clock:r}=e.id;return new Je(re(n,r+t),e.length-t)}else{const n=e,{client:r,clock:i}=n.id;return new we(re(r,i+t),null,re(r,i+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},Dr=(e,t=cn,n=Vt)=>{if(e.length===1)return e[0];const r=e.map(u=>new t(lt(u)));let i=r.map(u=>new Li(u,!0)),s=null;const l=new n,a=new Oi(l);for(;i=i.filter(u=>u.curr!==null),i.sort((u,f)=>{if(u.curr.id.client===f.curr.id.client){const p=u.curr.id.clock-f.curr.id.clock;return p===0?u.curr.constructor===f.curr.constructor?0:u.curr.constructor===Je?1:-1:p}else return f.curr.id.client-u.curr.id.client}),i.length!==0;){const u=i[0],f=u.curr.id.client;if(s!==null){let p=u.curr,g=!1;for(;p!==null&&p.id.clock+p.length<=s.struct.id.clock+s.struct.length&&p.id.client>=s.struct.id.client;)p=u.next(),g=!0;if(p===null||p.id.client!==f||g&&p.id.clock>s.struct.id.clock+s.struct.length)continue;if(f!==s.struct.id.client)It(a,s.struct,s.offset),s={struct:p,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<p.id.clock)if(s.struct.constructor===Je)s.struct.length=p.id.clock+p.length-s.struct.id.clock;else{It(a,s.struct,s.offset);const b=p.id.clock-s.struct.id.clock-s.struct.length;s={struct:new Je(re(f,s.struct.id.clock+s.struct.length),b),offset:0}}else{const b=s.struct.id.clock+s.struct.length-p.id.clock;b>0&&(s.struct.constructor===Je?s.struct.length-=b:p=Wh(p,b)),s.struct.mergeWith(p)||(It(a,s.struct,s.offset),s={struct:p,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let p=u.curr;p!==null&&p.id.client===f&&p.id.clock===s.struct.id.clock+s.struct.length&&p.constructor!==Je;p=u.next())It(a,s.struct,s.offset),s={struct:p,offset:0}}s!==null&&(It(a,s.struct,s.offset),s=null),Mi(a);const c=r.map(u=>Ti(u)),h=mh(c);return an(l,h),l.toUint8Array()},qh=(e,t,n=cn,r=Vt)=>{const i=ko(t),s=new r,l=new Oi(s),a=new n(lt(e)),c=new Li(a,!1);for(;c.curr;){const u=c.curr,f=u.id.client,p=i.get(f)||0;if(c.curr.constructor===Je){c.next();continue}if(u.id.clock+u.length>p)for(It(l,u,jt(p-u.id.clock,0)),c.next();c.curr&&c.curr.id.client===f;)It(l,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===f&&c.curr.id.clock+c.curr.length<=p;)c.next()}Mi(l);const h=Ti(a);return an(s,h),s.toUint8Array()},Uo=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:me(e.encoder.restEncoder)}),e.encoder.restEncoder=Ae(),e.written=0)},It=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&Uo(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),Y(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},Mi=e=>{Uo(e);const t=e.encoder.restEncoder;Y(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const r=e.clientStructs[n];Y(t,r.written),pr(t,r.restEncoder)}},$h=(e,t,n,r)=>{const i=new n(lt(e)),s=new Li(i,!1),l=new r,a=new Oi(l);for(let h=s.curr;h!==null;h=s.next())It(a,t(h),0);Mi(a);const c=Ti(i);return an(l,c),l.toUint8Array()},Yh=e=>$h(e,Yc,cn,Pn),Po="You must not compute changes after the event-handler fired.";class Ir{constructor(t,n){this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Kh(this.currentTarget,this.target))}deletes(t){return go(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw ot(Po);const t=new Map,n=this.target;this.transaction.changed.get(n).forEach(r=>{if(r!==null){const i=n._map.get(r);let s,l;if(this.adds(i)){let a=i.left;for(;a!==null&&this.adds(a);)a=a.left;if(this.deletes(i))if(a!==null&&this.deletes(a))s="delete",l=oi(a.content.getContent());else return;else a!==null&&this.deletes(a)?(s="update",l=oi(a.content.getContent())):(s="add",l=void 0)}else if(this.deletes(i))s="delete",l=oi(i.content.getContent());else return;t.set(r,{action:s,oldValue:l})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw ot(Po);const n=this.target,r=Bt(),i=Bt(),s=[];if(t={added:r,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(n).has(null)){let l=null;const a=()=>{l&&s.push(l)};for(let c=n._start;c!==null;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&((l===null||l.delete===void 0)&&(a(),l={delete:0}),l.delete+=c.length,i.add(c)):this.adds(c)?((l===null||l.insert===void 0)&&(a(),l={insert:[]}),l.insert=l.insert.concat(c.content.getContent()),r.add(c)):((l===null||l.retain===void 0)&&(a(),l={retain:0}),l.retain+=c.length);l!==null&&l.retain===void 0&&a()}this._changes=t}return t}}const Kh=(e,t)=>{const n=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)n.unshift(t._item.parentSub);else{let r=0,i=t._item.parent._start;for(;i!==t._item&&i!==null;)i.deleted||r++,i=i.right;n.unshift(r)}t=t._item.parent}return n},zo=80;let Ui=0;class Jh{constructor(t,n){t.marker=!0,this.p=t,this.index=n,this.timestamp=Ui++}}const Gh=e=>{e.timestamp=Ui++},Bo=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=Ui++},Xh=(e,t,n)=>{if(e.length>=zo){const r=e.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return Bo(r,t,n),r}else{const r=new Jh(t,n);return e.push(r),r}},Nr=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;const n=e._searchMarker.length===0?null:e._searchMarker.reduce((s,l)=>fr(t-s.index)<fr(t-l.index)?s:l);let r=e._start,i=0;for(n!==null&&(r=n.p,i=n.index,Gh(n));r.right!==null&&i<t;){if(!r.deleted&&r.countable){if(t<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>t;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return n!==null&&fr(n.index-i)<r.parent.length/zo?(Bo(n,r,i),n):Xh(e._searchMarker,r,i)},Bn=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){const i=e[r];if(n>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){e.splice(r,1);continue}i.p=s,s.marker=!0}(t<i.index||n>0&&t===i.index)&&(i.index=jt(t,i.index+n))}},Lr=(e,t,n)=>{const r=e,i=t.changedParentTypes;for(;qe(i,e,()=>[]).push(n),e._item!==null;)e=e._item.parent;Ro(r._eH,n,t)};class Ie{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Co(),this._dEH=Co(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,n){this.doc=t,this._item=n}_copy(){throw at()}clone(){throw at()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,n){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){So(this._eH,t)}observeDeep(t){So(this._dEH,t)}unobserve(t){Ao(this._eH,t)}unobserveDeep(t){Ao(this._dEH,t)}toJSON(){}}const jo=(e,t,n)=>{t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t;const i=[];let s=e._start;for(;s!==null&&r>0;){if(s.countable&&!s.deleted){const l=s.content.getContent();if(l.length<=t)t-=l.length;else{for(let a=t;a<l.length&&r>0;a++)i.push(l[a]),r--;t=0}}s=s.right}return i},Fo=e=>{const t=[];let n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let i=0;i<r.length;i++)t.push(r[i])}n=n.right}return t},jn=(e,t)=>{let n=0,r=e._start;for(;r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let s=0;s<i.length;s++)t(i[s],n++,e)}r=r.right}},Ho=(e,t)=>{const n=[];return jn(e,(r,i)=>{n.push(t(r,i,e))}),n},Qh=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}const i=n[r++];return n.length<=r&&(n=null),{done:!1,value:i}}}},Zo=(e,t)=>{const n=Nr(e,t);let r=e._start;for(n!==null&&(r=n.p,t-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},Or=(e,t,n,r)=>{let i=n;const s=e.doc,l=s.clientID,a=s.store,c=n===null?t._start:n.right;let h=[];const u=()=>{h.length>0&&(i=new we(re(l,ye(a,l)),i,i&&i.lastId,c,c&&c.id,t,null,new $t(h)),i.integrate(e,0),h=[])};r.forEach(f=>{if(f===null)h.push(f);else switch(f.constructor){case Number:case Object:case Boolean:case Array:case String:h.push(f);break;default:switch(u(),f.constructor){case Uint8Array:case ArrayBuffer:i=new we(re(l,ye(a,l)),i,i&&i.lastId,c,c&&c.id,t,null,new Hn(new Uint8Array(f))),i.integrate(e,0);break;case ln:i=new we(re(l,ye(a,l)),i,i&&i.lastId,c,c&&c.id,t,null,new Vn(f)),i.integrate(e,0);break;default:if(f instanceof Ie)i=new we(re(l,ye(a,l)),i,i&&i.lastId,c,c&&c.id,t,null,new ut(f)),i.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},Vo=()=>ot("Length exceeded!"),Wo=(e,t,n,r)=>{if(n>t._length)throw Vo();if(n===0)return t._searchMarker&&Bn(t._searchMarker,n,r.length),Or(e,t,null,r);const i=n,s=Nr(t,n);let l=t._start;for(s!==null&&(l=s.p,n-=s.index,n===0&&(l=l.prev,n+=l&&l.countable&&!l.deleted?l.length:0));l!==null;l=l.right)if(!l.deleted&&l.countable){if(n<=l.length){n<l.length&&Dt(e,re(l.id.client,l.id.clock+n));break}n-=l.length}return t._searchMarker&&Bn(t._searchMarker,i,r.length),Or(e,t,l,r)},ed=(e,t,n)=>{let r=(t._searchMarker||[]).reduce((i,s)=>s.index>i.index?s:i,{index:0,p:t._start}).p;if(r)for(;r.right;)r=r.right;return Or(e,t,r,n)},qo=(e,t,n,r)=>{if(r===0)return;const i=n,s=r,l=Nr(t,n);let a=t._start;for(l!==null&&(a=l.p,n-=l.index);a!==null&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&Dt(e,re(a.id.client,a.id.clock+n)),n-=a.length);for(;r>0&&a!==null;)a.deleted||(r<a.length&&Dt(e,re(a.id.client,a.id.clock+r)),a.delete(e),r-=a.length),a=a.right;if(r>0)throw Vo();t._searchMarker&&Bn(t._searchMarker,i,-s+r)},Mr=(e,t,n)=>{const r=t._map.get(n);r!==void 0&&r.delete(e)},Pi=(e,t,n,r)=>{const i=t._map.get(n)||null,s=e.doc,l=s.clientID;let a;if(r==null)a=new $t([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:a=new $t([r]);break;case Uint8Array:a=new Hn(r);break;case ln:a=new Vn(r);break;default:if(r instanceof Ie)a=new ut(r);else throw new Error("Unexpected content type")}new we(re(l,ye(s.store,l)),i,i&&i.lastId,null,null,t,n,a).integrate(e,0)},zi=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},$o=e=>{const t={};return e._map.forEach((n,r)=>{n.deleted||(t[r]=n.content.getContent()[n.length-1])}),t},Yo=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted},Ur=e=>ph(e.entries(),t=>!t[1].deleted);class td extends Ir{constructor(t,n){super(t,n),this._transaction=n}}class dn extends Ie{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const n=new dn;return n.push(t),n}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new dn}clone(){const t=new dn;return t.insert(0,this.toArray().map(n=>n instanceof Ie?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,n){super._callObserver(t,n),Lr(this,t,new td(this,t))}insert(t,n){this.doc!==null?ge(this.doc,r=>{Wo(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}push(t){this.doc!==null?ge(this.doc,n=>{ed(n,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,n=1){this.doc!==null?ge(this.doc,r=>{qo(r,this,t,n)}):this._prelimContent.splice(t,n)}get(t){return Zo(this,t)}toArray(){return Fo(this)}slice(t=0,n=this.length){return jo(this,t,n)}toJSON(){return this.map(t=>t instanceof Ie?t.toJSON():t)}map(t){return Ho(this,t)}forEach(t){jn(this,t)}[Symbol.iterator](){return Qh(this)}_write(t){t.writeTypeRef(Sd)}}const nd=e=>new dn;class rd extends Ir{constructor(t,n,r){super(t,n),this.keysChanged=r}}class un extends Ie{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,n){super._integrate(t,n),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new un}clone(){const t=new un;return this.forEach((n,r)=>{t.set(r,n instanceof Ie?n.clone():n)}),t}_callObserver(t,n){Lr(this,t,new rd(this,t,n))}toJSON(){const t={};return this._map.forEach((n,r)=>{if(!n.deleted){const i=n.content.getContent()[n.length-1];t[r]=i instanceof Ie?i.toJSON():i}}),t}get size(){return[...Ur(this._map)].length}keys(){return Ai(Ur(this._map),t=>t[0])}values(){return Ai(Ur(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return Ai(Ur(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((n,r)=>{n.deleted||t(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?ge(this.doc,n=>{Mr(n,this,t)}):this._prelimContent.delete(t)}set(t,n){return this.doc!==null?ge(this.doc,r=>{Pi(r,this,t,n)}):this._prelimContent.set(t,n),n}get(t){return zi(this,t)}has(t){return Yo(this,t)}clear(){this.doc!==null?ge(this.doc,t=>{this.forEach(function(n,r,i){Mr(t,i,r)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(Ad)}}const id=e=>new un,Nt=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&qc(e,t);class Bi{constructor(t,n,r,i){this.left=t,this.right=n,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&$e(),this.right.content.constructor){case ve:this.right.deleted||fn(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Ko=(e,t,n)=>{for(;t.right!==null&&n>0;){switch(t.right.content.constructor){case ve:t.right.deleted||fn(t.currentAttributes,t.right.content);break;default:t.right.deleted||(n<t.right.length&&Dt(e,re(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},Pr=(e,t,n)=>{const r=new Map,i=Nr(t,n);if(i){const s=new Bi(i.p.left,i.p,i.index,r);return Ko(e,s,n-i.index)}else{const s=new Bi(null,t._start,0,r);return Ko(e,s,n)}},Jo=(e,t,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===ve&&Nt(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const i=e.doc,s=i.clientID;r.forEach((l,a)=>{const c=n.left,h=n.right,u=new we(re(s,ye(i.store,s)),c,c&&c.lastId,h,h&&h.id,t,null,new ve(a,l));u.integrate(e,0),n.right=u,n.forward()})},fn=(e,t)=>{const{key:n,value:r}=t;r===null?e.delete(n):e.set(n,r)},Go=(e,t)=>{for(;e.right!==null&&(e.right.deleted||e.right.content.constructor===ve&&Nt(t[e.right.content.key]||null,e.right.content.value));)e.forward()},Xo=(e,t,n,r)=>{const i=e.doc,s=i.clientID,l=new Map;for(const a in r){const c=r[a],h=n.currentAttributes.get(a)||null;if(!Nt(h,c)){l.set(a,h);const{left:u,right:f}=n;n.right=new we(re(s,ye(i.store,s)),u,u&&u.lastId,f,f&&f.id,t,null,new ve(a,c)),n.right.integrate(e,0),n.forward()}}return l},ji=(e,t,n,r,i)=>{n.currentAttributes.forEach((p,g)=>{i[g]===void 0&&(i[g]=null)});const s=e.doc,l=s.clientID;Go(n,i);const a=Xo(e,t,n,i),c=r.constructor===String?new dt(r):r instanceof Ie?new ut(r):new qt(r);let{left:h,right:u,index:f}=n;t._searchMarker&&Bn(t._searchMarker,n.index,c.getLength()),u=new we(re(l,ye(s.store,l)),h,h&&h.lastId,u,u&&u.id,t,null,c),u.integrate(e,0),n.right=u,n.index=f,n.forward(),Jo(e,t,n,a)},Qo=(e,t,n,r,i)=>{const s=e.doc,l=s.clientID;Go(n,i);const a=Xo(e,t,n,i);e:for(;n.right!==null&&(r>0||a.size>0&&(n.right.deleted||n.right.content.constructor===ve));){if(!n.right.deleted)switch(n.right.content.constructor){case ve:{const{key:c,value:h}=n.right.content,u=i[c];if(u!==void 0){if(Nt(u,h))a.delete(c);else{if(r===0)break e;a.set(c,h)}n.right.delete(e)}else n.currentAttributes.set(c,h);break}default:r<n.right.length&&Dt(e,re(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let c="";for(;r>0;r--)c+=`
`;n.right=new we(re(l,ye(s.store,l)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new dt(c)),n.right.integrate(e,0),n.forward()}Jo(e,t,n,a)},ea=(e,t,n,r,i)=>{let s=t;const l=et();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===ve){const h=s.content;l.set(h.key,h)}s=s.right}let a=0,c=!1;for(;t!==s;){if(n===t&&(c=!0),!t.deleted){const h=t.content;switch(h.constructor){case ve:{const{key:u,value:f}=h,p=r.get(u)||null;(l.get(u)!==h||p===f)&&(t.delete(e),a++,!c&&(i.get(u)||null)===f&&p!==f&&(p===null?i.delete(u):i.set(u,p))),!c&&!t.deleted&&fn(i,h);break}}}t=t.right}return a},sd=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===ve){const r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}},od=e=>{let t=0;return ge(e.doc,n=>{let r=e._start,i=e._start,s=et();const l=si(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case ve:fn(l,i.content);break;default:t+=ea(n,r,i,s,l),s=si(l),r=i;break}i=i.right}}),t},ad=e=>{const t=new Set,n=e.doc;for(const[r,i]of e.afterState.entries()){const s=e.beforeState.get(r)||0;i!==s&&No(e,n.store.clients.get(r),s,i,l=>{!l.deleted&&l.content.constructor===ve&&l.constructor!==Ke&&t.add(l.parent)})}ge(n,r=>{fo(e,e.deleteSet,i=>{if(i instanceof Ke||!i.parent._hasFormatting||t.has(i.parent))return;const s=i.parent;i.content.constructor===ve?t.add(s):sd(r,i)});for(const i of t)od(i)})},ta=(e,t,n)=>{const r=n,i=si(t.currentAttributes),s=t.right;for(;n>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case ut:case qt:case dt:n<t.right.length&&Dt(e,re(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}s&&ea(e,s,t.right,i,t.currentAttributes);const l=(t.left||t.right).parent;return l._searchMarker&&Bn(l._searchMarker,t.index,-r+n),t};class ld extends Ir{constructor(t,n,r){super(t,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,n=[];ge(t,r=>{const i=new Map,s=new Map;let l=this.target._start,a=null;const c={};let h="",u=0,f=0;const p=()=>{if(a!==null){let g=null;switch(a){case"delete":f>0&&(g={delete:f}),f=0;break;case"insert":(typeof h=="object"||h.length>0)&&(g={insert:h},i.size>0&&(g.attributes={},i.forEach((b,v)=>{b!==null&&(g.attributes[v]=b)}))),h="";break;case"retain":u>0&&(g={retain:u},Vc(c)||(g.attributes=Fc({},c))),u=0;break}g&&n.push(g),a=null}};for(;l!==null;){switch(l.content.constructor){case ut:case qt:this.adds(l)?this.deletes(l)||(p(),a="insert",h=l.content.getContent()[0],p()):this.deletes(l)?(a!=="delete"&&(p(),a="delete"),f+=1):l.deleted||(a!=="retain"&&(p(),a="retain"),u+=1);break;case dt:this.adds(l)?this.deletes(l)||(a!=="insert"&&(p(),a="insert"),h+=l.content.str):this.deletes(l)?(a!=="delete"&&(p(),a="delete"),f+=l.length):l.deleted||(a!=="retain"&&(p(),a="retain"),u+=l.length);break;case ve:{const{key:g,value:b}=l.content;if(this.adds(l)){if(!this.deletes(l)){const v=i.get(g)||null;Nt(v,b)?b!==null&&l.delete(r):(a==="retain"&&p(),Nt(b,s.get(g)||null)?delete c[g]:c[g]=b)}}else if(this.deletes(l)){s.set(g,b);const v=i.get(g)||null;Nt(v,b)||(a==="retain"&&p(),c[g]=v)}else if(!l.deleted){s.set(g,b);const v=c[g];v!==void 0&&(Nt(v,b)?v!==null&&l.delete(r):(a==="retain"&&p(),b===null?delete c[g]:c[g]=b))}l.deleted||(a==="insert"&&p(),fn(i,l.content));break}}l=l.right}for(p();n.length>0;){const g=n[n.length-1];if(g.retain!==void 0&&g.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class gn extends Ie{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,n){super._integrate(t,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new gn}clone(){const t=new gn;return t.applyDelta(this.toDelta()),t}_callObserver(t,n){super._callObserver(t,n);const r=new ld(this,t,n);Lr(this,t,r),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===dt&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:n=!0}={}){this.doc!==null?ge(this.doc,r=>{const i=new Bi(null,this._start,0,new Map);for(let s=0;s<t.length;s++){const l=t[s];if(l.insert!==void 0){const a=!n&&typeof l.insert=="string"&&s===t.length-1&&i.right===null&&l.insert.slice(-1)===`
`?l.insert.slice(0,-1):l.insert;(typeof a!="string"||a.length>0)&&ji(r,this,i,a,l.attributes||{})}else l.retain!==void 0?Qo(r,this,i,l.retain,l.attributes||{}):l.delete!==void 0&&ta(r,i,l.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,n,r){const i=[],s=new Map,l=this.doc;let a="",c=this._start;function h(){if(a.length>0){const f={};let p=!1;s.forEach((b,v)=>{p=!0,f[v]=b});const g={insert:a};p&&(g.attributes=f),i.push(g),a=""}}const u=()=>{for(;c!==null;){if(zn(c,t)||n!==void 0&&zn(c,n))switch(c.content.constructor){case dt:{const f=s.get("ychange");t!==void 0&&!zn(c,t)?(f===void 0||f.user!==c.id.client||f.type!=="removed")&&(h(),s.set("ychange",r?r("removed",c.id):{type:"removed"})):n!==void 0&&!zn(c,n)?(f===void 0||f.user!==c.id.client||f.type!=="added")&&(h(),s.set("ychange",r?r("added",c.id):{type:"added"})):f!==void 0&&(h(),s.delete("ychange")),a+=c.content.str;break}case ut:case qt:{h();const f={insert:c.content.getContent()[0]};if(s.size>0){const p={};f.attributes=p,s.forEach((g,b)=>{p[b]=g})}i.push(f);break}case ve:zn(c,t)&&(h(),fn(s,c.content));break}c=c.right}h()};return t||n?ge(l,f=>{t&&Ii(f,t),n&&Ii(f,n),u()},"cleanup"):u(),i}insert(t,n,r){if(n.length<=0)return;const i=this.doc;i!==null?ge(i,s=>{const l=Pr(s,this,t);r||(r={},l.currentAttributes.forEach((a,c)=>{r[c]=a})),ji(s,this,l,n,r)}):this._pending.push(()=>this.insert(t,n,r))}insertEmbed(t,n,r={}){const i=this.doc;i!==null?ge(i,s=>{const l=Pr(s,this,t);ji(s,this,l,n,r)}):this._pending.push(()=>this.insertEmbed(t,n,r))}delete(t,n){if(n===0)return;const r=this.doc;r!==null?ge(r,i=>{ta(i,Pr(i,this,t),n)}):this._pending.push(()=>this.delete(t,n))}format(t,n,r){if(n===0)return;const i=this.doc;i!==null?ge(i,s=>{const l=Pr(s,this,t);l.right!==null&&Qo(s,this,l,n,r)}):this._pending.push(()=>this.format(t,n,r))}removeAttribute(t){this.doc!==null?ge(this.doc,n=>{Mr(n,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,n){this.doc!==null?ge(this.doc,r=>{Pi(r,this,t,n)}):this._pending.push(()=>this.setAttribute(t,n))}getAttribute(t){return zi(this,t)}getAttributes(){return $o(this)}_write(t){t.writeTypeRef(Rd)}}const cd=e=>new gn;class Fi{constructor(t,n=()=>!0){this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,n=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(n)))do if(n=t.content.type,!t.deleted&&(n.constructor===Fn||n.constructor===Wt)&&n._start!==null)t=n._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class Wt extends Ie{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Wt}clone(){const t=new Wt;return t.insert(0,this.toArray().map(n=>n instanceof Ie?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new Fi(this,t)}querySelector(t){t=t.toUpperCase();const n=new Fi(this,r=>r.nodeName&&r.nodeName.toUpperCase()===t).next();return n.done?null:n.value}querySelectorAll(t){return t=t.toUpperCase(),Tt(new Fi(this,n=>n.nodeName&&n.nodeName.toUpperCase()===t))}_callObserver(t,n){Lr(this,t,new ud(this,n,t))}toString(){return Ho(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,n={},r){const i=t.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),jn(this,s=>{i.insertBefore(s.toDOM(t,n,r),null)}),i}insert(t,n){this.doc!==null?ge(this.doc,r=>{Wo(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}insertAfter(t,n){if(this.doc!==null)ge(this.doc,r=>{const i=t&&t instanceof Ie?t._item:t;Or(r,this,i,n)});else{const r=this._prelimContent,i=t===null?0:r.findIndex(s=>s===t)+1;if(i===0&&t!==null)throw ot("Reference item not found");r.splice(i,0,...n)}}delete(t,n=1){this.doc!==null?ge(this.doc,r=>{qo(r,this,t,n)}):this._prelimContent.splice(t,n)}toArray(){return Fo(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Zo(this,t)}slice(t=0,n=this.length){return jo(this,t,n)}forEach(t){jn(this,t)}_write(t){t.writeTypeRef(Td)}}const hd=e=>new Wt;class Fn extends Wt{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,n){super._integrate(t,n),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new Fn(this.nodeName)}clone(){const t=new Fn(this.nodeName),n=this.getAttributes();return Zc(n,(r,i)=>{typeof r=="string"&&t.setAttribute(i,r)}),t.insert(0,this.toArray().map(r=>r instanceof Ie?r.clone():r)),t}toString(){const t=this.getAttributes(),n=[],r=[];for(const a in t)r.push(a);r.sort();const i=r.length;for(let a=0;a<i;a++){const c=r[a];n.push(c+'="'+t[c]+'"')}const s=this.nodeName.toLocaleLowerCase(),l=n.length>0?" "+n.join(" "):"";return`<${s}${l}>${super.toString()}</${s}>`}removeAttribute(t){this.doc!==null?ge(this.doc,n=>{Mr(n,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,n){this.doc!==null?ge(this.doc,r=>{Pi(r,this,t,n)}):this._prelimAttrs.set(t,n)}getAttribute(t){return zi(this,t)}hasAttribute(t){return Yo(this,t)}getAttributes(){return $o(this)}toDOM(t=document,n={},r){const i=t.createElement(this.nodeName),s=this.getAttributes();for(const l in s){const a=s[l];typeof a=="string"&&i.setAttribute(l,a)}return jn(this,l=>{i.appendChild(l.toDOM(t,n,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(t){t.writeTypeRef(xd),t.writeKey(this.nodeName)}}const dd=e=>new Fn(e.readKey());class ud extends Ir{constructor(t,n,r){super(t,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class zr extends un{constructor(t){super(),this.hookName=t}_copy(){return new zr(this.hookName)}clone(){const t=new zr(this.hookName);return this.forEach((n,r)=>{t.set(r,n)}),t}toDOM(t=document,n={},r){const i=n[this.hookName];let s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(s,this),s}_write(t){t.writeTypeRef(Dd),t.writeKey(this.hookName)}}const fd=e=>new zr(e.readKey());class Br extends gn{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new Br}clone(){const t=new Br;return t.applyDelta(this.toDelta()),t}toDOM(t=document,n,r){const i=t.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(t=>{const n=[];for(const i in t.attributes){const s=[];for(const l in t.attributes[i])s.push({key:l,value:t.attributes[i][l]});s.sort((l,a)=>l.key<a.key?-1:1),n.push({nodeName:i,attrs:s})}n.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let r="";for(let i=0;i<n.length;i++){const s=n[i];r+=`<${s.nodeName}`;for(let l=0;l<s.attrs.length;l++){const a=s.attrs[l];r+=` ${a.key}="${a.value}"`}r+=">"}r+=t.insert;for(let i=n.length-1;i>=0;i--)r+=`</${n[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(Id)}}const gd=e=>new Br;class Hi{constructor(t,n){this.id=t,this.length=n}get deleted(){throw at()}mergeWith(t){return!1}write(t,n,r){throw at()}integrate(t,n){throw at()}}const pd=0;class Ke extends Hi{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){n>0&&(this.id.clock+=n,this.length-=n),Do(t.doc.store,this)}write(t,n){t.writeInfo(pd),t.writeLen(this.length-n)}getMissing(t,n){return null}}class Hn{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Hn(this.content)}splice(t){throw at()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeBuf(this.content)}getRef(){return 3}}const _d=e=>new Hn(e.readBuf());class Zn{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Zn(this.len)}splice(t){const n=new Zn(this.len-t);return this.len=t,n}mergeWith(t){return this.len+=t.len,!0}integrate(t,n){kr(t.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(t){}gc(t){}write(t,n){t.writeLen(this.len-n)}getRef(){return 1}}const md=e=>new Zn(e.readLen()),na=(e,t)=>new ln({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Vn{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),t.meta!==null&&(n.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Vn(na(this.doc.guid,this.opts))}splice(t){throw at()}mergeWith(t){return!1}integrate(t,n){this.doc._item=n,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,n){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const bd=e=>new Vn(na(e.readString(),e.readAny()));class qt{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new qt(this.embed)}splice(t){throw at()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeJSON(this.embed)}getRef(){return 5}}const wd=e=>new qt(e.readJSON());class ve{constructor(t,n){this.key=t,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ve(this.key,this.value)}splice(t){throw at()}mergeWith(t){return!1}integrate(t,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(t){}gc(t){}write(t,n){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const yd=e=>new ve(e.readKey(),e.readJSON());class jr{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new jr(this.arr)}splice(t){const n=new jr(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){const s=this.arr[i];t.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const vd=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++){const i=e.readString();i==="undefined"?n.push(void 0):n.push(JSON.parse(i))}return new jr(n)};class $t{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new $t(this.arr)}splice(t){const n=new $t(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){const s=this.arr[i];t.writeAny(s)}}getRef(){return 8}}const kd=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new $t(n)};class dt{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new dt(this.str)}splice(t){const n=new dt(this.str.slice(t));this.str=this.str.slice(0,t);const r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",n.str="\uFFFD"+n.str.slice(1)),n}mergeWith(t){return this.str+=t.str,!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const Ed=e=>new dt(e.readString()),Cd=[nd,id,cd,dd,hd,fd,gd],Sd=0,Ad=1,Rd=2,xd=3,Td=4,Dd=5,Id=6;class ut{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new ut(this.type._copy())}splice(t){throw at()}mergeWith(t){return!1}integrate(t,n){this.type._integrate(t.doc,n)}delete(t){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(t.beforeState.get(n.id.client)||0)&&t._mergeStructs.push(n):n.delete(t),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(t.beforeState.get(r.id.client)||0)&&t._mergeStructs.push(r):r.delete(t)}),t.changed.delete(this.type)}gc(t){let n=this.type._start;for(;n!==null;)n.gc(t,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(t,!0),r=r.left}),this.type._map=new Map}write(t,n){this.type._write(t)}getRef(){return 7}}const Nd=e=>new ut(Cd[e.readTypeRef()](e)),ra=(e,t)=>{let n=t,r=0,i;do r>0&&(n=re(n.client,n.clock+r)),i=xr(e,n),r=n.clock-i.id.clock,n=i.redone;while(n!==null&&i instanceof we);return{item:i,diff:r}},Fr=(e,t,n)=>{const{client:r,clock:i}=t.id,s=new we(re(r,i+n),t,re(r,i+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&s.markDeleted(),t.keep&&(s.keep=!0),t.redone!==null&&(s.redone=re(t.redone.client,t.redone.clock+n)),t.right=s,s.right!==null&&(s.right.left=s),e._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),t.length=n,s};class we extends Hi{constructor(t,n,r,i,s,l,a,c){super(t,c.getLength()),this.origin=r,this.left=n,this.right=i,this.rightOrigin=s,this.parent=l,this.parentSub=a,this.redone=null,this.content=c,this.info=this.content.isCountable()?Ps:0}set marker(t){(this.info&ci)>0!==t&&(this.info^=ci)}get marker(){return(this.info&ci)>0}get keep(){return(this.info&Us)>0}set keep(t){this.keep!==t&&(this.info^=Us)}get countable(){return(this.info&Ps)>0}get deleted(){return(this.info&li)>0}set deleted(t){this.deleted!==t&&(this.info^=li)}markDeleted(){this.info|=li}getMissing(t,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=ye(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=ye(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===hn&&this.id.client!==this.parent.client&&this.parent.clock>=ye(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Io(t,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Dt(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Ke||this.right&&this.right.constructor===Ke)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===we&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===we&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===hn){const r=xr(n,this.parent);r.constructor===Ke?this.parent=null:this.parent=r.content.type}return null}integrate(t,n){if(n>0&&(this.id.clock+=n,this.left=Io(t,t.doc.store,re(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const s=new Set,l=new Set;for(;i!==null&&i!==this.right;){if(l.add(i),s.add(i),Er(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,s.clear();else if(Er(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&l.has(xr(t.doc.store,i.origin)))s.has(xr(t.doc.store,i.origin))||(r=i,s.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Do(t.doc.store,this),this.content.integrate(t,this),Oo(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new Ke(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:re(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&Er(t.origin,this.lastId)&&this.right===t&&Er(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===t&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),kr(t.deleteSet,this.id.client,this.id.clock,this.length),Oo(t,n,this.parentSub),this.content.delete(t)}}gc(t,n){if(!this.deleted)throw $e();this.content.gc(t),n?Bh(t,this,new Ke(this.id,this.length)):this.content=new Zn(this.length)}write(t,n){const r=n>0?re(this.id.client,this.id.clock+n-1):this.origin,i=this.rightOrigin,s=this.parentSub,l=this.content.getRef()&gr|(r===null?0:Ze)|(i===null?0:yt)|(s===null?0:Dn);if(t.writeInfo(l),r!==null&&t.writeLeftID(r),i!==null&&t.writeRightID(i),r===null&&i===null){const a=this.parent;if(a._item!==void 0){const c=a._item;if(c===null){const h=xo(a);t.writeParentInfo(!0),t.writeString(h)}else t.writeParentInfo(!1),t.writeLeftID(c.id)}else a.constructor===String?(t.writeParentInfo(!0),t.writeString(a)):a.constructor===hn?(t.writeParentInfo(!1),t.writeLeftID(a)):$e();s!==null&&t.writeString(s)}this.content.write(t,n)}}const ia=(e,t)=>Ld[t&gr](e),Ld=[()=>{$e()},md,vd,_d,Ed,wd,yd,Nd,kd,bd,()=>{$e()}],Od=10;class Je extends Hi{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){$e()}write(t,n){t.writeInfo(Od),Y(t.restEncoder,this.length-n)}getMissing(t,n){return null}}const sa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},oa="__ $YJS$ __";sa[oa]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),sa[oa]=!0;const Md=1200,Ud=2500,Hr=3e4,Zi=e=>{if(e.shouldConnect&&e.ws===null){const t=new WebSocket(e.url),n=e.binaryType;let r=null;n&&(t.binaryType=n),e.ws=t,e.connecting=!0,e.connected=!1,t.onmessage=l=>{e.lastMessageReceived=kt();const a=l.data,c=typeof a=="string"?JSON.parse(a):a;c&&c.type==="pong"&&(clearTimeout(r),r=setTimeout(s,Hr/2)),e.emit("message",[c,e])};const i=l=>{e.ws!==null&&(e.ws=null,e.connecting=!1,e.connected?(e.connected=!1,e.emit("disconnect",[{type:"disconnect",error:l},e])):e.unsuccessfulReconnects++,setTimeout(Zi,ai(ic(e.unsuccessfulReconnects+1)*Md,Ud),e)),clearTimeout(r)},s=()=>{e.ws===t&&e.send({type:"ping"})};t.onclose=()=>i(null),t.onerror=l=>i(l),t.onopen=()=>{e.lastMessageReceived=kt(),e.connecting=!1,e.connected=!0,e.unsuccessfulReconnects=0,e.emit("connect",[{type:"connect"},e]),r=setTimeout(s,Hr/2)}}};class Pd extends ur{constructor(t,{binaryType:n}={}){super(),this.url=t,this.ws=null,this.binaryType=n||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&Hr<kt()-this.lastMessageReceived&&this.ws.close()},Hr/2),Zi(this)}send(t){this.ws&&this.ws.send(JSON.stringify(t))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&Zi(this)}}const aa=new Map;class zd{constructor(t){this.room=t,this.onmessage=null,this._onChange=n=>n.key===t&&this.onmessage!==null&&this.onmessage({data:ro(n.newValue||"")}),Bc(this._onChange)}postMessage(t){Gs.setItem(this.room,no(eh(t)))}close(){jc(this._onChange)}}const Bd=typeof BroadcastChannel>"u"?zd:BroadcastChannel,Vi=e=>qe(aa,e,()=>{const t=Bt(),n=new Bd(e);return n.onmessage=r=>t.forEach(i=>i(r.data,"broadcastchannel")),{bc:n,subs:t}}),jd=(e,t)=>(Vi(e).subs.add(t),t),Fd=(e,t)=>{const n=Vi(e),r=n.subs.delete(t);return r&&n.subs.size===0&&(n.bc.close(),aa.delete(e)),r},Hd=(e,t,n=null)=>{const r=Vi(e);r.bc.postMessage(t),r.subs.forEach(i=>i(t,n))},la=()=>{let e=!0;return(t,n)=>{if(e){e=!1;try{t()}finally{e=!0}}else n!==void 0&&n()}};function Zr(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ca={exports:{}};(function(e,t){(function(n){e.exports=n()})(function(){var n=Math.floor,r=Math.abs,i=Math.pow;return function(){function s(l,a,c){function h(p,g){if(!a[p]){if(!l[p]){var b=typeof Zr=="function"&&Zr;if(!g&&b)return b(p,!0);if(u)return u(p,!0);var v=new Error("Cannot find module '"+p+"'");throw v.code="MODULE_NOT_FOUND",v}var D=a[p]={exports:{}};l[p][0].call(D.exports,function(x){var L=l[p][1][x];return h(L||x)},D,D.exports,s,l,a,c)}return a[p].exports}for(var u=typeof Zr=="function"&&Zr,f=0;f<c.length;f++)h(c[f]);return h}return s}()({1:[function(s,l,a){function c(w){var E=w.length;if(0<E%4)throw new Error("Invalid string. Length must be a multiple of 4");var S=w.indexOf("=");S===-1&&(S=E);var k=S===E?0:4-S%4;return[S,k]}function h(w,E,S){return 3*(E+S)/4-S}function u(w){var E,S,k=c(w),T=k[0],I=k[1],C=new D(h(w,T,I)),R=0,P=0<I?T-4:T;for(S=0;S<P;S+=4)E=v[w.charCodeAt(S)]<<18|v[w.charCodeAt(S+1)]<<12|v[w.charCodeAt(S+2)]<<6|v[w.charCodeAt(S+3)],C[R++]=255&E>>16,C[R++]=255&E>>8,C[R++]=255&E;return I===2&&(E=v[w.charCodeAt(S)]<<2|v[w.charCodeAt(S+1)]>>4,C[R++]=255&E),I===1&&(E=v[w.charCodeAt(S)]<<10|v[w.charCodeAt(S+1)]<<4|v[w.charCodeAt(S+2)]>>2,C[R++]=255&E>>8,C[R++]=255&E),C}function f(w){return b[63&w>>18]+b[63&w>>12]+b[63&w>>6]+b[63&w]}function p(w,E,S){for(var k,T=[],I=E;I<S;I+=3)k=(16711680&w[I]<<16)+(65280&w[I+1]<<8)+(255&w[I+2]),T.push(f(k));return T.join("")}function g(w){for(var E,S=w.length,k=S%3,T=[],I=16383,C=0,R=S-k;C<R;C+=I)T.push(p(w,C,C+I>R?R:C+I));return k===1?(E=w[S-1],T.push(b[E>>2]+b[63&E<<4]+"==")):k===2&&(E=(w[S-2]<<8)+w[S-1],T.push(b[E>>10]+b[63&E>>4]+b[63&E<<2]+"=")),T.join("")}a.byteLength=function(w){var E=c(w),S=E[0],k=E[1];return 3*(S+k)/4-k},a.toByteArray=u,a.fromByteArray=g;for(var b=[],v=[],D=typeof Uint8Array>"u"?Array:Uint8Array,x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",L=0,m=x.length;L<m;++L)b[L]=x[L],v[x.charCodeAt(L)]=L;v[45]=62,v[95]=63},{}],2:[function(){},{}],3:[function(s,l,a){(function(){(function(){var c=String.fromCharCode,h=Math.min;function u(o){if(2147483647<o)throw new RangeError('The value "'+o+'" is invalid for option "size"');var d=new Uint8Array(o);return d.__proto__=f.prototype,d}function f(o,d,_){if(typeof o=="number"){if(typeof d=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(o)}return p(o,d,_)}function p(o,d,_){if(typeof o=="string")return D(o,d);if(ArrayBuffer.isView(o))return x(o);if(o==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o);if(O(o,ArrayBuffer)||o&&O(o.buffer,ArrayBuffer))return L(o,d,_);if(typeof o=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var A=o.valueOf&&o.valueOf();if(A!=null&&A!==o)return f.from(A,d,_);var N=m(o);if(N)return N;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof o[Symbol.toPrimitive]=="function")return f.from(o[Symbol.toPrimitive]("string"),d,_);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o)}function g(o){if(typeof o!="number")throw new TypeError('"size" argument must be of type number');if(0>o)throw new RangeError('The value "'+o+'" is invalid for option "size"')}function b(o,d,_){return g(o),0>=o||d===void 0?u(o):typeof _=="string"?u(o).fill(d,_):u(o).fill(d)}function v(o){return g(o),u(0>o?0:0|w(o))}function D(o,d){if((typeof d!="string"||d==="")&&(d="utf8"),!f.isEncoding(d))throw new TypeError("Unknown encoding: "+d);var _=0|E(o,d),A=u(_),N=A.write(o,d);return N!==_&&(A=A.slice(0,N)),A}function x(o){for(var d=0>o.length?0:0|w(o.length),_=u(d),A=0;A<d;A+=1)_[A]=255&o[A];return _}function L(o,d,_){if(0>d||o.byteLength<d)throw new RangeError('"offset" is outside of buffer bounds');if(o.byteLength<d+(_||0))throw new RangeError('"length" is outside of buffer bounds');var A;return A=d===void 0&&_===void 0?new Uint8Array(o):_===void 0?new Uint8Array(o,d):new Uint8Array(o,d,_),A.__proto__=f.prototype,A}function m(o){if(f.isBuffer(o)){var d=0|w(o.length),_=u(d);return _.length===0||o.copy(_,0,0,d),_}return o.length===void 0?o.type==="Buffer"&&Array.isArray(o.data)?x(o.data):void 0:typeof o.length!="number"||M(o.length)?u(0):x(o)}function w(o){if(o>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|o}function E(o,d){if(f.isBuffer(o))return o.length;if(ArrayBuffer.isView(o)||O(o,ArrayBuffer))return o.byteLength;if(typeof o!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof o);var _=o.length,A=2<arguments.length&&arguments[2]===!0;if(!A&&_===0)return 0;for(var N=!1;;)switch(d){case"ascii":case"latin1":case"binary":return _;case"utf8":case"utf-8":return Fe(o).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*_;case"hex":return _>>>1;case"base64":return Ue(o).length;default:if(N)return A?-1:Fe(o).length;d=(""+d).toLowerCase(),N=!0}}function S(o,d,_){var A=!1;if((d===void 0||0>d)&&(d=0),d>this.length||((_===void 0||_>this.length)&&(_=this.length),0>=_)||(_>>>=0,d>>>=0,_<=d))return"";for(o||(o="utf8");;)switch(o){case"hex":return Ee(this,d,_);case"utf8":case"utf-8":return J(this,d,_);case"ascii":return F(this,d,_);case"latin1":case"binary":return ke(this,d,_);case"base64":return W(this,d,_);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Me(this,d,_);default:if(A)throw new TypeError("Unknown encoding: "+o);o=(o+"").toLowerCase(),A=!0}}function k(o,d,_){var A=o[d];o[d]=o[_],o[_]=A}function T(o,d,_,A,N){if(o.length===0)return-1;if(typeof _=="string"?(A=_,_=0):2147483647<_?_=2147483647:-2147483648>_&&(_=-2147483648),_=+_,M(_)&&(_=N?0:o.length-1),0>_&&(_=o.length+_),_>=o.length){if(N)return-1;_=o.length-1}else if(0>_)if(N)_=0;else return-1;if(typeof d=="string"&&(d=f.from(d,A)),f.isBuffer(d))return d.length===0?-1:I(o,d,_,A,N);if(typeof d=="number")return d&=255,typeof Uint8Array.prototype.indexOf=="function"?N?Uint8Array.prototype.indexOf.call(o,d,_):Uint8Array.prototype.lastIndexOf.call(o,d,_):I(o,[d],_,A,N);throw new TypeError("val must be string, number or Buffer")}function I(o,d,_,A,N){function U(Sn,hr){return q===1?Sn[hr]:Sn.readUInt16BE(hr*q)}var q=1,oe=o.length,_e=d.length;if(A!==void 0&&(A=(A+"").toLowerCase(),A==="ucs2"||A==="ucs-2"||A==="utf16le"||A==="utf-16le")){if(2>o.length||2>d.length)return-1;q=2,oe/=2,_e/=2,_/=2}var ae;if(N){var se=-1;for(ae=_;ae<oe;ae++)if(U(o,ae)!==U(d,se===-1?0:ae-se))se!==-1&&(ae-=ae-se),se=-1;else if(se===-1&&(se=ae),ae-se+1===_e)return se*q}else for(_+_e>oe&&(_=oe-_e),ae=_;0<=ae;ae--){for(var Le=!0,nn=0;nn<_e;nn++)if(U(o,ae+nn)!==U(d,nn)){Le=!1;break}if(Le)return ae}return-1}function C(o,d,_,A){_=+_||0;var N=o.length-_;A?(A=+A,A>N&&(A=N)):A=N;var U=d.length;A>U/2&&(A=U/2);for(var q,oe=0;oe<A;++oe){if(q=parseInt(d.substr(2*oe,2),16),M(q))return oe;o[_+oe]=q}return oe}function R(o,d,_,A){return Pe(Fe(d,o.length-_),o,_,A)}function P(o,d,_,A){return Pe(He(d),o,_,A)}function z(o,d,_,A){return P(o,d,_,A)}function Z(o,d,_,A){return Pe(Ue(d),o,_,A)}function H(o,d,_,A){return Pe(rt(d,o.length-_),o,_,A)}function W(o,d,_){return d===0&&_===o.length?B.fromByteArray(o):B.fromByteArray(o.slice(d,_))}function J(o,d,_){_=h(o.length,_);for(var A=[],N=d;N<_;){var U=o[N],q=null,oe=239<U?4:223<U?3:191<U?2:1;if(N+oe<=_){var _e,ae,se,Le;oe===1?128>U&&(q=U):oe===2?(_e=o[N+1],(192&_e)==128&&(Le=(31&U)<<6|63&_e,127<Le&&(q=Le))):oe===3?(_e=o[N+1],ae=o[N+2],(192&_e)==128&&(192&ae)==128&&(Le=(15&U)<<12|(63&_e)<<6|63&ae,2047<Le&&(55296>Le||57343<Le)&&(q=Le))):oe===4&&(_e=o[N+1],ae=o[N+2],se=o[N+3],(192&_e)==128&&(192&ae)==128&&(192&se)==128&&(Le=(15&U)<<18|(63&_e)<<12|(63&ae)<<6|63&se,65535<Le&&1114112>Le&&(q=Le)))}q===null?(q=65533,oe=1):65535<q&&(q-=65536,A.push(55296|1023&q>>>10),q=56320|1023&q),A.push(q),N+=oe}return K(A)}function K(o){var d=o.length;if(d<=4096)return c.apply(String,o);for(var _="",A=0;A<d;)_+=c.apply(String,o.slice(A,A+=4096));return _}function F(o,d,_){var A="";_=h(o.length,_);for(var N=d;N<_;++N)A+=c(127&o[N]);return A}function ke(o,d,_){var A="";_=h(o.length,_);for(var N=d;N<_;++N)A+=c(o[N]);return A}function Ee(o,d,_){var A=o.length;(!d||0>d)&&(d=0),(!_||0>_||_>A)&&(_=A);for(var N="",U=d;U<_;++U)N+=je(o[U]);return N}function Me(o,d,_){for(var A=o.slice(d,_),N="",U=0;U<A.length;U+=2)N+=c(A[U]+256*A[U+1]);return N}function ie(o,d,_){if(o%1!=0||0>o)throw new RangeError("offset is not uint");if(o+d>_)throw new RangeError("Trying to access beyond buffer length")}function G(o,d,_,A,N,U){if(!f.isBuffer(o))throw new TypeError('"buffer" argument must be a Buffer instance');if(d>N||d<U)throw new RangeError('"value" argument is out of bounds');if(_+A>o.length)throw new RangeError("Index out of range")}function he(o,d,_,A){if(_+A>o.length)throw new RangeError("Index out of range");if(0>_)throw new RangeError("Index out of range")}function ue(o,d,_,A,N){return d=+d,_>>>=0,N||he(o,d,_,4),$.write(o,d,_,A,23,4),_+4}function ne(o,d,_,A,N){return d=+d,_>>>=0,N||he(o,d,_,8),$.write(o,d,_,A,52,8),_+8}function fe(o){if(o=o.split("=")[0],o=o.trim().replace(y,""),2>o.length)return"";for(;o.length%4!=0;)o+="=";return o}function je(o){return 16>o?"0"+o.toString(16):o.toString(16)}function Fe(o,d){d=d||1/0;for(var _,A=o.length,N=null,U=[],q=0;q<A;++q){if(_=o.charCodeAt(q),55295<_&&57344>_){if(!N){if(56319<_){-1<(d-=3)&&U.push(239,191,189);continue}else if(q+1===A){-1<(d-=3)&&U.push(239,191,189);continue}N=_;continue}if(56320>_){-1<(d-=3)&&U.push(239,191,189),N=_;continue}_=(N-55296<<10|_-56320)+65536}else N&&-1<(d-=3)&&U.push(239,191,189);if(N=null,128>_){if(0>(d-=1))break;U.push(_)}else if(2048>_){if(0>(d-=2))break;U.push(192|_>>6,128|63&_)}else if(65536>_){if(0>(d-=3))break;U.push(224|_>>12,128|63&_>>6,128|63&_)}else if(1114112>_){if(0>(d-=4))break;U.push(240|_>>18,128|63&_>>12,128|63&_>>6,128|63&_)}else throw new Error("Invalid code point")}return U}function He(o){for(var d=[],_=0;_<o.length;++_)d.push(255&o.charCodeAt(_));return d}function rt(o,d){for(var _,A,N,U=[],q=0;q<o.length&&!(0>(d-=2));++q)_=o.charCodeAt(q),A=_>>8,N=_%256,U.push(N),U.push(A);return U}function Ue(o){return B.toByteArray(fe(o))}function Pe(o,d,_,A){for(var N=0;N<A&&!(N+_>=d.length||N>=o.length);++N)d[N+_]=o[N];return N}function O(o,d){return o instanceof d||o!=null&&o.constructor!=null&&o.constructor.name!=null&&o.constructor.name===d.name}function M(o){return o!==o}var B=s("base64-js"),$=s("ieee754");a.Buffer=f,a.SlowBuffer=function(o){return+o!=o&&(o=0),f.alloc(+o)},a.INSPECT_MAX_BYTES=50,a.kMaxLength=2147483647,f.TYPED_ARRAY_SUPPORT=function(){try{var o=new Uint8Array(1);return o.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},o.foo()===42}catch{return!1}}(),f.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){return f.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){return f.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),f.poolSize=8192,f.from=function(o,d,_){return p(o,d,_)},f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,f.alloc=function(o,d,_){return b(o,d,_)},f.allocUnsafe=function(o){return v(o)},f.allocUnsafeSlow=function(o){return v(o)},f.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==f.prototype},f.compare=function(o,d){if(O(o,Uint8Array)&&(o=f.from(o,o.offset,o.byteLength)),O(d,Uint8Array)&&(d=f.from(d,d.offset,d.byteLength)),!f.isBuffer(o)||!f.isBuffer(d))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===d)return 0;for(var _=o.length,A=d.length,N=0,U=h(_,A);N<U;++N)if(o[N]!==d[N]){_=o[N],A=d[N];break}return _<A?-1:A<_?1:0},f.isEncoding=function(o){switch((o+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(o,d){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return f.alloc(0);var _;if(d===void 0)for(d=0,_=0;_<o.length;++_)d+=o[_].length;var A=f.allocUnsafe(d),N=0;for(_=0;_<o.length;++_){var U=o[_];if(O(U,Uint8Array)&&(U=f.from(U)),!f.isBuffer(U))throw new TypeError('"list" argument must be an Array of Buffers');U.copy(A,N),N+=U.length}return A},f.byteLength=E,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var o=this.length;if(o%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var d=0;d<o;d+=2)k(this,d,d+1);return this},f.prototype.swap32=function(){var o=this.length;if(o%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var d=0;d<o;d+=4)k(this,d,d+3),k(this,d+1,d+2);return this},f.prototype.swap64=function(){var o=this.length;if(o%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var d=0;d<o;d+=8)k(this,d,d+7),k(this,d+1,d+6),k(this,d+2,d+5),k(this,d+3,d+4);return this},f.prototype.toString=function(){var o=this.length;return o===0?"":arguments.length===0?J(this,0,o):S.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(o){if(!f.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o||f.compare(this,o)===0},f.prototype.inspect=function(){var o="",d=a.INSPECT_MAX_BYTES;return o=this.toString("hex",0,d).replace(/(.{2})/g,"$1 ").trim(),this.length>d&&(o+=" ... "),"<Buffer "+o+">"},f.prototype.compare=function(o,d,_,A,N){if(O(o,Uint8Array)&&(o=f.from(o,o.offset,o.byteLength)),!f.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(d===void 0&&(d=0),_===void 0&&(_=o?o.length:0),A===void 0&&(A=0),N===void 0&&(N=this.length),0>d||_>o.length||0>A||N>this.length)throw new RangeError("out of range index");if(A>=N&&d>=_)return 0;if(A>=N)return-1;if(d>=_)return 1;if(d>>>=0,_>>>=0,A>>>=0,N>>>=0,this===o)return 0;for(var U=N-A,q=_-d,oe=h(U,q),_e=this.slice(A,N),ae=o.slice(d,_),se=0;se<oe;++se)if(_e[se]!==ae[se]){U=_e[se],q=ae[se];break}return U<q?-1:q<U?1:0},f.prototype.includes=function(o,d,_){return this.indexOf(o,d,_)!==-1},f.prototype.indexOf=function(o,d,_){return T(this,o,d,_,!0)},f.prototype.lastIndexOf=function(o,d,_){return T(this,o,d,_,!1)},f.prototype.write=function(o,d,_,A){if(d===void 0)A="utf8",_=this.length,d=0;else if(_===void 0&&typeof d=="string")A=d,_=this.length,d=0;else if(isFinite(d))d>>>=0,isFinite(_)?(_>>>=0,A===void 0&&(A="utf8")):(A=_,_=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var N=this.length-d;if((_===void 0||_>N)&&(_=N),0<o.length&&(0>_||0>d)||d>this.length)throw new RangeError("Attempt to write outside buffer bounds");A||(A="utf8");for(var U=!1;;)switch(A){case"hex":return C(this,o,d,_);case"utf8":case"utf-8":return R(this,o,d,_);case"ascii":return P(this,o,d,_);case"latin1":case"binary":return z(this,o,d,_);case"base64":return Z(this,o,d,_);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,o,d,_);default:if(U)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),U=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},f.prototype.slice=function(o,d){var _=this.length;o=~~o,d=d===void 0?_:~~d,0>o?(o+=_,0>o&&(o=0)):o>_&&(o=_),0>d?(d+=_,0>d&&(d=0)):d>_&&(d=_),d<o&&(d=o);var A=this.subarray(o,d);return A.__proto__=f.prototype,A},f.prototype.readUIntLE=function(o,d,_){o>>>=0,d>>>=0,_||ie(o,d,this.length);for(var A=this[o],N=1,U=0;++U<d&&(N*=256);)A+=this[o+U]*N;return A},f.prototype.readUIntBE=function(o,d,_){o>>>=0,d>>>=0,_||ie(o,d,this.length);for(var A=this[o+--d],N=1;0<d&&(N*=256);)A+=this[o+--d]*N;return A},f.prototype.readUInt8=function(o,d){return o>>>=0,d||ie(o,1,this.length),this[o]},f.prototype.readUInt16LE=function(o,d){return o>>>=0,d||ie(o,2,this.length),this[o]|this[o+1]<<8},f.prototype.readUInt16BE=function(o,d){return o>>>=0,d||ie(o,2,this.length),this[o]<<8|this[o+1]},f.prototype.readUInt32LE=function(o,d){return o>>>=0,d||ie(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+16777216*this[o+3]},f.prototype.readUInt32BE=function(o,d){return o>>>=0,d||ie(o,4,this.length),16777216*this[o]+(this[o+1]<<16|this[o+2]<<8|this[o+3])},f.prototype.readIntLE=function(o,d,_){o>>>=0,d>>>=0,_||ie(o,d,this.length);for(var A=this[o],N=1,U=0;++U<d&&(N*=256);)A+=this[o+U]*N;return N*=128,A>=N&&(A-=i(2,8*d)),A},f.prototype.readIntBE=function(o,d,_){o>>>=0,d>>>=0,_||ie(o,d,this.length);for(var A=d,N=1,U=this[o+--A];0<A&&(N*=256);)U+=this[o+--A]*N;return N*=128,U>=N&&(U-=i(2,8*d)),U},f.prototype.readInt8=function(o,d){return o>>>=0,d||ie(o,1,this.length),128&this[o]?-1*(255-this[o]+1):this[o]},f.prototype.readInt16LE=function(o,d){o>>>=0,d||ie(o,2,this.length);var _=this[o]|this[o+1]<<8;return 32768&_?4294901760|_:_},f.prototype.readInt16BE=function(o,d){o>>>=0,d||ie(o,2,this.length);var _=this[o+1]|this[o]<<8;return 32768&_?4294901760|_:_},f.prototype.readInt32LE=function(o,d){return o>>>=0,d||ie(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24},f.prototype.readInt32BE=function(o,d){return o>>>=0,d||ie(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]},f.prototype.readFloatLE=function(o,d){return o>>>=0,d||ie(o,4,this.length),$.read(this,o,!0,23,4)},f.prototype.readFloatBE=function(o,d){return o>>>=0,d||ie(o,4,this.length),$.read(this,o,!1,23,4)},f.prototype.readDoubleLE=function(o,d){return o>>>=0,d||ie(o,8,this.length),$.read(this,o,!0,52,8)},f.prototype.readDoubleBE=function(o,d){return o>>>=0,d||ie(o,8,this.length),$.read(this,o,!1,52,8)},f.prototype.writeUIntLE=function(o,d,_,A){if(o=+o,d>>>=0,_>>>=0,!A){var N=i(2,8*_)-1;G(this,o,d,_,N,0)}var U=1,q=0;for(this[d]=255&o;++q<_&&(U*=256);)this[d+q]=255&o/U;return d+_},f.prototype.writeUIntBE=function(o,d,_,A){if(o=+o,d>>>=0,_>>>=0,!A){var N=i(2,8*_)-1;G(this,o,d,_,N,0)}var U=_-1,q=1;for(this[d+U]=255&o;0<=--U&&(q*=256);)this[d+U]=255&o/q;return d+_},f.prototype.writeUInt8=function(o,d,_){return o=+o,d>>>=0,_||G(this,o,d,1,255,0),this[d]=255&o,d+1},f.prototype.writeUInt16LE=function(o,d,_){return o=+o,d>>>=0,_||G(this,o,d,2,65535,0),this[d]=255&o,this[d+1]=o>>>8,d+2},f.prototype.writeUInt16BE=function(o,d,_){return o=+o,d>>>=0,_||G(this,o,d,2,65535,0),this[d]=o>>>8,this[d+1]=255&o,d+2},f.prototype.writeUInt32LE=function(o,d,_){return o=+o,d>>>=0,_||G(this,o,d,4,4294967295,0),this[d+3]=o>>>24,this[d+2]=o>>>16,this[d+1]=o>>>8,this[d]=255&o,d+4},f.prototype.writeUInt32BE=function(o,d,_){return o=+o,d>>>=0,_||G(this,o,d,4,4294967295,0),this[d]=o>>>24,this[d+1]=o>>>16,this[d+2]=o>>>8,this[d+3]=255&o,d+4},f.prototype.writeIntLE=function(o,d,_,A){if(o=+o,d>>>=0,!A){var N=i(2,8*_-1);G(this,o,d,_,N-1,-N)}var U=0,q=1,oe=0;for(this[d]=255&o;++U<_&&(q*=256);)0>o&&oe===0&&this[d+U-1]!==0&&(oe=1),this[d+U]=255&(o/q>>0)-oe;return d+_},f.prototype.writeIntBE=function(o,d,_,A){if(o=+o,d>>>=0,!A){var N=i(2,8*_-1);G(this,o,d,_,N-1,-N)}var U=_-1,q=1,oe=0;for(this[d+U]=255&o;0<=--U&&(q*=256);)0>o&&oe===0&&this[d+U+1]!==0&&(oe=1),this[d+U]=255&(o/q>>0)-oe;return d+_},f.prototype.writeInt8=function(o,d,_){return o=+o,d>>>=0,_||G(this,o,d,1,127,-128),0>o&&(o=255+o+1),this[d]=255&o,d+1},f.prototype.writeInt16LE=function(o,d,_){return o=+o,d>>>=0,_||G(this,o,d,2,32767,-32768),this[d]=255&o,this[d+1]=o>>>8,d+2},f.prototype.writeInt16BE=function(o,d,_){return o=+o,d>>>=0,_||G(this,o,d,2,32767,-32768),this[d]=o>>>8,this[d+1]=255&o,d+2},f.prototype.writeInt32LE=function(o,d,_){return o=+o,d>>>=0,_||G(this,o,d,4,2147483647,-2147483648),this[d]=255&o,this[d+1]=o>>>8,this[d+2]=o>>>16,this[d+3]=o>>>24,d+4},f.prototype.writeInt32BE=function(o,d,_){return o=+o,d>>>=0,_||G(this,o,d,4,2147483647,-2147483648),0>o&&(o=4294967295+o+1),this[d]=o>>>24,this[d+1]=o>>>16,this[d+2]=o>>>8,this[d+3]=255&o,d+4},f.prototype.writeFloatLE=function(o,d,_){return ue(this,o,d,!0,_)},f.prototype.writeFloatBE=function(o,d,_){return ue(this,o,d,!1,_)},f.prototype.writeDoubleLE=function(o,d,_){return ne(this,o,d,!0,_)},f.prototype.writeDoubleBE=function(o,d,_){return ne(this,o,d,!1,_)},f.prototype.copy=function(o,d,_,A){if(!f.isBuffer(o))throw new TypeError("argument should be a Buffer");if(_||(_=0),A||A===0||(A=this.length),d>=o.length&&(d=o.length),d||(d=0),0<A&&A<_&&(A=_),A===_||o.length===0||this.length===0)return 0;if(0>d)throw new RangeError("targetStart out of bounds");if(0>_||_>=this.length)throw new RangeError("Index out of range");if(0>A)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),o.length-d<A-_&&(A=o.length-d+_);var N=A-_;if(this===o&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(d,_,A);else if(this===o&&_<d&&d<A)for(var U=N-1;0<=U;--U)o[U+d]=this[U+_];else Uint8Array.prototype.set.call(o,this.subarray(_,A),d);return N},f.prototype.fill=function(o,d,_,A){if(typeof o=="string"){if(typeof d=="string"?(A=d,d=0,_=this.length):typeof _=="string"&&(A=_,_=this.length),A!==void 0&&typeof A!="string")throw new TypeError("encoding must be a string");if(typeof A=="string"&&!f.isEncoding(A))throw new TypeError("Unknown encoding: "+A);if(o.length===1){var N=o.charCodeAt(0);(A==="utf8"&&128>N||A==="latin1")&&(o=N)}}else typeof o=="number"&&(o&=255);if(0>d||this.length<d||this.length<_)throw new RangeError("Out of range index");if(_<=d)return this;d>>>=0,_=_===void 0?this.length:_>>>0,o||(o=0);var U;if(typeof o=="number")for(U=d;U<_;++U)this[U]=o;else{var q=f.isBuffer(o)?o:f.from(o,A),oe=q.length;if(oe===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(U=0;U<_-d;++U)this[U+d]=q[U%oe]}return this};var y=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,s("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(s,l,a){(function(c){(function(){function h(){let f;try{f=a.storage.getItem("debug")}catch{}return!f&&typeof c<"u"&&"env"in c&&(f=c.env.DEBUG),f}a.formatArgs=function(f){if(f[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+f[0]+(this.useColors?"%c ":" ")+"+"+l.exports.humanize(this.diff),!this.useColors)return;const p="color: "+this.color;f.splice(1,0,p,"color: inherit");let g=0,b=0;f[0].replace(/%[a-zA-Z%]/g,v=>{v==="%%"||(g++,v==="%c"&&(b=g))}),f.splice(b,0,p)},a.save=function(f){try{f?a.storage.setItem("debug",f):a.storage.removeItem("debug")}catch{}},a.load=h,a.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},a.storage=function(){try{return localStorage}catch{}}(),a.destroy=(()=>{let f=!1;return()=>{f||(f=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),a.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],a.log=console.debug||console.log||(()=>{}),l.exports=s("./common")(a);const{formatters:u}=l.exports;u.j=function(f){try{return JSON.stringify(f)}catch(p){return"[UnexpectedJSONParseError]: "+p.message}}}).call(this)}).call(this,s("_process"))},{"./common":5,_process:12}],5:[function(s,l){l.exports=function(a){function c(f){function p(...v){if(!p.enabled)return;const D=p,x=+new Date,L=x-(g||x);D.diff=L,D.prev=g,D.curr=x,g=x,v[0]=c.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let m=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(w,E)=>{if(w==="%%")return"%";m++;const S=c.formatters[E];if(typeof S=="function"){const k=v[m];w=S.call(D,k),v.splice(m,1),m--}return w}),c.formatArgs.call(D,v),(D.log||c.log).apply(D,v)}let g,b=null;return p.namespace=f,p.useColors=c.useColors(),p.color=c.selectColor(f),p.extend=h,p.destroy=c.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>b===null?c.enabled(f):b,set:v=>{b=v}}),typeof c.init=="function"&&c.init(p),p}function h(f,p){const g=c(this.namespace+(typeof p>"u"?":":p)+f);return g.log=this.log,g}function u(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}return c.debug=c,c.default=c,c.coerce=function(f){return f instanceof Error?f.stack||f.message:f},c.disable=function(){const f=[...c.names.map(u),...c.skips.map(u).map(p=>"-"+p)].join(",");return c.enable(""),f},c.enable=function(f){c.save(f),c.names=[],c.skips=[];let p;const g=(typeof f=="string"?f:"").split(/[\s,]+/),b=g.length;for(p=0;p<b;p++)g[p]&&(f=g[p].replace(/\*/g,".*?"),f[0]==="-"?c.skips.push(new RegExp("^"+f.substr(1)+"$")):c.names.push(new RegExp("^"+f+"$")))},c.enabled=function(f){if(f[f.length-1]==="*")return!0;let p,g;for(p=0,g=c.skips.length;p<g;p++)if(c.skips[p].test(f))return!1;for(p=0,g=c.names.length;p<g;p++)if(c.names[p].test(f))return!0;return!1},c.humanize=s("ms"),c.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(a).forEach(f=>{c[f]=a[f]}),c.names=[],c.skips=[],c.formatters={},c.selectColor=function(f){let p=0;for(let g=0;g<f.length;g++)p=(p<<5)-p+f.charCodeAt(g),p|=0;return c.colors[r(p)%c.colors.length]},c.enable(c.load()),c}},{ms:11}],6:[function(s,l){function a(c,h){for(const u in h)Object.defineProperty(c,u,{value:h[u],enumerable:!0,configurable:!0});return c}l.exports=function(c,h,u){if(!c||typeof c=="string")throw new TypeError("Please pass an Error to err-code");u||(u={}),typeof h=="object"&&(u=h,h=""),h&&(u.code=h);try{return a(c,u)}catch{u.message=c.message,u.stack=c.stack;const f=function(){};return f.prototype=Object.create(Object.getPrototypeOf(c)),a(new f,u)}}},{}],7:[function(s,l){function a(C){console&&console.warn&&console.warn(C)}function c(){c.init.call(this)}function h(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}function u(C){return C._maxListeners===void 0?c.defaultMaxListeners:C._maxListeners}function f(C,R,P,z){var Z,H,W;if(h(P),H=C._events,H===void 0?(H=C._events=Object.create(null),C._eventsCount=0):(H.newListener!==void 0&&(C.emit("newListener",R,P.listener?P.listener:P),H=C._events),W=H[R]),W===void 0)W=H[R]=P,++C._eventsCount;else if(typeof W=="function"?W=H[R]=z?[P,W]:[W,P]:z?W.unshift(P):W.push(P),Z=u(C),0<Z&&W.length>Z&&!W.warned){W.warned=!0;var J=new Error("Possible EventEmitter memory leak detected. "+W.length+" "+(R+" listeners added. Use emitter.setMaxListeners() to increase limit"));J.name="MaxListenersExceededWarning",J.emitter=C,J.type=R,J.count=W.length,a(J)}return C}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(C,R,P){var z={fired:!1,wrapFn:void 0,target:C,type:R,listener:P},Z=p.bind(z);return Z.listener=P,z.wrapFn=Z,Z}function b(C,R,P){var z=C._events;if(z===void 0)return[];var Z=z[R];return Z===void 0?[]:typeof Z=="function"?P?[Z.listener||Z]:[Z]:P?L(Z):D(Z,Z.length)}function v(C){var R=this._events;if(R!==void 0){var P=R[C];if(typeof P=="function")return 1;if(P!==void 0)return P.length}return 0}function D(C,R){for(var P=Array(R),z=0;z<R;++z)P[z]=C[z];return P}function x(C,R){for(;R+1<C.length;R++)C[R]=C[R+1];C.pop()}function L(C){for(var R=Array(C.length),P=0;P<R.length;++P)R[P]=C[P].listener||C[P];return R}function m(C,R,P){typeof C.on=="function"&&w(C,"error",R,P)}function w(C,R,P,z){if(typeof C.on=="function")z.once?C.once(R,P):C.on(R,P);else if(typeof C.addEventListener=="function")C.addEventListener(R,function Z(H){z.once&&C.removeEventListener(R,Z),P(H)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}var E,S=typeof Reflect=="object"?Reflect:null,k=S&&typeof S.apply=="function"?S.apply:function(C,R,P){return Function.prototype.apply.call(C,R,P)};E=S&&typeof S.ownKeys=="function"?S.ownKeys:Object.getOwnPropertySymbols?function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:function(C){return Object.getOwnPropertyNames(C)};var T=Number.isNaN||function(C){return C!==C};l.exports=c,l.exports.once=function(C,R){return new Promise(function(P,z){function Z(W){C.removeListener(R,H),z(W)}function H(){typeof C.removeListener=="function"&&C.removeListener("error",Z),P([].slice.call(arguments))}w(C,R,H,{once:!0}),R!=="error"&&m(C,Z,{once:!0})})},c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var I=10;Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return I},set:function(C){if(typeof C!="number"||0>C||T(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");I=C}}),c.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(C){if(typeof C!="number"||0>C||T(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this},c.prototype.getMaxListeners=function(){return u(this)},c.prototype.emit=function(C){for(var R=[],P=1;P<arguments.length;P++)R.push(arguments[P]);var z=C==="error",Z=this._events;if(Z!==void 0)z=z&&Z.error===void 0;else if(!z)return!1;if(z){var H;if(0<R.length&&(H=R[0]),H instanceof Error)throw H;var W=new Error("Unhandled error."+(H?" ("+H.message+")":""));throw W.context=H,W}var J=Z[C];if(J===void 0)return!1;if(typeof J=="function")k(J,this,R);else for(var K=J.length,F=D(J,K),P=0;P<K;++P)k(F[P],this,R);return!0},c.prototype.addListener=function(C,R){return f(this,C,R,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(C,R){return f(this,C,R,!0)},c.prototype.once=function(C,R){return h(R),this.on(C,g(this,C,R)),this},c.prototype.prependOnceListener=function(C,R){return h(R),this.prependListener(C,g(this,C,R)),this},c.prototype.removeListener=function(C,R){var P,z,Z,H,W;if(h(R),z=this._events,z===void 0)return this;if(P=z[C],P===void 0)return this;if(P===R||P.listener===R)--this._eventsCount==0?this._events=Object.create(null):(delete z[C],z.removeListener&&this.emit("removeListener",C,P.listener||R));else if(typeof P!="function"){for(Z=-1,H=P.length-1;0<=H;H--)if(P[H]===R||P[H].listener===R){W=P[H].listener,Z=H;break}if(0>Z)return this;Z===0?P.shift():x(P,Z),P.length===1&&(z[C]=P[0]),z.removeListener!==void 0&&this.emit("removeListener",C,W||R)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(C){var R,P,z;if(P=this._events,P===void 0)return this;if(P.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):P[C]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete P[C]),this;if(arguments.length===0){var Z,H=Object.keys(P);for(z=0;z<H.length;++z)Z=H[z],Z!=="removeListener"&&this.removeAllListeners(Z);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(R=P[C],typeof R=="function")this.removeListener(C,R);else if(R!==void 0)for(z=R.length-1;0<=z;z--)this.removeListener(C,R[z]);return this},c.prototype.listeners=function(C){return b(this,C,!0)},c.prototype.rawListeners=function(C){return b(this,C,!1)},c.listenerCount=function(C,R){return typeof C.listenerCount=="function"?C.listenerCount(R):v.call(C,R)},c.prototype.listenerCount=v,c.prototype.eventNames=function(){return 0<this._eventsCount?E(this._events):[]}},{}],8:[function(s,l){l.exports=function(){if(typeof globalThis>"u")return null;var a={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return a.RTCPeerConnection?a:null}},{}],9:[function(s,l,a){a.read=function(c,h,u,f,p){var g,b,v=8*p-f-1,D=(1<<v)-1,x=D>>1,L=-7,m=u?p-1:0,w=u?-1:1,E=c[h+m];for(m+=w,g=E&(1<<-L)-1,E>>=-L,L+=v;0<L;g=256*g+c[h+m],m+=w,L-=8);for(b=g&(1<<-L)-1,g>>=-L,L+=f;0<L;b=256*b+c[h+m],m+=w,L-=8);if(g===0)g=1-x;else{if(g===D)return b?NaN:(E?-1:1)*(1/0);b+=i(2,f),g-=x}return(E?-1:1)*b*i(2,g-f)},a.write=function(c,h,u,f,p,g){var b,v,D,x=Math.LN2,L=Math.log,m=8*g-p-1,w=(1<<m)-1,E=w>>1,S=p===23?i(2,-24)-i(2,-77):0,k=f?0:g-1,T=f?1:-1,I=0>h||h===0&&0>1/h?1:0;for(h=r(h),isNaN(h)||h===1/0?(v=isNaN(h)?1:0,b=w):(b=n(L(h)/x),1>h*(D=i(2,-b))&&(b--,D*=2),h+=1<=b+E?S/D:S*i(2,1-E),2<=h*D&&(b++,D/=2),b+E>=w?(v=0,b=w):1<=b+E?(v=(h*D-1)*i(2,p),b+=E):(v=h*i(2,E-1)*i(2,p),b=0));8<=p;c[u+k]=255&v,k+=T,v/=256,p-=8);for(b=b<<p|v,m+=p;0<m;c[u+k]=255&b,k+=T,b/=256,m-=8);c[u+k-T]|=128*I}},{}],10:[function(s,l){l.exports=typeof Object.create=="function"?function(a,c){c&&(a.super_=c,a.prototype=Object.create(c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:function(a,c){if(c){a.super_=c;var h=function(){};h.prototype=c.prototype,a.prototype=new h,a.prototype.constructor=a}}},{}],11:[function(s,l){var a=Math.round;function c(p){if(p+="",!(100<p.length)){var g=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(g){var b=parseFloat(g[1]),v=(g[2]||"ms").toLowerCase();return v==="years"||v==="year"||v==="yrs"||v==="yr"||v==="y"?315576e5*b:v==="weeks"||v==="week"||v==="w"?6048e5*b:v==="days"||v==="day"||v==="d"?864e5*b:v==="hours"||v==="hour"||v==="hrs"||v==="hr"||v==="h"?36e5*b:v==="minutes"||v==="minute"||v==="mins"||v==="min"||v==="m"?6e4*b:v==="seconds"||v==="second"||v==="secs"||v==="sec"||v==="s"?1e3*b:v==="milliseconds"||v==="millisecond"||v==="msecs"||v==="msec"||v==="ms"?b:void 0}}}function h(p){var g=r(p);return 864e5<=g?a(p/864e5)+"d":36e5<=g?a(p/36e5)+"h":6e4<=g?a(p/6e4)+"m":1e3<=g?a(p/1e3)+"s":p+"ms"}function u(p){var g=r(p);return 864e5<=g?f(p,g,864e5,"day"):36e5<=g?f(p,g,36e5,"hour"):6e4<=g?f(p,g,6e4,"minute"):1e3<=g?f(p,g,1e3,"second"):p+" ms"}function f(p,g,b,v){return a(p/b)+" "+v+(g>=1.5*b?"s":"")}l.exports=function(p,g){g=g||{};var b=typeof p;if(b=="string"&&0<p.length)return c(p);if(b==="number"&&isFinite(p))return g.long?u(p):h(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))}},{}],12:[function(s,l){function a(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function h(S){if(v===setTimeout)return setTimeout(S,0);if((v===a||!v)&&setTimeout)return v=setTimeout,setTimeout(S,0);try{return v(S,0)}catch{try{return v.call(null,S,0)}catch{return v.call(this,S,0)}}}function u(S){if(D===clearTimeout)return clearTimeout(S);if((D===c||!D)&&clearTimeout)return D=clearTimeout,clearTimeout(S);try{return D(S)}catch{try{return D.call(null,S)}catch{return D.call(this,S)}}}function f(){w&&L&&(w=!1,L.length?m=L.concat(m):E=-1,m.length&&p())}function p(){if(!w){var S=h(f);w=!0;for(var k=m.length;k;){for(L=m,m=[];++E<k;)L&&L[E].run();E=-1,k=m.length}L=null,w=!1,u(S)}}function g(S,k){this.fun=S,this.array=k}function b(){}var v,D,x=l.exports={};(function(){try{v=typeof setTimeout=="function"?setTimeout:a}catch{v=a}try{D=typeof clearTimeout=="function"?clearTimeout:c}catch{D=c}})();var L,m=[],w=!1,E=-1;x.nextTick=function(S){var k=Array(arguments.length-1);if(1<arguments.length)for(var T=1;T<arguments.length;T++)k[T-1]=arguments[T];m.push(new g(S,k)),m.length!==1||w||h(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},x.title="browser",x.browser=!0,x.env={},x.argv=[],x.version="",x.versions={},x.on=b,x.addListener=b,x.once=b,x.off=b,x.removeListener=b,x.removeAllListeners=b,x.emit=b,x.prependListener=b,x.prependOnceListener=b,x.listeners=function(){return[]},x.binding=function(){throw new Error("process.binding is not supported")},x.cwd=function(){return"/"},x.chdir=function(){throw new Error("process.chdir is not supported")},x.umask=function(){return 0}},{}],13:[function(s,l){(function(a){(function(){let c;l.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?a:window):h=>(c||(c=Promise.resolve())).then(h).catch(u=>setTimeout(()=>{throw u},0))}).call(this)}).call(this,typeof wt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:wt)},{}],14:[function(s,l){(function(a,c){(function(){var h=s("safe-buffer").Buffer,u=c.crypto||c.msCrypto;l.exports=u&&u.getRandomValues?function(f,p){if(f>4294967295)throw new RangeError("requested too many random bytes");var g=h.allocUnsafe(f);if(0<f)if(65536<f)for(var b=0;b<f;b+=65536)u.getRandomValues(g.slice(b,b+65536));else u.getRandomValues(g);return typeof p=="function"?a.nextTick(function(){p(null,g)}):g}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,s("_process"),typeof wt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:wt)},{_process:12,"safe-buffer":30}],15:[function(s,l){function a(b,v){b.prototype=Object.create(v.prototype),b.prototype.constructor=b,b.__proto__=v}function c(b,v,D){function x(m,w,E){return typeof v=="string"?v:v(m,w,E)}D||(D=Error);var L=function(m){function w(E,S,k){return m.call(this,x(E,S,k))||this}return a(w,m),w}(D);L.prototype.name=D.name,L.prototype.code=b,g[b]=L}function h(b,v){if(Array.isArray(b)){var D=b.length;return b=b.map(function(x){return x+""}),2<D?"one of ".concat(v," ").concat(b.slice(0,D-1).join(", "),", or ")+b[D-1]:D===2?"one of ".concat(v," ").concat(b[0]," or ").concat(b[1]):"of ".concat(v," ").concat(b[0])}return"of ".concat(v," ").concat(b+"")}function u(b,v,D){return b.substr(!D||0>D?0:+D,v.length)===v}function f(b,v,D){return(D===void 0||D>b.length)&&(D=b.length),b.substring(D-v.length,D)===v}function p(b,v,D){return typeof D!="number"&&(D=0),!(D+v.length>b.length)&&b.indexOf(v,D)!==-1}var g={};c("ERR_INVALID_OPT_VALUE",function(b,v){return'The value "'+v+'" is invalid for option "'+b+'"'},TypeError),c("ERR_INVALID_ARG_TYPE",function(b,v,D){var x;typeof v=="string"&&u(v,"not ")?(x="must not be",v=v.replace(/^not /,"")):x="must be";var L;if(f(b," argument"))L="The ".concat(b," ").concat(x," ").concat(h(v,"type"));else{var m=p(b,".")?"property":"argument";L='The "'.concat(b,'" ').concat(m," ").concat(x," ").concat(h(v,"type"))}return L+=". Received type ".concat(typeof D),L},TypeError),c("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),c("ERR_METHOD_NOT_IMPLEMENTED",function(b){return"The "+b+" method is not implemented"}),c("ERR_STREAM_PREMATURE_CLOSE","Premature close"),c("ERR_STREAM_DESTROYED",function(b){return"Cannot call "+b+" after a stream was destroyed"}),c("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),c("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),c("ERR_STREAM_WRITE_AFTER_END","write after end"),c("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),c("ERR_UNKNOWN_ENCODING",function(b){return"Unknown encoding: "+b},TypeError),c("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),l.exports.codes=g},{}],16:[function(s,l){(function(a){(function(){function c(x){return this instanceof c?(p.call(this,x),g.call(this,x),this.allowHalfOpen=!0,void(x&&(x.readable===!1&&(this.readable=!1),x.writable===!1&&(this.writable=!1),x.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h))))):new c(x)}function h(){this._writableState.ended||a.nextTick(u,this)}function u(x){x.end()}var f=Object.keys||function(x){var L=[];for(var m in x)L.push(m);return L};l.exports=c;var p=s("./_stream_readable"),g=s("./_stream_writable");s("inherits")(c,p);for(var b,v=f(g.prototype),D=0;D<v.length;D++)b=v[D],c.prototype[b]||(c.prototype[b]=g.prototype[b]);Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(x){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=x,this._writableState.destroyed=x)}})}).call(this)}).call(this,s("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(s,l){function a(h){return this instanceof a?void c.call(this,h):new a(h)}l.exports=a;var c=s("./_stream_transform");s("inherits")(a,c),a.prototype._transform=function(h,u,f){f(null,h)}},{"./_stream_transform":19,inherits:10}],18:[function(s,l){(function(a,c){(function(){function h(y){return Me.from(y)}function u(y){return Me.isBuffer(y)||y instanceof ie}function f(y,o,d){return typeof y.prependListener=="function"?y.prependListener(o,d):void(y._events&&y._events[o]?Array.isArray(y._events[o])?y._events[o].unshift(d):y._events[o]=[d,y._events[o]]:y.on(o,d))}function p(y,o,d){K=K||s("./_stream_duplex"),y=y||{},typeof d!="boolean"&&(d=o instanceof K),this.objectMode=!!y.objectMode,d&&(this.objectMode=this.objectMode||!!y.readableObjectMode),this.highWaterMark=He(this,y,"readableHighWaterMark",d),this.buffer=new fe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=y.emitClose!==!1,this.autoDestroy=!!y.autoDestroy,this.destroyed=!1,this.defaultEncoding=y.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,y.encoding&&(!he&&(he=s("string_decoder/").StringDecoder),this.decoder=new he(y.encoding),this.encoding=y.encoding)}function g(y){if(K=K||s("./_stream_duplex"),!(this instanceof g))return new g(y);var o=this instanceof K;this._readableState=new p(y,this,o),this.readable=!0,y&&(typeof y.read=="function"&&(this._read=y.read),typeof y.destroy=="function"&&(this._destroy=y.destroy)),Ee.call(this)}function b(y,o,d,_,A){F("readableAddChunk",o);var N=y._readableState;if(o===null)N.reading=!1,m(y,N);else{var U;if(A||(U=D(N,o)),U)B(y,U);else if(!(N.objectMode||o&&0<o.length))_||(N.reading=!1,S(y,N));else if(typeof o=="string"||N.objectMode||Object.getPrototypeOf(o)===Me.prototype||(o=h(o)),_)N.endEmitted?B(y,new M):v(y,N,o,!0);else if(N.ended)B(y,new Pe);else{if(N.destroyed)return!1;N.reading=!1,N.decoder&&!d?(o=N.decoder.write(o),N.objectMode||o.length!==0?v(y,N,o,!1):S(y,N)):v(y,N,o,!1)}}return!N.ended&&(N.length<N.highWaterMark||N.length===0)}function v(y,o,d,_){o.flowing&&o.length===0&&!o.sync?(o.awaitDrain=0,y.emit("data",d)):(o.length+=o.objectMode?1:d.length,_?o.buffer.unshift(d):o.buffer.push(d),o.needReadable&&w(y)),S(y,o)}function D(y,o){var d;return u(o)||typeof o=="string"||o===void 0||y.objectMode||(d=new Ue("chunk",["string","Buffer","Uint8Array"],o)),d}function x(y){return 1073741824<=y?y=1073741824:(y--,y|=y>>>1,y|=y>>>2,y|=y>>>4,y|=y>>>8,y|=y>>>16,y++),y}function L(y,o){return 0>=y||o.length===0&&o.ended?0:o.objectMode?1:y===y?(y>o.highWaterMark&&(o.highWaterMark=x(y)),y<=o.length?y:o.ended?o.length:(o.needReadable=!0,0)):o.flowing&&o.length?o.buffer.head.data.length:o.length}function m(y,o){if(F("onEofChunk"),!o.ended){if(o.decoder){var d=o.decoder.end();d&&d.length&&(o.buffer.push(d),o.length+=o.objectMode?1:d.length)}o.ended=!0,o.sync?w(y):(o.needReadable=!1,!o.emittedReadable&&(o.emittedReadable=!0,E(y)))}}function w(y){var o=y._readableState;F("emitReadable",o.needReadable,o.emittedReadable),o.needReadable=!1,o.emittedReadable||(F("emitReadable",o.flowing),o.emittedReadable=!0,a.nextTick(E,y))}function E(y){var o=y._readableState;F("emitReadable_",o.destroyed,o.length,o.ended),!o.destroyed&&(o.length||o.ended)&&(y.emit("readable"),o.emittedReadable=!1),o.needReadable=!o.flowing&&!o.ended&&o.length<=o.highWaterMark,z(y)}function S(y,o){o.readingMore||(o.readingMore=!0,a.nextTick(k,y,o))}function k(y,o){for(;!o.reading&&!o.ended&&(o.length<o.highWaterMark||o.flowing&&o.length===0);){var d=o.length;if(F("maybeReadMore read 0"),y.read(0),d===o.length)break}o.readingMore=!1}function T(y){return function(){var o=y._readableState;F("pipeOnDrain",o.awaitDrain),o.awaitDrain&&o.awaitDrain--,o.awaitDrain===0&&ke(y,"data")&&(o.flowing=!0,z(y))}}function I(y){var o=y._readableState;o.readableListening=0<y.listenerCount("readable"),o.resumeScheduled&&!o.paused?o.flowing=!0:0<y.listenerCount("data")&&y.resume()}function C(y){F("readable nexttick read 0"),y.read(0)}function R(y,o){o.resumeScheduled||(o.resumeScheduled=!0,a.nextTick(P,y,o))}function P(y,o){F("resume",o.reading),o.reading||y.read(0),o.resumeScheduled=!1,y.emit("resume"),z(y),o.flowing&&!o.reading&&y.read(0)}function z(y){var o=y._readableState;for(F("flow",o.flowing);o.flowing&&y.read()!==null;);}function Z(y,o){if(o.length===0)return null;var d;return o.objectMode?d=o.buffer.shift():!y||y>=o.length?(d=o.decoder?o.buffer.join(""):o.buffer.length===1?o.buffer.first():o.buffer.concat(o.length),o.buffer.clear()):d=o.buffer.consume(y,o.decoder),d}function H(y){var o=y._readableState;F("endReadable",o.endEmitted),o.endEmitted||(o.ended=!0,a.nextTick(W,o,y))}function W(y,o){if(F("endReadableNT",y.endEmitted,y.length),!y.endEmitted&&y.length===0&&(y.endEmitted=!0,o.readable=!1,o.emit("end"),y.autoDestroy)){var d=o._writableState;(!d||d.autoDestroy&&d.finished)&&o.destroy()}}function J(y,o){for(var d=0,_=y.length;d<_;d++)if(y[d]===o)return d;return-1}l.exports=g;var K;g.ReadableState=p;var F;s("events").EventEmitter;var ke=function(y,o){return y.listeners(o).length},Ee=s("./internal/streams/stream"),Me=s("buffer").Buffer,ie=c.Uint8Array||function(){},G=s("util");F=G&&G.debuglog?G.debuglog("stream"):function(){};var he,ue,ne,fe=s("./internal/streams/buffer_list"),je=s("./internal/streams/destroy"),Fe=s("./internal/streams/state"),He=Fe.getHighWaterMark,rt=s("../errors").codes,Ue=rt.ERR_INVALID_ARG_TYPE,Pe=rt.ERR_STREAM_PUSH_AFTER_EOF,O=rt.ERR_METHOD_NOT_IMPLEMENTED,M=rt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;s("inherits")(g,Ee);var B=je.errorOrDestroy,$=["error","close","destroy","pause","resume"];Object.defineProperty(g.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(y){this._readableState&&(this._readableState.destroyed=y)}}),g.prototype.destroy=je.destroy,g.prototype._undestroy=je.undestroy,g.prototype._destroy=function(y,o){o(y)},g.prototype.push=function(y,o){var d,_=this._readableState;return _.objectMode?d=!0:typeof y=="string"&&(o=o||_.defaultEncoding,o!==_.encoding&&(y=Me.from(y,o),o=""),d=!0),b(this,y,o,!1,d)},g.prototype.unshift=function(y){return b(this,y,null,!0,!1)},g.prototype.isPaused=function(){return this._readableState.flowing===!1},g.prototype.setEncoding=function(y){he||(he=s("string_decoder/").StringDecoder);var o=new he(y);this._readableState.decoder=o,this._readableState.encoding=this._readableState.decoder.encoding;for(var d=this._readableState.buffer.head,_="";d!==null;)_+=o.write(d.data),d=d.next;return this._readableState.buffer.clear(),_!==""&&this._readableState.buffer.push(_),this._readableState.length=_.length,this},g.prototype.read=function(y){F("read",y),y=parseInt(y,10);var o=this._readableState,d=y;if(y!==0&&(o.emittedReadable=!1),y===0&&o.needReadable&&((o.highWaterMark===0?0<o.length:o.length>=o.highWaterMark)||o.ended))return F("read: emitReadable",o.length,o.ended),o.length===0&&o.ended?H(this):w(this),null;if(y=L(y,o),y===0&&o.ended)return o.length===0&&H(this),null;var _=o.needReadable;F("need readable",_),(o.length===0||o.length-y<o.highWaterMark)&&(_=!0,F("length less than watermark",_)),o.ended||o.reading?(_=!1,F("reading or ended",_)):_&&(F("do read"),o.reading=!0,o.sync=!0,o.length===0&&(o.needReadable=!0),this._read(o.highWaterMark),o.sync=!1,!o.reading&&(y=L(d,o)));var A;return A=0<y?Z(y,o):null,A===null?(o.needReadable=o.length<=o.highWaterMark,y=0):(o.length-=y,o.awaitDrain=0),o.length===0&&(!o.ended&&(o.needReadable=!0),d!==y&&o.ended&&H(this)),A!==null&&this.emit("data",A),A},g.prototype._read=function(){B(this,new O("_read()"))},g.prototype.pipe=function(y,o){function d(An,Rn){F("onunpipe"),An===ae&&Rn&&Rn.hasUnpiped===!1&&(Rn.hasUnpiped=!0,A())}function _(){F("onend"),y.end()}function A(){F("cleanup"),y.removeListener("close",q),y.removeListener("finish",oe),y.removeListener("drain",Sn),y.removeListener("error",U),y.removeListener("unpipe",d),ae.removeListener("end",_),ae.removeListener("end",_e),ae.removeListener("data",N),hr=!0,se.awaitDrain&&(!y._writableState||y._writableState.needDrain)&&Sn()}function N(An){F("ondata");var Rn=y.write(An);F("dest.write",Rn),Rn===!1&&((se.pipesCount===1&&se.pipes===y||1<se.pipesCount&&J(se.pipes,y)!==-1)&&!hr&&(F("false write response, pause",se.awaitDrain),se.awaitDrain++),ae.pause())}function U(An){F("onerror",An),_e(),y.removeListener("error",U),ke(y,"error")===0&&B(y,An)}function q(){y.removeListener("finish",oe),_e()}function oe(){F("onfinish"),y.removeListener("close",q),_e()}function _e(){F("unpipe"),ae.unpipe(y)}var ae=this,se=this._readableState;switch(se.pipesCount){case 0:se.pipes=y;break;case 1:se.pipes=[se.pipes,y];break;default:se.pipes.push(y)}se.pipesCount+=1,F("pipe count=%d opts=%j",se.pipesCount,o);var Le=(!o||o.end!==!1)&&y!==a.stdout&&y!==a.stderr,nn=Le?_:_e;se.endEmitted?a.nextTick(nn):ae.once("end",nn),y.on("unpipe",d);var Sn=T(ae);y.on("drain",Sn);var hr=!1;return ae.on("data",N),f(y,"error",U),y.once("close",q),y.once("finish",oe),y.emit("pipe",ae),se.flowing||(F("pipe resume"),ae.resume()),y},g.prototype.unpipe=function(y){var o=this._readableState,d={hasUnpiped:!1};if(o.pipesCount===0)return this;if(o.pipesCount===1)return y&&y!==o.pipes?this:(y||(y=o.pipes),o.pipes=null,o.pipesCount=0,o.flowing=!1,y&&y.emit("unpipe",this,d),this);if(!y){var _=o.pipes,A=o.pipesCount;o.pipes=null,o.pipesCount=0,o.flowing=!1;for(var N=0;N<A;N++)_[N].emit("unpipe",this,{hasUnpiped:!1});return this}var U=J(o.pipes,y);return U===-1?this:(o.pipes.splice(U,1),o.pipesCount-=1,o.pipesCount===1&&(o.pipes=o.pipes[0]),y.emit("unpipe",this,d),this)},g.prototype.on=function(y,o){var d=Ee.prototype.on.call(this,y,o),_=this._readableState;return y==="data"?(_.readableListening=0<this.listenerCount("readable"),_.flowing!==!1&&this.resume()):y=="readable"&&!_.endEmitted&&!_.readableListening&&(_.readableListening=_.needReadable=!0,_.flowing=!1,_.emittedReadable=!1,F("on readable",_.length,_.reading),_.length?w(this):!_.reading&&a.nextTick(C,this)),d},g.prototype.addListener=g.prototype.on,g.prototype.removeListener=function(y,o){var d=Ee.prototype.removeListener.call(this,y,o);return y==="readable"&&a.nextTick(I,this),d},g.prototype.removeAllListeners=function(y){var o=Ee.prototype.removeAllListeners.apply(this,arguments);return(y==="readable"||y===void 0)&&a.nextTick(I,this),o},g.prototype.resume=function(){var y=this._readableState;return y.flowing||(F("resume"),y.flowing=!y.readableListening,R(this,y)),y.paused=!1,this},g.prototype.pause=function(){return F("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(F("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},g.prototype.wrap=function(y){var o=this,d=this._readableState,_=!1;for(var A in y.on("end",function(){if(F("wrapped end"),d.decoder&&!d.ended){var U=d.decoder.end();U&&U.length&&o.push(U)}o.push(null)}),y.on("data",function(U){if(F("wrapped data"),d.decoder&&(U=d.decoder.write(U)),!(d.objectMode&&U==null)&&(d.objectMode||U&&U.length)){var q=o.push(U);q||(_=!0,y.pause())}}),y)this[A]===void 0&&typeof y[A]=="function"&&(this[A]=function(U){return function(){return y[U].apply(y,arguments)}}(A));for(var N=0;N<$.length;N++)y.on($[N],this.emit.bind(this,$[N]));return this._read=function(U){F("wrapped _read",U),_&&(_=!1,y.resume())},this},typeof Symbol=="function"&&(g.prototype[Symbol.asyncIterator]=function(){return ue===void 0&&(ue=s("./internal/streams/async_iterator")),ue(this)}),Object.defineProperty(g.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(g.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(g.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(y){this._readableState&&(this._readableState.flowing=y)}}),g._fromList=Z,Object.defineProperty(g.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(g.from=function(y,o){return ne===void 0&&(ne=s("./internal/streams/from")),ne(g,y,o)})}).call(this)}).call(this,s("_process"),typeof wt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:wt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(s,l){function a(x,L){var m=this._transformState;m.transforming=!1;var w=m.writecb;if(w===null)return this.emit("error",new g);m.writechunk=null,m.writecb=null,L!=null&&this.push(L),w(x);var E=this._readableState;E.reading=!1,(E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}function c(x){return this instanceof c?(D.call(this,x),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,x&&(typeof x.transform=="function"&&(this._transform=x.transform),typeof x.flush=="function"&&(this._flush=x.flush)),void this.on("prefinish",h)):new c(x)}function h(){var x=this;typeof this._flush!="function"||this._readableState.destroyed?u(this,null,null):this._flush(function(L,m){u(x,L,m)})}function u(x,L,m){if(L)return x.emit("error",L);if(m!=null&&x.push(m),x._writableState.length)throw new v;if(x._transformState.transforming)throw new b;return x.push(null)}l.exports=c;var f=s("../errors").codes,p=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,b=f.ERR_TRANSFORM_ALREADY_TRANSFORMING,v=f.ERR_TRANSFORM_WITH_LENGTH_0,D=s("./_stream_duplex");s("inherits")(c,D),c.prototype.push=function(x,L){return this._transformState.needTransform=!1,D.prototype.push.call(this,x,L)},c.prototype._transform=function(x,L,m){m(new p("_transform()"))},c.prototype._write=function(x,L,m){var w=this._transformState;if(w.writecb=m,w.writechunk=x,w.writeencoding=L,!w.transforming){var E=this._readableState;(w.needTransform||E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}},c.prototype._read=function(){var x=this._transformState;x.writechunk===null||x.transforming?x.needTransform=!0:(x.transforming=!0,this._transform(x.writechunk,x.writeencoding,x.afterTransform))},c.prototype._destroy=function(x,L){D.prototype._destroy.call(this,x,function(m){L(m)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(s,l){(function(a,c){(function(){function h(O){var M=this;this.next=null,this.entry=null,this.finish=function(){H(M,O)}}function u(O){return F.from(O)}function f(O){return F.isBuffer(O)||O instanceof ke}function p(){}function g(O,M,B){W=W||s("./_stream_duplex"),O=O||{},typeof B!="boolean"&&(B=M instanceof W),this.objectMode=!!O.objectMode,B&&(this.objectMode=this.objectMode||!!O.writableObjectMode),this.highWaterMark=ie(this,O,"writableHighWaterMark",B),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var $=O.decodeStrings===!1;this.decodeStrings=!$,this.defaultEncoding=O.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(y){S(M,y)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=O.emitClose!==!1,this.autoDestroy=!!O.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new h(this)}function b(O){W=W||s("./_stream_duplex");var M=this instanceof W;return M||Pe.call(b,this)?(this._writableState=new g(O,this,M),this.writable=!0,O&&(typeof O.write=="function"&&(this._write=O.write),typeof O.writev=="function"&&(this._writev=O.writev),typeof O.destroy=="function"&&(this._destroy=O.destroy),typeof O.final=="function"&&(this._final=O.final)),void K.call(this)):new b(O)}function v(O,M){var B=new He;Ue(O,B),a.nextTick(M,B)}function D(O,M,B,$){var y;return B===null?y=new Fe:typeof B!="string"&&!M.objectMode&&(y=new he("chunk",["string","Buffer"],B)),!y||(Ue(O,y),a.nextTick($,y),!1)}function x(O,M,B){return O.objectMode||O.decodeStrings===!1||typeof M!="string"||(M=F.from(M,B)),M}function L(O,M,B,$,y,o){if(!B){var d=x(M,$,y);$!==d&&(B=!0,y="buffer",$=d)}var _=M.objectMode?1:$.length;M.length+=_;var A=M.length<M.highWaterMark;if(A||(M.needDrain=!0),M.writing||M.corked){var N=M.lastBufferedRequest;M.lastBufferedRequest={chunk:$,encoding:y,isBuf:B,callback:o,next:null},N?N.next=M.lastBufferedRequest:M.bufferedRequest=M.lastBufferedRequest,M.bufferedRequestCount+=1}else m(O,M,!1,_,$,y,o);return A}function m(O,M,B,$,y,o,d){M.writelen=$,M.writecb=d,M.writing=!0,M.sync=!0,M.destroyed?M.onwrite(new je("write")):B?O._writev(y,M.onwrite):O._write(y,o,M.onwrite),M.sync=!1}function w(O,M,B,$,y){--M.pendingcb,B?(a.nextTick(y,$),a.nextTick(z,O,M),O._writableState.errorEmitted=!0,Ue(O,$)):(y($),O._writableState.errorEmitted=!0,Ue(O,$),z(O,M))}function E(O){O.writing=!1,O.writecb=null,O.length-=O.writelen,O.writelen=0}function S(O,M){var B=O._writableState,$=B.sync,y=B.writecb;if(typeof y!="function")throw new ne;if(E(B),M)w(O,B,$,M,y);else{var o=C(B)||O.destroyed;o||B.corked||B.bufferProcessing||!B.bufferedRequest||I(O,B),$?a.nextTick(k,O,B,o,y):k(O,B,o,y)}}function k(O,M,B,$){B||T(O,M),M.pendingcb--,$(),z(O,M)}function T(O,M){M.length===0&&M.needDrain&&(M.needDrain=!1,O.emit("drain"))}function I(O,M){M.bufferProcessing=!0;var B=M.bufferedRequest;if(O._writev&&B&&B.next){var $=M.bufferedRequestCount,y=Array($),o=M.corkedRequestsFree;o.entry=B;for(var d=0,_=!0;B;)y[d]=B,B.isBuf||(_=!1),B=B.next,d+=1;y.allBuffers=_,m(O,M,!0,M.length,y,"",o.finish),M.pendingcb++,M.lastBufferedRequest=null,o.next?(M.corkedRequestsFree=o.next,o.next=null):M.corkedRequestsFree=new h(M),M.bufferedRequestCount=0}else{for(;B;){var A=B.chunk,N=B.encoding,U=B.callback,q=M.objectMode?1:A.length;if(m(O,M,!1,q,A,N,U),B=B.next,M.bufferedRequestCount--,M.writing)break}B===null&&(M.lastBufferedRequest=null)}M.bufferedRequest=B,M.bufferProcessing=!1}function C(O){return O.ending&&O.length===0&&O.bufferedRequest===null&&!O.finished&&!O.writing}function R(O,M){O._final(function(B){M.pendingcb--,B&&Ue(O,B),M.prefinished=!0,O.emit("prefinish"),z(O,M)})}function P(O,M){M.prefinished||M.finalCalled||(typeof O._final!="function"||M.destroyed?(M.prefinished=!0,O.emit("prefinish")):(M.pendingcb++,M.finalCalled=!0,a.nextTick(R,O,M)))}function z(O,M){var B=C(M);if(B&&(P(O,M),M.pendingcb===0&&(M.finished=!0,O.emit("finish"),M.autoDestroy))){var $=O._readableState;(!$||$.autoDestroy&&$.endEmitted)&&O.destroy()}return B}function Z(O,M,B){M.ending=!0,z(O,M),B&&(M.finished?a.nextTick(B):O.once("finish",B)),M.ended=!0,O.writable=!1}function H(O,M,B){var $=O.entry;for(O.entry=null;$;){var y=$.callback;M.pendingcb--,y(B),$=$.next}M.corkedRequestsFree.next=O}l.exports=b;var W;b.WritableState=g;var J={deprecate:s("util-deprecate")},K=s("./internal/streams/stream"),F=s("buffer").Buffer,ke=c.Uint8Array||function(){},Ee=s("./internal/streams/destroy"),Me=s("./internal/streams/state"),ie=Me.getHighWaterMark,G=s("../errors").codes,he=G.ERR_INVALID_ARG_TYPE,ue=G.ERR_METHOD_NOT_IMPLEMENTED,ne=G.ERR_MULTIPLE_CALLBACK,fe=G.ERR_STREAM_CANNOT_PIPE,je=G.ERR_STREAM_DESTROYED,Fe=G.ERR_STREAM_NULL_VALUES,He=G.ERR_STREAM_WRITE_AFTER_END,rt=G.ERR_UNKNOWN_ENCODING,Ue=Ee.errorOrDestroy;s("inherits")(b,K),g.prototype.getBuffer=function(){for(var O=this.bufferedRequest,M=[];O;)M.push(O),O=O.next;return M},function(){try{Object.defineProperty(g.prototype,"buffer",{get:J.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var Pe;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Pe=Function.prototype[Symbol.hasInstance],Object.defineProperty(b,Symbol.hasInstance,{value:function(O){return!!Pe.call(this,O)||this===b&&O&&O._writableState instanceof g}})):Pe=function(O){return O instanceof this},b.prototype.pipe=function(){Ue(this,new fe)},b.prototype.write=function(O,M,B){var $=this._writableState,y=!1,o=!$.objectMode&&f(O);return o&&!F.isBuffer(O)&&(O=u(O)),typeof M=="function"&&(B=M,M=null),o?M="buffer":!M&&(M=$.defaultEncoding),typeof B!="function"&&(B=p),$.ending?v(this,B):(o||D(this,$,O,B))&&($.pendingcb++,y=L(this,$,o,O,M,B)),y},b.prototype.cork=function(){this._writableState.corked++},b.prototype.uncork=function(){var O=this._writableState;O.corked&&(O.corked--,!O.writing&&!O.corked&&!O.bufferProcessing&&O.bufferedRequest&&I(this,O))},b.prototype.setDefaultEncoding=function(O){if(typeof O=="string"&&(O=O.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((O+"").toLowerCase())))throw new rt(O);return this._writableState.defaultEncoding=O,this},Object.defineProperty(b.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),b.prototype._write=function(O,M,B){B(new ue("_write()"))},b.prototype._writev=null,b.prototype.end=function(O,M,B){var $=this._writableState;return typeof O=="function"?(B=O,O=null,M=null):typeof M=="function"&&(B=M,M=null),O!=null&&this.write(O,M),$.corked&&($.corked=1,this.uncork()),$.ending||Z(this,$,B),this},Object.defineProperty(b.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(b.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(O){this._writableState&&(this._writableState.destroyed=O)}}),b.prototype.destroy=Ee.destroy,b.prototype._undestroy=Ee.undestroy,b.prototype._destroy=function(O,M){M(O)}}).call(this)}).call(this,s("_process"),typeof wt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:wt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(s,l){(function(a){(function(){function c(T,I,C){return I in T?Object.defineProperty(T,I,{value:C,enumerable:!0,configurable:!0,writable:!0}):T[I]=C,T}function h(T,I){return{value:T,done:I}}function u(T){var I=T[v];if(I!==null){var C=T[E].read();C!==null&&(T[m]=null,T[v]=null,T[D]=null,I(h(C,!1)))}}function f(T){a.nextTick(u,T)}function p(T,I){return function(C,R){T.then(function(){return I[L]?void C(h(void 0,!0)):void I[w](C,R)},R)}}var g,b=s("./end-of-stream"),v=Symbol("lastResolve"),D=Symbol("lastReject"),x=Symbol("error"),L=Symbol("ended"),m=Symbol("lastPromise"),w=Symbol("handlePromise"),E=Symbol("stream"),S=Object.getPrototypeOf(function(){}),k=Object.setPrototypeOf((g={get stream(){return this[E]},next:function(){var T=this,I=this[x];if(I!==null)return Promise.reject(I);if(this[L])return Promise.resolve(h(void 0,!0));if(this[E].destroyed)return new Promise(function(z,Z){a.nextTick(function(){T[x]?Z(T[x]):z(h(void 0,!0))})});var C,R=this[m];if(R)C=new Promise(p(R,this));else{var P=this[E].read();if(P!==null)return Promise.resolve(h(P,!1));C=new Promise(this[w])}return this[m]=C,C}},c(g,Symbol.asyncIterator,function(){return this}),c(g,"return",function(){var T=this;return new Promise(function(I,C){T[E].destroy(null,function(R){return R?void C(R):void I(h(void 0,!0))})})}),g),S);l.exports=function(T){var I,C=Object.create(k,(I={},c(I,E,{value:T,writable:!0}),c(I,v,{value:null,writable:!0}),c(I,D,{value:null,writable:!0}),c(I,x,{value:null,writable:!0}),c(I,L,{value:T._readableState.endEmitted,writable:!0}),c(I,w,{value:function(R,P){var z=C[E].read();z?(C[m]=null,C[v]=null,C[D]=null,R(h(z,!1))):(C[v]=R,C[D]=P)},writable:!0}),I));return C[m]=null,b(T,function(R){if(R&&R.code!=="ERR_STREAM_PREMATURE_CLOSE"){var P=C[D];return P!==null&&(C[m]=null,C[v]=null,C[D]=null,P(R)),void(C[x]=R)}var z=C[v];z!==null&&(C[m]=null,C[v]=null,C[D]=null,z(h(void 0,!0))),C[L]=!0}),T.on("readable",f.bind(null,C)),C}}).call(this)}).call(this,s("_process"))},{"./end-of-stream":24,_process:12}],22:[function(s,l){function a(m,w){var E=Object.keys(m);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(m);w&&(S=S.filter(function(k){return Object.getOwnPropertyDescriptor(m,k).enumerable})),E.push.apply(E,S)}return E}function c(m){for(var w,E=1;E<arguments.length;E++)w=arguments[E]==null?{}:arguments[E],E%2?a(Object(w),!0).forEach(function(S){h(m,S,w[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(w)):a(Object(w)).forEach(function(S){Object.defineProperty(m,S,Object.getOwnPropertyDescriptor(w,S))});return m}function h(m,w,E){return w in m?Object.defineProperty(m,w,{value:E,enumerable:!0,configurable:!0,writable:!0}):m[w]=E,m}function u(m,w){if(!(m instanceof w))throw new TypeError("Cannot call a class as a function")}function f(m,w){for(var E,S=0;S<w.length;S++)E=w[S],E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(m,E.key,E)}function p(m,w,E){return w&&f(m.prototype,w),E&&f(m,E),m}function g(m,w,E){v.prototype.copy.call(m,w,E)}var b=s("buffer"),v=b.Buffer,D=s("util"),x=D.inspect,L=x&&x.custom||"inspect";l.exports=function(){function m(){u(this,m),this.head=null,this.tail=null,this.length=0}return p(m,[{key:"push",value:function(w){var E={data:w,next:null};0<this.length?this.tail.next=E:this.head=E,this.tail=E,++this.length}},{key:"unshift",value:function(w){var E={data:w,next:this.head};this.length===0&&(this.tail=E),this.head=E,++this.length}},{key:"shift",value:function(){if(this.length!==0){var w=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,w}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(w){if(this.length===0)return"";for(var E=this.head,S=""+E.data;E=E.next;)S+=w+E.data;return S}},{key:"concat",value:function(w){if(this.length===0)return v.alloc(0);for(var E=v.allocUnsafe(w>>>0),S=this.head,k=0;S;)g(S.data,E,k),k+=S.data.length,S=S.next;return E}},{key:"consume",value:function(w,E){var S;return w<this.head.data.length?(S=this.head.data.slice(0,w),this.head.data=this.head.data.slice(w)):w===this.head.data.length?S=this.shift():S=E?this._getString(w):this._getBuffer(w),S}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(w){var E=this.head,S=1,k=E.data;for(w-=k.length;E=E.next;){var T=E.data,I=w>T.length?T.length:w;if(k+=I===T.length?T:T.slice(0,w),w-=I,w===0){I===T.length?(++S,this.head=E.next?E.next:this.tail=null):(this.head=E,E.data=T.slice(I));break}++S}return this.length-=S,k}},{key:"_getBuffer",value:function(w){var E=v.allocUnsafe(w),S=this.head,k=1;for(S.data.copy(E),w-=S.data.length;S=S.next;){var T=S.data,I=w>T.length?T.length:w;if(T.copy(E,E.length-w,0,I),w-=I,w===0){I===T.length?(++k,this.head=S.next?S.next:this.tail=null):(this.head=S,S.data=T.slice(I));break}++k}return this.length-=k,E}},{key:L,value:function(w,E){return x(this,c({},E,{depth:0,customInspect:!1}))}}]),m}()},{buffer:3,util:2}],23:[function(s,l){(function(a){(function(){function c(f,p){u(f,p),h(f)}function h(f){f._writableState&&!f._writableState.emitClose||f._readableState&&!f._readableState.emitClose||f.emit("close")}function u(f,p){f.emit("error",p)}l.exports={destroy:function(f,p){var g=this,b=this._readableState&&this._readableState.destroyed,v=this._writableState&&this._writableState.destroyed;return b||v?(p?p(f):f&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,a.nextTick(u,this,f)):a.nextTick(u,this,f)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(f||null,function(D){!p&&D?g._writableState?g._writableState.errorEmitted?a.nextTick(h,g):(g._writableState.errorEmitted=!0,a.nextTick(c,g,D)):a.nextTick(c,g,D):p?(a.nextTick(h,g),p(D)):a.nextTick(h,g)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(f,p){var g=f._readableState,b=f._writableState;g&&g.autoDestroy||b&&b.autoDestroy?f.destroy(p):f.emit("error",p)}}}).call(this)}).call(this,s("_process"))},{_process:12}],24:[function(s,l){function a(p){var g=!1;return function(){if(!g){g=!0;for(var b=arguments.length,v=Array(b),D=0;D<b;D++)v[D]=arguments[D];p.apply(this,v)}}}function c(){}function h(p){return p.setHeader&&typeof p.abort=="function"}function u(p,g,b){if(typeof g=="function")return u(p,null,g);g||(g={}),b=a(b||c);var v=g.readable||g.readable!==!1&&p.readable,D=g.writable||g.writable!==!1&&p.writable,x=function(){p.writable||m()},L=p._writableState&&p._writableState.finished,m=function(){D=!1,L=!0,v||b.call(p)},w=p._readableState&&p._readableState.endEmitted,E=function(){v=!1,w=!0,D||b.call(p)},S=function(I){b.call(p,I)},k=function(){var I;return v&&!w?(p._readableState&&p._readableState.ended||(I=new f),b.call(p,I)):D&&!L?(p._writableState&&p._writableState.ended||(I=new f),b.call(p,I)):void 0},T=function(){p.req.on("finish",m)};return h(p)?(p.on("complete",m),p.on("abort",k),p.req?T():p.on("request",T)):D&&!p._writableState&&(p.on("end",x),p.on("close",x)),p.on("end",E),p.on("finish",m),g.error!==!1&&p.on("error",S),p.on("close",k),function(){p.removeListener("complete",m),p.removeListener("abort",k),p.removeListener("request",T),p.req&&p.req.removeListener("finish",m),p.removeListener("end",x),p.removeListener("close",x),p.removeListener("finish",m),p.removeListener("end",E),p.removeListener("error",S),p.removeListener("close",k)}}var f=s("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;l.exports=u},{"../../../errors":15}],25:[function(s,l){l.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(s,l){function a(L){var m=!1;return function(){m||(m=!0,L.apply(void 0,arguments))}}function c(L){if(L)throw L}function h(L){return L.setHeader&&typeof L.abort=="function"}function u(L,m,w,E){E=a(E);var S=!1;L.on("close",function(){S=!0}),b===void 0&&(b=s("./end-of-stream")),b(L,{readable:m,writable:w},function(T){return T?E(T):(S=!0,void E())});var k=!1;return function(T){if(!S)return k?void 0:(k=!0,h(L)?L.abort():typeof L.destroy=="function"?L.destroy():void E(T||new x("pipe")))}}function f(L){L()}function p(L,m){return L.pipe(m)}function g(L){return L.length&&typeof L[L.length-1]=="function"?L.pop():c}var b,v=s("../../../errors").codes,D=v.ERR_MISSING_ARGS,x=v.ERR_STREAM_DESTROYED;l.exports=function(){for(var L=arguments.length,m=Array(L),w=0;w<L;w++)m[w]=arguments[w];var E=g(m);if(Array.isArray(m[0])&&(m=m[0]),2>m.length)throw new D("streams");var S,k=m.map(function(T,I){var C=I<m.length-1;return u(T,C,0<I,function(R){S||(S=R),R&&k.forEach(f),C||(k.forEach(f),E(S))})});return m.reduce(p)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(s,l){function a(h,u,f){return h.highWaterMark==null?u?h[f]:null:h.highWaterMark}var c=s("../../../errors").codes.ERR_INVALID_OPT_VALUE;l.exports={getHighWaterMark:function(h,u,f,p){var g=a(u,p,f);if(g!=null){if(!(isFinite(g)&&n(g)===g)||0>g){var b=p?f:"highWaterMark";throw new c(b,g)}return n(g)}return h.objectMode?16:16384}}},{"../../../errors":15}],28:[function(s,l){l.exports=s("events").EventEmitter},{events:7}],29:[function(s,l,a){a=l.exports=s("./lib/_stream_readable.js"),a.Stream=a,a.Readable=a,a.Writable=s("./lib/_stream_writable.js"),a.Duplex=s("./lib/_stream_duplex.js"),a.Transform=s("./lib/_stream_transform.js"),a.PassThrough=s("./lib/_stream_passthrough.js"),a.finished=s("./lib/internal/streams/end-of-stream.js"),a.pipeline=s("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(s,l,a){function c(p,g){for(var b in p)g[b]=p[b]}function h(p,g,b){return f(p,g,b)}var u=s("buffer"),f=u.Buffer;f.from&&f.alloc&&f.allocUnsafe&&f.allocUnsafeSlow?l.exports=u:(c(u,a),a.Buffer=h),h.prototype=Object.create(f.prototype),c(f,h),h.from=function(p,g,b){if(typeof p=="number")throw new TypeError("Argument must not be a number");return f(p,g,b)},h.alloc=function(p,g,b){if(typeof p!="number")throw new TypeError("Argument must be a number");var v=f(p);return g===void 0?v.fill(0):typeof b=="string"?v.fill(g,b):v.fill(g),v},h.allocUnsafe=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return f(p)},h.allocUnsafeSlow=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return u.SlowBuffer(p)}},{buffer:3}],31:[function(s,l,a){function c(k){if(!k)return"utf8";for(var T;;)switch(k){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return k;default:if(T)return;k=(""+k).toLowerCase(),T=!0}}function h(k){var T=c(k);if(typeof T!="string"&&(E.isEncoding===S||!S(k)))throw new Error("Unknown encoding: "+k);return T||k}function u(k){this.encoding=h(k);var T;switch(this.encoding){case"utf16le":this.text=v,this.end=D,T=4;break;case"utf8":this.fillLast=b,T=4;break;case"base64":this.text=x,this.end=L,T=3;break;default:return this.write=m,void(this.end=w)}this.lastNeed=0,this.lastTotal=0,this.lastChar=E.allocUnsafe(T)}function f(k){return 127>=k?0:k>>5==6?2:k>>4==14?3:k>>3==30?4:k>>6==2?-1:-2}function p(k,T,I){var C=T.length-1;if(C<I)return 0;var R=f(T[C]);return 0<=R?(0<R&&(k.lastNeed=R-1),R):--C<I||R===-2?0:(R=f(T[C]),0<=R?(0<R&&(k.lastNeed=R-2),R):--C<I||R===-2?0:(R=f(T[C]),0<=R?(0<R&&(R===2?R=0:k.lastNeed=R-3),R):0))}function g(k,T){if((192&T[0])!=128)return k.lastNeed=0,"\uFFFD";if(1<k.lastNeed&&1<T.length){if((192&T[1])!=128)return k.lastNeed=1,"\uFFFD";if(2<k.lastNeed&&2<T.length&&(192&T[2])!=128)return k.lastNeed=2,"\uFFFD"}}function b(k){var T=this.lastTotal-this.lastNeed,I=g(this,k);return I===void 0?this.lastNeed<=k.length?(k.copy(this.lastChar,T,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(k.copy(this.lastChar,T,0,k.length),void(this.lastNeed-=k.length)):I}function v(k,T){if((k.length-T)%2==0){var I=k.toString("utf16le",T);if(I){var C=I.charCodeAt(I.length-1);if(55296<=C&&56319>=C)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=k[k.length-2],this.lastChar[1]=k[k.length-1],I.slice(0,-1)}return I}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=k[k.length-1],k.toString("utf16le",T,k.length-1)}function D(k){var T=k&&k.length?this.write(k):"";if(this.lastNeed){var I=this.lastTotal-this.lastNeed;return T+this.lastChar.toString("utf16le",0,I)}return T}function x(k,T){var I=(k.length-T)%3;return I==0?k.toString("base64",T):(this.lastNeed=3-I,this.lastTotal=3,I==1?this.lastChar[0]=k[k.length-1]:(this.lastChar[0]=k[k.length-2],this.lastChar[1]=k[k.length-1]),k.toString("base64",T,k.length-I))}function L(k){var T=k&&k.length?this.write(k):"";return this.lastNeed?T+this.lastChar.toString("base64",0,3-this.lastNeed):T}function m(k){return k.toString(this.encoding)}function w(k){return k&&k.length?this.write(k):""}var E=s("safe-buffer").Buffer,S=E.isEncoding||function(k){switch(k=""+k,k&&k.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};a.StringDecoder=u,u.prototype.write=function(k){if(k.length===0)return"";var T,I;if(this.lastNeed){if(T=this.fillLast(k),T===void 0)return"";I=this.lastNeed,this.lastNeed=0}else I=0;return I<k.length?T?T+this.text(k,I):this.text(k,I):T||""},u.prototype.end=function(k){var T=k&&k.length?this.write(k):"";return this.lastNeed?T+"\uFFFD":T},u.prototype.text=function(k,T){var I=p(this,k,T);if(!this.lastNeed)return k.toString("utf8",T);this.lastTotal=I;var C=k.length-(I-this.lastNeed);return k.copy(this.lastChar,0,C),k.toString("utf8",T,C)},u.prototype.fillLast=function(k){return this.lastNeed<=k.length?(k.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(k.copy(this.lastChar,this.lastTotal-this.lastNeed,0,k.length),void(this.lastNeed-=k.length))}},{"safe-buffer":30}],32:[function(s,l){(function(a){(function(){function c(h){try{if(!a.localStorage)return!1}catch{return!1}var u=a.localStorage[h];return u!=null&&(u+"").toLowerCase()==="true"}l.exports=function(h,u){function f(){if(!p){if(c("throwDeprecation"))throw new Error(u);c("traceDeprecation")?console.trace(u):console.warn(u),p=!0}return h.apply(this,arguments)}if(c("noDeprecation"))return h;var p=!1;return f}}).call(this)}).call(this,typeof wt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:wt)},{}],"/":[function(s,l){function a(L){return L.replace(/a=ice-options:trickle\s\n/g,"")}function c(L){console.warn(L)}const h=s("debug")("simple-peer"),u=s("get-browser-rtc"),f=s("randombytes"),p=s("readable-stream"),g=s("queue-microtask"),b=s("err-code"),{Buffer:v}=s("buffer"),D=65536;class x extends p.Duplex{constructor(m){if(m=Object.assign({allowHalfOpen:!1},m),super(m),this._id=f(4).toString("hex").slice(0,7),this._debug("new peer %o",m),this.channelName=m.initiator?m.channelName||f(20).toString("hex"):null,this.initiator=m.initiator||!1,this.channelConfig=m.channelConfig||x.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},x.config,m.config),this.offerOptions=m.offerOptions||{},this.answerOptions=m.answerOptions||{},this.sdpTransform=m.sdpTransform||(w=>w),this.streams=m.streams||(m.stream?[m.stream]:[]),this.trickle=m.trickle===void 0||m.trickle,this.allowHalfTrickle=m.allowHalfTrickle!==void 0&&m.allowHalfTrickle,this.iceCompleteTimeout=m.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=m.wrtc&&typeof m.wrtc=="object"?m.wrtc:u(),!this._wrtc)throw b(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(w){return void this.destroy(b(w,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=w=>{this._onIceCandidate(w)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(w=>{this.destroy(b(w,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=w=>{this._setupData(w)},this.streams&&this.streams.forEach(w=>{this.addStream(w)}),this._pc.ontrack=w=>{this._onTrack(w)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(m){if(!this.destroying){if(this.destroyed)throw b(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof m=="string")try{m=JSON.parse(m)}catch{m={}}this._debug("signal()"),m.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),m.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(m.transceiverRequest.kind,m.transceiverRequest.init)),m.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(m.candidate):this._pendingCandidates.push(m.candidate)),m.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(m)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(w=>{this._addIceCandidate(w)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(w=>{this.destroy(b(w,"ERR_SET_REMOTE_DESCRIPTION"))}),m.sdp||m.candidate||m.renegotiate||m.transceiverRequest||this.destroy(b(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(m){const w=new this._wrtc.RTCIceCandidate(m);this._pc.addIceCandidate(w).catch(E=>{!w.address||w.address.endsWith(".local")?c("Ignoring unsupported ICE candidate."):this.destroy(b(E,"ERR_ADD_ICE_CANDIDATE"))})}send(m){if(!this.destroying){if(this.destroyed)throw b(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(m)}}addTransceiver(m,w){if(!this.destroying){if(this.destroyed)throw b(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(m,w),this._needsNegotiation()}catch(E){this.destroy(b(E,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:m,init:w}})}}addStream(m){if(!this.destroying){if(this.destroyed)throw b(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),m.getTracks().forEach(w=>{this.addTrack(w,m)})}}addTrack(m,w){if(this.destroying)return;if(this.destroyed)throw b(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const E=this._senderMap.get(m)||new Map;let S=E.get(w);if(!S)S=this._pc.addTrack(m,w),E.set(w,S),this._senderMap.set(m,E),this._needsNegotiation();else throw S.removed?b(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):b(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(m,w,E){if(this.destroying)return;if(this.destroyed)throw b(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const S=this._senderMap.get(m),k=S?S.get(E):null;if(!k)throw b(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");w&&this._senderMap.set(w,S),k.replaceTrack==null?this.destroy(b(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):k.replaceTrack(w)}removeTrack(m,w){if(this.destroying)return;if(this.destroyed)throw b(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const E=this._senderMap.get(m),S=E?E.get(w):null;if(!S)throw b(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{S.removed=!0,this._pc.removeTrack(S)}catch(k){k.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(S):this.destroy(b(k,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(m){if(!this.destroying){if(this.destroyed)throw b(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),m.getTracks().forEach(w=>{this.removeTrack(w,m)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,g(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw b(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(m){this._destroy(m,()=>{})}_destroy(m,w){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",m&&(m.message||m)),g(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",m&&(m.message||m)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,m&&this.emit("error",m),this.emit("close"),w()}))}_setupData(m){if(!m.channel)return this.destroy(b(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=m.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=D),this.channelName=this._channel.label,this._channel.onmessage=E=>{this._onChannelMessage(E)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=E=>{const S=E.error instanceof Error?E.error:new Error(`Datachannel error: ${E.message} ${E.filename}:${E.lineno}:${E.colno}`);this.destroy(b(S,"ERR_DATA_CHANNEL"))};let w=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(w&&this._onChannelClose(),w=!0):w=!1},5e3)}_read(){}_write(m,w,E){if(this.destroyed)return E(b(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(m)}catch(S){return this.destroy(b(S,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>D?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=E):E(null)}else this._debug("write before connect"),this._chunk=m,this._cb=E}_onFinish(){if(!this.destroyed){const m=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?m():this.once("connect",m)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(m=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(m.sdp=a(m.sdp)),m.sdp=this.sdpTransform(m.sdp);const w=()=>{if(!this.destroyed){const E=this._pc.localDescription||m;this._debug("signal"),this.emit("signal",{type:E.type,sdp:E.sdp})}};this._pc.setLocalDescription(m).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?w():this.once("_iceComplete",w))}).catch(E=>{this.destroy(b(E,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(m=>{this.destroy(b(m,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(m=>{m.mid||!m.sender.track||m.requested||(m.requested=!0,this.addTransceiver(m.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(m=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(m.sdp=a(m.sdp)),m.sdp=this.sdpTransform(m.sdp);const w=()=>{if(!this.destroyed){const E=this._pc.localDescription||m;this._debug("signal"),this.emit("signal",{type:E.type,sdp:E.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(m).then(()=>{this.destroyed||(this.trickle||this._iceComplete?w():this.once("_iceComplete",w))}).catch(E=>{this.destroy(b(E,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(m=>{this.destroy(b(m,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(b(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const m=this._pc.iceConnectionState,w=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",m,w),this.emit("iceStateChange",m,w),(m==="connected"||m==="completed")&&(this._pcReady=!0,this._maybeReady()),m==="failed"&&this.destroy(b(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),m==="closed"&&this.destroy(b(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(m){const w=E=>(Object.prototype.toString.call(E.values)==="[object Array]"&&E.values.forEach(S=>{Object.assign(E,S)}),E);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(E=>{const S=[];E.forEach(k=>{S.push(w(k))}),m(null,S)},E=>m(E)):0<this._pc.getStats.length?this._pc.getStats(E=>{if(this.destroyed)return;const S=[];E.result().forEach(k=>{const T={};k.names().forEach(I=>{T[I]=k.stat(I)}),T.id=k.id,T.type=k.type,T.timestamp=k.timestamp,S.push(w(T))}),m(null,S)},E=>m(E)):m(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const m=()=>{this.destroyed||this.getStats((w,E)=>{if(this.destroyed)return;w&&(E=[]);const S={},k={},T={};let I=!1;E.forEach(R=>{(R.type==="remotecandidate"||R.type==="remote-candidate")&&(S[R.id]=R),(R.type==="localcandidate"||R.type==="local-candidate")&&(k[R.id]=R),(R.type==="candidatepair"||R.type==="candidate-pair")&&(T[R.id]=R)});const C=R=>{I=!0;let P=k[R.localCandidateId];P&&(P.ip||P.address)?(this.localAddress=P.ip||P.address,this.localPort=+P.port):P&&P.ipAddress?(this.localAddress=P.ipAddress,this.localPort=+P.portNumber):typeof R.googLocalAddress=="string"&&(P=R.googLocalAddress.split(":"),this.localAddress=P[0],this.localPort=+P[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let z=S[R.remoteCandidateId];z&&(z.ip||z.address)?(this.remoteAddress=z.ip||z.address,this.remotePort=+z.port):z&&z.ipAddress?(this.remoteAddress=z.ipAddress,this.remotePort=+z.portNumber):typeof R.googRemoteAddress=="string"&&(z=R.googRemoteAddress.split(":"),this.remoteAddress=z[0],this.remotePort=+z[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(E.forEach(R=>{R.type==="transport"&&R.selectedCandidatePairId&&C(T[R.selectedCandidatePairId]),(R.type==="googCandidatePair"&&R.googActiveConnection==="true"||(R.type==="candidatepair"||R.type==="candidate-pair")&&R.selected)&&C(R)}),!I&&(!Object.keys(T).length||Object.keys(k).length))return void setTimeout(m,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(P){return this.destroy(b(P,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const R=this._cb;this._cb=null,R(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};m()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>D)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(m=>{this._pc.removeTrack(m),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(m){this.destroyed||(m.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:m.candidate.candidate,sdpMLineIndex:m.candidate.sdpMLineIndex,sdpMid:m.candidate.sdpMid}}):!m.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),m.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(m){if(this.destroyed)return;let w=m.data;w instanceof ArrayBuffer&&(w=v.from(w)),this.push(w)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const m=this._cb;this._cb=null,m(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(m){this.destroyed||m.streams.forEach(w=>{this._debug("on track"),this.emit("track",m.track,w),this._remoteTracks.push({track:m.track,stream:w}),this._remoteStreams.some(E=>E.id===w.id)||(this._remoteStreams.push(w),g(()=>{this._debug("on stream"),this.emit("stream",w)}))})}_debug(){const m=[].slice.call(arguments);m[0]="["+this._id+"] "+m[0],h.apply(null,m)}}x.WEBRTC_SUPPORT=!!u(),x.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},x.channelConfig={},l.exports=x},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(ca);var Zd=ca.exports;const Vd=Cp(Zd),Wi=0,qi=1,ha=2,da=(e,t)=>{Y(e,Wi);const n=Lh(t);be(e,n)},ua=(e,t,n)=>{Y(e,qi),be(e,Th(t,n))},Wd=(e,t,n)=>ua(t,n,xe(e)),fa=(e,t,n)=>{try{Ah(t,xe(e),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},qd=(e,t)=>{Y(e,ha),be(e,t)},$d=fa,Yd=(e,t,n,r)=>{const i=Q(e);switch(i){case Wi:Wd(e,t,n);break;case qi:fa(e,n,r);break;case ha:$d(e,n,r);break;default:throw new Error("Unknown message type")}return i},$i=3e4;class Kd extends ur{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const n=kt();this.getLocalState()!==null&&$i/2<=n-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const r=[];this.meta.forEach((i,s)=>{s!==this.clientID&&$i<=n-i.lastUpdated&&this.states.has(s)&&r.push(s)}),r.length>0&&Yi(this,r,"timeout")},it($i/10)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const n=this.clientID,r=this.meta.get(n),i=r===void 0?0:r.clock+1,s=this.states.get(n);t===null?this.states.delete(n):this.states.set(n,t),this.meta.set(n,{clock:i,lastUpdated:kt()});const l=[],a=[],c=[],h=[];t===null?h.push(n):s==null?t!=null&&l.push(n):(a.push(n),Mn(s,t)||c.push(n)),(l.length>0||c.length>0||h.length>0)&&this.emit("change",[{added:l,updated:c,removed:h},"local"]),this.emit("update",[{added:l,updated:a,removed:h},"local"])}setLocalStateField(t,n){const r=this.getLocalState();r!==null&&this.setLocalState({...r,[t]:n})}getStates(){return this.states}}const Yi=(e,t,n)=>{const r=[];for(let i=0;i<t.length;i++){const s=t[i];if(e.states.has(s)){if(e.states.delete(s),s===e.clientID){const l=e.meta.get(s);e.meta.set(s,{clock:l.clock+1,lastUpdated:kt()})}r.push(s)}}r.length>0&&(e.emit("change",[{added:[],updated:[],removed:r},n]),e.emit("update",[{added:[],updated:[],removed:r},n]))},Vr=(e,t,n=e.states)=>{const r=t.length,i=Ae();Y(i,r);for(let s=0;s<r;s++){const l=t[s],a=n.get(l)||null,c=e.meta.get(l).clock;Y(i,l),Y(i,c),st(i,JSON.stringify(a))}return me(i)},Jd=(e,t,n)=>{const r=lt(t),i=kt(),s=[],l=[],a=[],c=[],h=Q(r);for(let u=0;u<h;u++){const f=Q(r);let p=Q(r);const g=JSON.parse(vt(r)),b=e.meta.get(f),v=e.states.get(f),D=b===void 0?0:b.clock;(D<p||D===p&&g===null&&e.states.has(f))&&(g===null?f===e.clientID&&e.getLocalState()!=null?p++:e.states.delete(f):e.states.set(f,g),e.meta.set(f,{clock:p,lastUpdated:i}),b===void 0&&g!==null?s.push(f):b!==void 0&&g===null?c.push(f):g!==null&&(Mn(g,v)||a.push(f),l.push(f)))}(s.length>0||a.length>0||c.length>0)&&e.emit("change",[{added:s,updated:a,removed:c},n]),(s.length>0||l.length>0||c.length>0)&&e.emit("update",[{added:s,updated:l,removed:c},n])},Gd=(e,t)=>{const n=di(e).buffer,r=di(t).buffer;return crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveKey"]).then(i=>crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},ga=(e,t)=>{if(!t)return wi(e);const n=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,e).then(r=>{const i=Ae();return st(i,"AES-GCM"),be(i,n),be(i,new Uint8Array(r)),me(i)})},Xd=(e,t)=>{const n=Ae();return rn(n,e),ga(me(n),t)},pa=(e,t)=>{if(!t)return wi(e);const n=lt(e);vt(n)!=="AES-GCM"&&Uc(ot("Unknown encryption algorithm"));const r=xe(n),i=xe(n);return crypto.subtle.decrypt({name:"AES-GCM",iv:r},t,i).then(s=>new Uint8Array(s))},Qd=(e,t)=>pa(e,t).then(n=>sn(lt(new Uint8Array(n)))),tt=gh("y-webrtc"),pn=0,_a=3,Wn=1,Ki=4,Wr=new Map,Yt=new Map,ma=e=>{let t=!0;e.webrtcConns.forEach(n=>{n.synced||(t=!1)}),(!t&&e.synced||t&&!e.synced)&&(e.synced=t,e.provider.emit("synced",[{synced:t}]),tt("synced ",Ye,e.name,Zt," with all peers"))},ba=(e,t,n)=>{const r=lt(t),i=Ae(),s=Q(r);if(e===void 0)return null;const l=e.awareness,a=e.doc;let c=!1;switch(s){case pn:{Y(i,pn);const h=Yd(r,i,a,e);h===qi&&!e.synced&&n(),h===Wi&&(c=!0);break}case _a:Y(i,Wn),be(i,Vr(l,Array.from(l.getStates().keys()))),c=!0;break;case Wn:Jd(l,xe(r),e);break;case Ki:{const h=Ht(r)===1,u=vt(r);if(u!==e.peerId&&(e.bcConns.has(u)&&!h||!e.bcConns.has(u)&&h)){const f=[],p=[];h?(e.bcConns.add(u),p.push(u)):(e.bcConns.delete(u),f.push(u)),e.provider.emit("peers",[{added:p,removed:f,webrtcPeers:Array.from(e.webrtcConns.keys()),bcPeers:Array.from(e.bcConns)}]),va(e)}break}default:return console.error("Unable to compute message"),i}return c?i:null},eu=(e,t)=>{const n=e.room;return tt("received message from ",Ye,e.remotePeerId,Ei," (",n.name,")",Zt,vr),ba(n,t,()=>{e.synced=!0,tt("synced ",Ye,n.name,Zt," with ",Ye,e.remotePeerId),ma(n)})},Ji=(e,t)=>{tt("send message to ",Ye,e.remotePeerId,Zt,Ei," (",e.room.name,")",vr);try{e.peer.send(me(t))}catch{}},tu=(e,t)=>{tt("broadcast message in ",Ye,e.name,Zt),e.webrtcConns.forEach(n=>{try{n.peer.send(t)}catch{}})};class wa{constructor(t,n,r,i){tt("establishing connection to ",Ye,r),this.room=i,this.remotePeerId=r,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new Vd({initiator:n,...i.provider.peerOpts}),this.peer.on("signal",s=>{Xi(t,i,{to:r,from:i.peerId,type:"signal",signal:s})}),this.peer.on("connect",()=>{tt("connected to ",Ye,r),this.connected=!0;const s=i.provider.doc,l=i.awareness,a=Ae();Y(a,pn),da(a,s),Ji(this,a);const c=l.getStates();if(c.size>0){const h=Ae();Y(h,Wn),be(h,Vr(l,Array.from(c.keys()))),Ji(this,h)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,i.webrtcConns.has(this.remotePeerId)&&(i.webrtcConns.delete(this.remotePeerId),i.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}])),ma(i),this.peer.destroy(),tt("closed connection to ",Ye,r),Gi(i)}),this.peer.on("error",s=>{tt("Error in connection to ",Ye,r,": ",s),Gi(i)}),this.peer.on("data",s=>{const l=eu(this,s);l!==null&&Ji(this,l)})}destroy(){this.peer.destroy()}}const Lt=(e,t)=>ga(t,e.key).then(n=>e.mux(()=>Hd(e.name,n))),ya=(e,t)=>{e.bcconnected&&Lt(e,t),tu(e,t)},Gi=e=>{Wr.forEach(t=>{t.connected&&(t.send({type:"subscribe",topics:[e.name]}),e.webrtcConns.size<e.provider.maxConns&&Xi(t,e,{type:"announce",from:e.peerId}))})},va=e=>{if(e.provider.filterBcConns){const t=Ae();Y(t,Ki),On(t,1),st(t,e.peerId),Lt(e,me(t))}};class nu{constructor(t,n,r,i){this.peerId=Ys(),this.doc=t,this.awareness=n.awareness,this.provider=n,this.synced=!1,this.name=r,this.key=i,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=la(),this.bcconnected=!1,this._bcSubscriber=s=>pa(new Uint8Array(s),i).then(l=>this.mux(()=>{const a=ba(this,l,()=>{});a&&Lt(this,me(a))})),this._docUpdateHandler=(s,l)=>{const a=Ae();Y(a,pn),qd(a,s),ya(this,me(a))},this._awarenessUpdateHandler=({added:s,updated:l,removed:a},c)=>{const h=s.concat(l).concat(a),u=Ae();Y(u,Wn),be(u,Vr(this.awareness,h)),ya(this,me(u))},this._beforeUnloadHandler=()=>{Yi(this.awareness,[t.clientID],"window unload"),Yt.forEach(s=>{s.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),Gi(this);const t=this.name;jd(t,this._bcSubscriber),this.bcconnected=!0,va(this);const n=Ae();Y(n,pn),da(n,this.doc),Lt(this,me(n));const r=Ae();Y(r,pn),ua(r,this.doc),Lt(this,me(r));const i=Ae();Y(i,_a),Lt(this,me(i));const s=Ae();Y(s,Wn),be(s,Vr(this.awareness,[this.doc.clientID])),Lt(this,me(s))}disconnect(){Wr.forEach(n=>{n.connected&&n.send({type:"unsubscribe",topics:[this.name]})}),Yi(this.awareness,[this.doc.clientID],"disconnect");const t=Ae();Y(t,Ki),On(t,0),st(t,this.peerId),Lt(this,me(t)),Fd(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(n=>n.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const ru=(e,t,n,r)=>{if(Yt.has(n))throw ot(`A Yjs Doc connected to room "${n}" already exists!`);const i=new nu(e,t,n,r);return Yt.set(n,i),i},Xi=(e,t,n)=>{t.key?Xd(n,t.key).then(r=>{e.send({type:"publish",topic:t.name,data:no(r)})}):e.send({type:"publish",topic:t.name,data:n})};class iu extends Pd{constructor(t){super(t),this.providers=new Set,this.on("connect",()=>{tt(`connected (${t})`);const n=Array.from(Yt.keys());this.send({type:"subscribe",topics:n}),Yt.forEach(r=>Xi(this,r,{type:"announce",from:r.peerId}))}),this.on("message",n=>{switch(n.type){case"publish":{const r=n.topic,i=Yt.get(r);if(i==null||typeof r!="string")return;const s=l=>{const a=i.webrtcConns,c=i.peerId;if(l==null||l.from===c||l.to!==void 0&&l.to!==c||i.bcConns.has(l.from))return;const h=a.has(l.from)?()=>{}:()=>i.provider.emit("peers",[{removed:[],added:[l.from],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}]);switch(l.type){case"announce":a.size<i.provider.maxConns&&(qe(a,l.from,()=>new wa(this,!0,l.from,i)),h());break;case"signal":l.to===c&&(qe(a,l.from,()=>new wa(this,!1,l.from,i)).peer.signal(l.signal),h());break}};i.key?typeof n.data=="string"&&Qd(ro(n.data),i.key).then(s):s(n.data)}}}),this.on("disconnect",()=>tt(`disconnect (${t})`))}}class su extends ur{constructor(t,n,{signaling:r=["wss://y-webrtc-eu.fly.dev"],password:i=null,awareness:s=new Kd(n),maxConns:l=20+it(Oc()*15),filterBcConns:a=!0,peerOpts:c={}}={}){super(),this.roomName=t,this.doc=n,this.filterBcConns=a,this.awareness=s,this.shouldConnect=!1,this.signalingUrls=r,this.signalingConns=[],this.maxConns=l,this.peerOpts=c,this.key=i?Gd(i,t):wi(null),this.room=null,this.key.then(h=>{this.room=ru(n,this,t,h),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),n.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(t=>{const n=qe(Wr,t,()=>new iu(t));this.signalingConns.push(n),n.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(t=>{t.providers.delete(this),t.providers.size===0&&(t.destroy(),Wr.delete(t.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),Yt.delete(this.roomName)}),super.destroy()}}class ou{constructor(t,n,r){this.start=t,this.end=n,this.direction=r}}const au=(e,t,n)=>{const r=e.getSelection();if(r!==null){const i=r.getStartPosition(),s=r.getEndPosition(),l=Sr(n,t.getOffsetAt(i)),a=Sr(n,t.getOffsetAt(s));return new ou(l,a,r.getDirection())}return null},lu=(e,t,n,r)=>{const i=Ar(n.start,r),s=Ar(n.end,r);if(i!==null&&s!==null&&i.type===t&&s.type===t){const l=e.getModel(),a=l.getPositionAt(i.index),c=l.getPositionAt(s.index);return Os.createWithDirection(a.lineNumber,a.column,c.lineNumber,c.column,n.direction)}return null};class cu{constructor(t,n,r=new Set,i=null){this.doc=t.doc,this.ytext=t,this.monacoModel=n,this.editors=r,this.mux=la(),this._savedSelections=new Map,this._beforeTransaction=()=>{this.mux(()=>{this._savedSelections=new Map,r.forEach(s=>{if(s.getModel()===n){const l=au(s,n,t);l!==null&&this._savedSelections.set(s,l)}})})},this.doc.on("beforeAllTransactions",this._beforeTransaction),this._decorations=new Map,this._rerenderDecorations=()=>{r.forEach(s=>{if(i&&s.getModel()===n){const l=this._decorations.get(s)||[],a=[];i.getStates().forEach((c,h)=>{if(h!==this.doc.clientID&&c.selection!=null&&c.selection.anchor!=null&&c.selection.head!=null){const u=Ar(c.selection.anchor,this.doc),f=Ar(c.selection.head,this.doc);if(u!==null&&f!==null&&u.type===t&&f.type===t){let p,g,b,v;u.index<f.index?(p=n.getPositionAt(u.index),g=n.getPositionAt(f.index),b="yRemoteSelectionHead yRemoteSelectionHead-"+h,v=null):(p=n.getPositionAt(f.index),g=n.getPositionAt(u.index),b=null,v="yRemoteSelectionHead yRemoteSelectionHead-"+h),a.push({range:new Sp(p.lineNumber,p.column,g.lineNumber,g.column),options:{className:"yRemoteSelection yRemoteSelection-"+h,afterContentClassName:b,beforeContentClassName:v}})}}}),this._decorations.set(s,s.deltaDecorations(l,a))}else this._decorations.delete(s)})},this._ytextObserver=s=>{this.mux(()=>{let l=0;s.delta.forEach(a=>{if(a.retain!==void 0)l+=a.retain;else if(a.insert!==void 0){const c=n.getPositionAt(l),h=new Os(c.lineNumber,c.column,c.lineNumber,c.column),u=a.insert;n.applyEdits([{range:h,text:u}]),l+=u.length}else if(a.delete!==void 0){const c=n.getPositionAt(l),h=n.getPositionAt(l+a.delete),u=new Os(c.lineNumber,c.column,h.lineNumber,h.column);n.applyEdits([{range:u,text:""}])}else throw $e()}),this._savedSelections.forEach((a,c)=>{const h=lu(c,t,a,this.doc);h!==null&&c.setSelection(h)})}),this._rerenderDecorations()},t.observe(this._ytextObserver);{const s=t.toString();n.getValue()!==s&&n.setValue(s)}this._monacoChangeHandler=n.onDidChangeContent(s=>{this.mux(()=>{this.doc.transact(()=>{s.changes.sort((l,a)=>a.rangeOffset-l.rangeOffset).forEach(l=>{t.delete(l.rangeOffset,l.rangeLength),t.insert(l.rangeOffset,l.text)})},this)})}),n.onWillDispose(()=>{this.destroy()}),i&&(r.forEach(s=>{s.onDidChangeCursorSelection(()=>{if(s.getModel()===n){const l=s.getSelection();if(l===null)return;let a=n.getOffsetAt(l.getStartPosition()),c=n.getOffsetAt(l.getEndPosition());if(l.getDirection()===Ap.RTL){const h=a;a=c,c=h}i.setLocalStateField("selection",{anchor:Sr(t,a),head:Sr(t,c)})}}),i.on("change",this._rerenderDecorations)}),this.awareness=i)}destroy(){this._monacoChangeHandler.dispose(),this.ytext.unobserve(this._ytextObserver),this.doc.off("beforeAllTransactions",this._beforeTransaction),this.awareness&&this.awareness.off("change",this._rerenderDecorations)}}const hu=4,ka=0,Ea=1,du=2;function _n(e){let t=e.length;for(;--t>=0;)e[t]=0}const uu=0,Ca=1,fu=2,gu=3,pu=258,Qi=29,qn=256,$n=qn+1+Qi,mn=30,es=19,Sa=2*$n+1,Kt=15,ts=16,_u=7,ns=256,Aa=16,Ra=17,xa=18,rs=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),qr=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),mu=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Ta=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),bu=512,St=new Array(($n+2)*2);_n(St);const Yn=new Array(mn*2);_n(Yn);const Kn=new Array(bu);_n(Kn);const Jn=new Array(pu-gu+1);_n(Jn);const is=new Array(Qi);_n(is);const $r=new Array(mn);_n($r);function ss(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let Da,Ia,Na;function os(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const La=e=>e<256?Kn[e]:Kn[256+(e>>>7)],Gn=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},Be=(e,t,n)=>{e.bi_valid>ts-n?(e.bi_buf|=t<<e.bi_valid&65535,Gn(e,e.bi_buf),e.bi_buf=t>>ts-e.bi_valid,e.bi_valid+=n-ts):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},ft=(e,t,n)=>{Be(e,n[t*2],n[t*2+1])},Oa=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},wu=e=>{e.bi_valid===16?(Gn(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},yu=(e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let h,u,f,p,g,b,v=0;for(p=0;p<=Kt;p++)e.bl_count[p]=0;for(n[e.heap[e.heap_max]*2+1]=0,h=e.heap_max+1;h<Sa;h++)u=e.heap[h],p=n[n[u*2+1]*2+1]+1,p>c&&(p=c,v++),n[u*2+1]=p,!(u>r)&&(e.bl_count[p]++,g=0,u>=a&&(g=l[u-a]),b=n[u*2],e.opt_len+=b*(p+g),s&&(e.static_len+=b*(i[u*2+1]+g)));if(v!==0){do{for(p=c-1;e.bl_count[p]===0;)p--;e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[c]--,v-=2}while(v>0);for(p=c;p!==0;p--)for(u=e.bl_count[p];u!==0;)f=e.heap[--h],!(f>r)&&(n[f*2+1]!==p&&(e.opt_len+=(p-n[f*2+1])*n[f*2],n[f*2+1]=p),u--)}},Ma=(e,t,n)=>{const r=new Array(Kt+1);let i=0,s,l;for(s=1;s<=Kt;s++)i=i+n[s-1]<<1,r[s]=i;for(l=0;l<=t;l++){let a=e[l*2+1];a!==0&&(e[l*2]=Oa(r[a]++,a))}},vu=()=>{let e,t,n,r,i;const s=new Array(Kt+1);for(n=0,r=0;r<Qi-1;r++)for(is[r]=n,e=0;e<1<<rs[r];e++)Jn[n++]=r;for(Jn[n-1]=r,i=0,r=0;r<16;r++)for($r[r]=i,e=0;e<1<<qr[r];e++)Kn[i++]=r;for(i>>=7;r<mn;r++)for($r[r]=i<<7,e=0;e<1<<qr[r]-7;e++)Kn[256+i++]=r;for(t=0;t<=Kt;t++)s[t]=0;for(e=0;e<=143;)St[e*2+1]=8,e++,s[8]++;for(;e<=255;)St[e*2+1]=9,e++,s[9]++;for(;e<=279;)St[e*2+1]=7,e++,s[7]++;for(;e<=287;)St[e*2+1]=8,e++,s[8]++;for(Ma(St,$n+1,s),e=0;e<mn;e++)Yn[e*2+1]=5,Yn[e*2]=Oa(e,5);Da=new ss(St,rs,qn+1,$n,Kt),Ia=new ss(Yn,qr,0,mn,Kt),Na=new ss(new Array(0),mu,0,es,_u)},Ua=e=>{let t;for(t=0;t<$n;t++)e.dyn_ltree[t*2]=0;for(t=0;t<mn;t++)e.dyn_dtree[t*2]=0;for(t=0;t<es;t++)e.bl_tree[t*2]=0;e.dyn_ltree[ns*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Pa=e=>{e.bi_valid>8?Gn(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},za=(e,t,n,r)=>{const i=t*2,s=n*2;return e[i]<e[s]||e[i]===e[s]&&r[t]<=r[n]},as=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&za(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!za(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},Ba=(e,t,n)=>{let r,i,s=0,l,a;if(e.sym_next!==0)do r=e.pending_buf[e.sym_buf+s++]&255,r+=(e.pending_buf[e.sym_buf+s++]&255)<<8,i=e.pending_buf[e.sym_buf+s++],r===0?ft(e,i,t):(l=Jn[i],ft(e,l+qn+1,t),a=rs[l],a!==0&&(i-=is[l],Be(e,i,a)),r--,l=La(r),ft(e,l,n),a=qr[l],a!==0&&(r-=$r[l],Be(e,r,a)));while(s<e.sym_next);ft(e,ns,t)},ls=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let l,a,c=-1,h;for(e.heap_len=0,e.heap_max=Sa,l=0;l<s;l++)n[l*2]!==0?(e.heap[++e.heap_len]=c=l,e.depth[l]=0):n[l*2+1]=0;for(;e.heap_len<2;)h=e.heap[++e.heap_len]=c<2?++c:0,n[h*2]=1,e.depth[h]=0,e.opt_len--,i&&(e.static_len-=r[h*2+1]);for(t.max_code=c,l=e.heap_len>>1;l>=1;l--)as(e,n,l);h=s;do l=e.heap[1],e.heap[1]=e.heap[e.heap_len--],as(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=l,e.heap[--e.heap_max]=a,n[h*2]=n[l*2]+n[a*2],e.depth[h]=(e.depth[l]>=e.depth[a]?e.depth[l]:e.depth[a])+1,n[l*2+1]=n[a*2+1]=h,e.heap[1]=h++,as(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],yu(e,t),Ma(n,c,e.bl_count)},ja=(e,t,n)=>{let r,i=-1,s,l=t[0*2+1],a=0,c=7,h=4;for(l===0&&(c=138,h=3),t[(n+1)*2+1]=65535,r=0;r<=n;r++)s=l,l=t[(r+1)*2+1],!(++a<c&&s===l)&&(a<h?e.bl_tree[s*2]+=a:s!==0?(s!==i&&e.bl_tree[s*2]++,e.bl_tree[Aa*2]++):a<=10?e.bl_tree[Ra*2]++:e.bl_tree[xa*2]++,a=0,i=s,l===0?(c=138,h=3):s===l?(c=6,h=3):(c=7,h=4))},Fa=(e,t,n)=>{let r,i=-1,s,l=t[0*2+1],a=0,c=7,h=4;for(l===0&&(c=138,h=3),r=0;r<=n;r++)if(s=l,l=t[(r+1)*2+1],!(++a<c&&s===l)){if(a<h)do ft(e,s,e.bl_tree);while(--a!==0);else s!==0?(s!==i&&(ft(e,s,e.bl_tree),a--),ft(e,Aa,e.bl_tree),Be(e,a-3,2)):a<=10?(ft(e,Ra,e.bl_tree),Be(e,a-3,3)):(ft(e,xa,e.bl_tree),Be(e,a-11,7));a=0,i=s,l===0?(c=138,h=3):s===l?(c=6,h=3):(c=7,h=4)}},ku=e=>{let t;for(ja(e,e.dyn_ltree,e.l_desc.max_code),ja(e,e.dyn_dtree,e.d_desc.max_code),ls(e,e.bl_desc),t=es-1;t>=3&&e.bl_tree[Ta[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},Eu=(e,t,n,r)=>{let i;for(Be(e,t-257,5),Be(e,n-1,5),Be(e,r-4,4),i=0;i<r;i++)Be(e,e.bl_tree[Ta[i]*2+1],3);Fa(e,e.dyn_ltree,t-1),Fa(e,e.dyn_dtree,n-1)},Cu=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return ka;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Ea;for(n=32;n<qn;n++)if(e.dyn_ltree[n*2]!==0)return Ea;return ka};let Ha=!1;const Su=e=>{Ha||(vu(),Ha=!0),e.l_desc=new os(e.dyn_ltree,Da),e.d_desc=new os(e.dyn_dtree,Ia),e.bl_desc=new os(e.bl_tree,Na),e.bi_buf=0,e.bi_valid=0,Ua(e)},Za=(e,t,n,r)=>{Be(e,(uu<<1)+(r?1:0),3),Pa(e),Gn(e,n),Gn(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},Au=e=>{Be(e,Ca<<1,3),ft(e,ns,St),wu(e)},Ru=(e,t,n,r)=>{let i,s,l=0;e.level>0?(e.strm.data_type===du&&(e.strm.data_type=Cu(e)),ls(e,e.l_desc),ls(e,e.d_desc),l=ku(e),i=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=i&&(i=s)):i=s=n+5,n+4<=i&&t!==-1?Za(e,t,n,r):e.strategy===hu||s===i?(Be(e,(Ca<<1)+(r?1:0),3),Ba(e,St,Yn)):(Be(e,(fu<<1)+(r?1:0),3),Eu(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),Ba(e,e.dyn_ltree,e.dyn_dtree)),Ua(e),r&&Pa(e)},xu=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(Jn[n]+qn+1)*2]++,e.dyn_dtree[La(t)*2]++),e.sym_next===e.sym_end);var Tu=Su,Du=Za,Iu=Ru,Nu=xu,Lu=Au,Ou={_tr_init:Tu,_tr_stored_block:Du,_tr_flush_block:Iu,_tr_tally:Nu,_tr_align:Lu},Xn=(e,t,n,r)=>{let i=e&65535|0,s=e>>>16&65535|0,l=0;for(;n!==0;){l=n>2e3?2e3:n,n-=l;do i=i+t[r++]|0,s=s+i|0;while(--l);i%=65521,s%=65521}return i|s<<16|0};const Mu=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},Uu=new Uint32Array(Mu());var Te=(e,t,n,r)=>{const i=Uu,s=r+n;e^=-1;for(let l=r;l<s;l++)e=e>>>8^i[(e^t[l])&255];return e^-1},Jt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},bn={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Pu,_tr_stored_block:cs,_tr_flush_block:zu,_tr_tally:Ot,_tr_align:Bu}=Ou,{Z_NO_FLUSH:Mt,Z_PARTIAL_FLUSH:ju,Z_FULL_FLUSH:Fu,Z_FINISH:Ge,Z_BLOCK:Va,Z_OK:Ne,Z_STREAM_END:Wa,Z_STREAM_ERROR:gt,Z_DATA_ERROR:Hu,Z_BUF_ERROR:hs,Z_DEFAULT_COMPRESSION:Zu,Z_FILTERED:Vu,Z_HUFFMAN_ONLY:Yr,Z_RLE:Wu,Z_FIXED:qu,Z_DEFAULT_STRATEGY:$u,Z_UNKNOWN:Yu,Z_DEFLATED:Kr}=bn,Ku=9,Ju=15,Gu=8,Xu=29,Qu=256,ds=Qu+1+Xu,ef=30,tf=19,nf=2*ds+1,rf=15,le=3,Ut=258,pt=Ut+le+1,sf=32,wn=42,us=57,fs=69,gs=73,ps=91,_s=103,Gt=113,Qn=666,ze=1,yn=2,Xt=3,vn=4,of=3,Qt=(e,t)=>(e.msg=Jt[t],t),qa=e=>e*2-(e>4?9:0),Pt=e=>{let t=e.length;for(;--t>=0;)e[t]=0},af=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do n=e.head[--r],e.head[r]=n>=i?n-i:0;while(--t);t=i,r=t;do n=e.prev[--r],e.prev[r]=n>=i?n-i:0;while(--t)};let lf=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,zt=lf;const Ve=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},We=(e,t)=>{zu(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Ve(e.strm)},de=(e,t)=>{e.pending_buf[e.pending++]=t},er=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},ms=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),e.state.wrap===1?e.adler=Xn(e.adler,t,i,n):e.state.wrap===2&&(e.adler=Te(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},$a=(e,t)=>{let n=e.max_chain_length,r=e.strstart,i,s,l=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-pt?e.strstart-(e.w_size-pt):0,h=e.window,u=e.w_mask,f=e.prev,p=e.strstart+Ut;let g=h[r+l-1],b=h[r+l];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do if(i=t,!(h[i+l]!==b||h[i+l-1]!==g||h[i]!==h[r]||h[++i]!==h[r+1])){r+=2,i++;do;while(h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&r<p);if(s=Ut-(p-r),r=p-Ut,s>l){if(e.match_start=t,l=s,s>=a)break;g=h[r+l-1],b=h[r+l]}}while((t=f[t&u])>c&&--n!==0);return l<=e.lookahead?l:e.lookahead},kn=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-pt)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),af(e),r+=t),e.strm.avail_in===0)break;if(n=ms(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=le)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=zt(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=zt(e,e.ins_h,e.window[i+le-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<le)););}while(e.lookahead<pt&&e.strm.avail_in!==0)},Ya=(e,t)=>{let n=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,r,i,s,l=0,a=e.strm.avail_in;do{if(r=65535,s=e.bi_valid+42>>3,e.strm.avail_out<s||(s=e.strm.avail_out-s,i=e.strstart-e.block_start,r>i+e.strm.avail_in&&(r=i+e.strm.avail_in),r>s&&(r=s),r<n&&(r===0&&t!==Ge||t===Mt||r!==i+e.strm.avail_in)))break;l=t===Ge&&r===i+e.strm.avail_in?1:0,cs(e,0,0,l),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,Ve(e.strm),i&&(i>r&&(i=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,r-=i),r&&(ms(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(l===0);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),l?vn:t!==Mt&&t!==Ge&&e.strm.avail_in===0&&e.strstart===e.block_start?yn:(s=e.window_size-e.strstart,e.strm.avail_in>s&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,s+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),s>e.strm.avail_in&&(s=e.strm.avail_in),s&&(ms(e.strm,e.window,e.strstart,s),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.high_water<e.strstart&&(e.high_water=e.strstart),s=e.bi_valid+42>>3,s=e.pending_buf_size-s>65535?65535:e.pending_buf_size-s,n=s>e.w_size?e.w_size:s,i=e.strstart-e.block_start,(i>=n||(i||t===Ge)&&t!==Mt&&e.strm.avail_in===0&&i<=s)&&(r=i>s?s:i,l=t===Ge&&e.strm.avail_in===0&&r===i?1:0,cs(e,e.block_start,r,l),e.block_start+=r,Ve(e.strm)),l?Xt:ze)},bs=(e,t)=>{let n,r;for(;;){if(e.lookahead<pt){if(kn(e),e.lookahead<pt&&t===Mt)return ze;if(e.lookahead===0)break}if(n=0,e.lookahead>=le&&(e.ins_h=zt(e,e.ins_h,e.window[e.strstart+le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-pt&&(e.match_length=$a(e,n)),e.match_length>=le)if(r=Ot(e,e.strstart-e.match_start,e.match_length-le),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=le){e.match_length--;do e.strstart++,e.ins_h=zt(e,e.ins_h,e.window[e.strstart+le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=zt(e,e.ins_h,e.window[e.strstart+1]);else r=Ot(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(We(e,!1),e.strm.avail_out===0))return ze}return e.insert=e.strstart<le-1?e.strstart:le-1,t===Ge?(We(e,!0),e.strm.avail_out===0?Xt:vn):e.sym_next&&(We(e,!1),e.strm.avail_out===0)?ze:yn},En=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<pt){if(kn(e),e.lookahead<pt&&t===Mt)return ze;if(e.lookahead===0)break}if(n=0,e.lookahead>=le&&(e.ins_h=zt(e,e.ins_h,e.window[e.strstart+le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=le-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-pt&&(e.match_length=$a(e,n),e.match_length<=5&&(e.strategy===Vu||e.match_length===le&&e.strstart-e.match_start>4096)&&(e.match_length=le-1)),e.prev_length>=le&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-le,r=Ot(e,e.strstart-1-e.prev_match,e.prev_length-le),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=zt(e,e.ins_h,e.window[e.strstart+le-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=le-1,e.strstart++,r&&(We(e,!1),e.strm.avail_out===0))return ze}else if(e.match_available){if(r=Ot(e,0,e.window[e.strstart-1]),r&&We(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return ze}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Ot(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<le-1?e.strstart:le-1,t===Ge?(We(e,!0),e.strm.avail_out===0?Xt:vn):e.sym_next&&(We(e,!1),e.strm.avail_out===0)?ze:yn},cf=(e,t)=>{let n,r,i,s;const l=e.window;for(;;){if(e.lookahead<=Ut){if(kn(e),e.lookahead<=Ut&&t===Mt)return ze;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=le&&e.strstart>0&&(i=e.strstart-1,r=l[i],r===l[++i]&&r===l[++i]&&r===l[++i])){s=e.strstart+Ut;do;while(r===l[++i]&&r===l[++i]&&r===l[++i]&&r===l[++i]&&r===l[++i]&&r===l[++i]&&r===l[++i]&&r===l[++i]&&i<s);e.match_length=Ut-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=le?(n=Ot(e,1,e.match_length-le),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Ot(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(We(e,!1),e.strm.avail_out===0))return ze}return e.insert=0,t===Ge?(We(e,!0),e.strm.avail_out===0?Xt:vn):e.sym_next&&(We(e,!1),e.strm.avail_out===0)?ze:yn},hf=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(kn(e),e.lookahead===0)){if(t===Mt)return ze;break}if(e.match_length=0,n=Ot(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(We(e,!1),e.strm.avail_out===0))return ze}return e.insert=0,t===Ge?(We(e,!0),e.strm.avail_out===0?Xt:vn):e.sym_next&&(We(e,!1),e.strm.avail_out===0)?ze:yn};function _t(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const tr=[new _t(0,0,0,0,Ya),new _t(4,4,8,4,bs),new _t(4,5,16,8,bs),new _t(4,6,32,32,bs),new _t(4,4,16,16,En),new _t(8,16,32,32,En),new _t(8,16,128,128,En),new _t(8,32,128,256,En),new _t(32,128,258,1024,En),new _t(32,258,258,4096,En)],df=e=>{e.window_size=2*e.w_size,Pt(e.head),e.max_lazy_match=tr[e.level].max_lazy,e.good_match=tr[e.level].good_length,e.nice_match=tr[e.level].nice_length,e.max_chain_length=tr[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=le-1,e.match_available=0,e.ins_h=0};function uf(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Kr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(nf*2),this.dyn_dtree=new Uint16Array((2*ef+1)*2),this.bl_tree=new Uint16Array((2*tf+1)*2),Pt(this.dyn_ltree),Pt(this.dyn_dtree),Pt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(rf+1),this.heap=new Uint16Array(2*ds+1),Pt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*ds+1),Pt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const nr=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==wn&&t.status!==us&&t.status!==fs&&t.status!==gs&&t.status!==ps&&t.status!==_s&&t.status!==Gt&&t.status!==Qn?1:0},Ka=e=>{if(nr(e))return Qt(e,gt);e.total_in=e.total_out=0,e.data_type=Yu;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?us:t.wrap?wn:Gt,e.adler=t.wrap===2?0:1,t.last_flush=-2,Pu(t),Ne},Ja=e=>{const t=Ka(e);return t===Ne&&df(e.state),t},ff=(e,t)=>nr(e)||e.state.wrap!==2?gt:(e.state.gzhead=t,Ne),Ga=(e,t,n,r,i,s)=>{if(!e)return gt;let l=1;if(t===Zu&&(t=6),r<0?(l=0,r=-r):r>15&&(l=2,r-=16),i<1||i>Ku||n!==Kr||r<8||r>15||t<0||t>9||s<0||s>qu||r===8&&l!==1)return Qt(e,gt);r===8&&(r=9);const a=new uf;return e.state=a,a.strm=e,a.status=wn,a.wrap=l,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+le-1)/le),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=t,a.strategy=s,a.method=n,Ja(e)},gf=(e,t)=>Ga(e,t,Kr,Ju,Gu,$u),pf=(e,t)=>{if(nr(e)||t>Va||t<0)return e?Qt(e,gt):gt;const n=e.state;if(!e.output||e.avail_in!==0&&!e.input||n.status===Qn&&t!==Ge)return Qt(e,e.avail_out===0?hs:gt);const r=n.last_flush;if(n.last_flush=t,n.pending!==0){if(Ve(e),e.avail_out===0)return n.last_flush=-1,Ne}else if(e.avail_in===0&&qa(t)<=qa(r)&&t!==Ge)return Qt(e,hs);if(n.status===Qn&&e.avail_in!==0)return Qt(e,hs);if(n.status===wn&&n.wrap===0&&(n.status=Gt),n.status===wn){let i=Kr+(n.w_bits-8<<4)<<8,s=-1;if(n.strategy>=Yr||n.level<2?s=0:n.level<6?s=1:n.level===6?s=2:s=3,i|=s<<6,n.strstart!==0&&(i|=sf),i+=31-i%31,er(n,i),n.strstart!==0&&(er(n,e.adler>>>16),er(n,e.adler&65535)),e.adler=1,n.status=Gt,Ve(e),n.pending!==0)return n.last_flush=-1,Ne}if(n.status===us){if(e.adler=0,de(n,31),de(n,139),de(n,8),n.gzhead)de(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),de(n,n.gzhead.time&255),de(n,n.gzhead.time>>8&255),de(n,n.gzhead.time>>16&255),de(n,n.gzhead.time>>24&255),de(n,n.level===9?2:n.strategy>=Yr||n.level<2?4:0),de(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(de(n,n.gzhead.extra.length&255),de(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Te(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=fs;else if(de(n,0),de(n,0),de(n,0),de(n,0),de(n,0),de(n,n.level===9?2:n.strategy>=Yr||n.level<2?4:0),de(n,of),n.status=Gt,Ve(e),n.pending!==0)return n.last_flush=-1,Ne}if(n.status===fs){if(n.gzhead.extra){let i=n.pending,s=(n.gzhead.extra.length&65535)-n.gzindex;for(;n.pending+s>n.pending_buf_size;){let a=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+a),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>i&&(e.adler=Te(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex+=a,Ve(e),n.pending!==0)return n.last_flush=-1,Ne;i=0,s-=a}let l=new Uint8Array(n.gzhead.extra);n.pending_buf.set(l.subarray(n.gzindex,n.gzindex+s),n.pending),n.pending+=s,n.gzhead.hcrc&&n.pending>i&&(e.adler=Te(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=gs}if(n.status===gs){if(n.gzhead.name){let i=n.pending,s;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Te(e.adler,n.pending_buf,n.pending-i,i)),Ve(e),n.pending!==0)return n.last_flush=-1,Ne;i=0}n.gzindex<n.gzhead.name.length?s=n.gzhead.name.charCodeAt(n.gzindex++)&255:s=0,de(n,s)}while(s!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Te(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=ps}if(n.status===ps){if(n.gzhead.comment){let i=n.pending,s;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=Te(e.adler,n.pending_buf,n.pending-i,i)),Ve(e),n.pending!==0)return n.last_flush=-1,Ne;i=0}n.gzindex<n.gzhead.comment.length?s=n.gzhead.comment.charCodeAt(n.gzindex++)&255:s=0,de(n,s)}while(s!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Te(e.adler,n.pending_buf,n.pending-i,i))}n.status=_s}if(n.status===_s){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Ve(e),n.pending!==0))return n.last_flush=-1,Ne;de(n,e.adler&255),de(n,e.adler>>8&255),e.adler=0}if(n.status=Gt,Ve(e),n.pending!==0)return n.last_flush=-1,Ne}if(e.avail_in!==0||n.lookahead!==0||t!==Mt&&n.status!==Qn){let i=n.level===0?Ya(n,t):n.strategy===Yr?hf(n,t):n.strategy===Wu?cf(n,t):tr[n.level].func(n,t);if((i===Xt||i===vn)&&(n.status=Qn),i===ze||i===Xt)return e.avail_out===0&&(n.last_flush=-1),Ne;if(i===yn&&(t===ju?Bu(n):t!==Va&&(cs(n,0,0,!1),t===Fu&&(Pt(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),Ve(e),e.avail_out===0))return n.last_flush=-1,Ne}return t!==Ge?Ne:n.wrap<=0?Wa:(n.wrap===2?(de(n,e.adler&255),de(n,e.adler>>8&255),de(n,e.adler>>16&255),de(n,e.adler>>24&255),de(n,e.total_in&255),de(n,e.total_in>>8&255),de(n,e.total_in>>16&255),de(n,e.total_in>>24&255)):(er(n,e.adler>>>16),er(n,e.adler&65535)),Ve(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?Ne:Wa)},_f=e=>{if(nr(e))return gt;const t=e.state.status;return e.state=null,t===Gt?Qt(e,Hu):Ne},mf=(e,t)=>{let n=t.length;if(nr(e))return gt;const r=e.state,i=r.wrap;if(i===2||i===1&&r.status!==wn||r.lookahead)return gt;if(i===1&&(e.adler=Xn(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){i===0&&(Pt(r.head),r.strstart=0,r.block_start=0,r.insert=0);let c=new Uint8Array(r.w_size);c.set(t.subarray(n-r.w_size,n),0),t=c,n=r.w_size}const s=e.avail_in,l=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,kn(r);r.lookahead>=le;){let c=r.strstart,h=r.lookahead-(le-1);do r.ins_h=zt(r,r.ins_h,r.window[c+le-1]),r.prev[c&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=c,c++;while(--h);r.strstart=c,r.lookahead=le-1,kn(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=le-1,r.match_available=0,e.next_in=l,e.input=a,e.avail_in=s,r.wrap=i,Ne};var bf=gf,wf=Ga,yf=Ja,vf=Ka,kf=ff,Ef=pf,Cf=_f,Sf=mf,Af="pako deflate (from Nodeca project)",rr={deflateInit:bf,deflateInit2:wf,deflateReset:yf,deflateResetKeep:vf,deflateSetHeader:kf,deflate:Ef,deflateEnd:Cf,deflateSetDictionary:Sf,deflateInfo:Af};const Rf=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var xf=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)Rf(n,r)&&(e[r]=n[r])}}return e},Tf=e=>{let t=0;for(let r=0,i=e.length;r<i;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,i=0,s=e.length;r<s;r++){let l=e[r];n.set(l,i),i+=l.length}return n},Jr={assign:xf,flattenChunks:Tf};let Xa=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Xa=!1}const ir=new Uint8Array(256);for(let e=0;e<256;e++)ir[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;ir[254]=ir[254]=1;var Df=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,r,i,s,l=e.length,a=0;for(i=0;i<l;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<l&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),s=0,i=0;s<a;i++)n=e.charCodeAt(i),(n&64512)===55296&&i+1<l&&(r=e.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|n&63):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|n&63):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|n&63);return t};const If=(e,t)=>{if(t<65534&&e.subarray&&Xa)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n};var Nf=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,i;const s=new Array(n*2);for(i=0,r=0;r<n;){let l=e[r++];if(l<128){s[i++]=l;continue}let a=ir[l];if(a>4){s[i++]=65533,r+=a-1;continue}for(l&=a===2?31:a===3?15:7;a>1&&r<n;)l=l<<6|e[r++]&63,a--;if(a>1){s[i++]=65533;continue}l<65536?s[i++]=l:(l-=65536,s[i++]=55296|l>>10&1023,s[i++]=56320|l&1023)}return If(s,i)},Lf=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+ir[e[n]]>t?n:t},sr={string2buf:Df,buf2string:Nf,utf8border:Lf};function Of(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Qa=Of;const el=Object.prototype.toString,{Z_NO_FLUSH:Mf,Z_SYNC_FLUSH:Uf,Z_FULL_FLUSH:Pf,Z_FINISH:zf,Z_OK:Gr,Z_STREAM_END:Bf,Z_DEFAULT_COMPRESSION:jf,Z_DEFAULT_STRATEGY:Ff,Z_DEFLATED:Hf}=bn;function or(e){this.options=Jr.assign({level:jf,method:Hf,chunkSize:16384,windowBits:15,memLevel:8,strategy:Ff},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qa,this.strm.avail_out=0;let n=rr.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Gr)throw new Error(Jt[n]);if(t.header&&rr.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=sr.string2buf(t.dictionary):el.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,n=rr.deflateSetDictionary(this.strm,r),n!==Gr)throw new Error(Jt[n]);this._dict_set=!0}}or.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,s;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?zf:Mf,typeof e=="string"?n.input=sr.string2buf(e):el.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(s===Uf||s===Pf)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(i=rr.deflate(n,s),i===Bf)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=rr.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Gr;if(n.avail_out===0){this.onData(n.output);continue}if(s>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0},or.prototype.onData=function(e){this.chunks.push(e)},or.prototype.onEnd=function(e){e===Gr&&(this.result=Jr.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function ws(e,t){const n=new or(t);if(n.push(e,!0),n.err)throw n.msg||Jt[n.err];return n.result}function Zf(e,t){return t=t||{},t.raw=!0,ws(e,t)}function Vf(e,t){return t=t||{},t.gzip=!0,ws(e,t)}var Wf=or,qf=ws,$f=Zf,Yf=Vf,Kf=bn,Jf={Deflate:Wf,deflate:qf,deflateRaw:$f,gzip:Yf,constants:Kf};const Xr=16209,Gf=16191;var Xf=function(e,t){let n,r,i,s,l,a,c,h,u,f,p,g,b,v,D,x,L,m,w,E,S,k,T,I;const C=e.state;n=e.next_in,T=e.input,r=n+(e.avail_in-5),i=e.next_out,I=e.output,s=i-(t-e.avail_out),l=i+(e.avail_out-257),a=C.dmax,c=C.wsize,h=C.whave,u=C.wnext,f=C.window,p=C.hold,g=C.bits,b=C.lencode,v=C.distcode,D=(1<<C.lenbits)-1,x=(1<<C.distbits)-1;e:do{g<15&&(p+=T[n++]<<g,g+=8,p+=T[n++]<<g,g+=8),L=b[p&D];t:for(;;){if(m=L>>>24,p>>>=m,g-=m,m=L>>>16&255,m===0)I[i++]=L&65535;else if(m&16){w=L&65535,m&=15,m&&(g<m&&(p+=T[n++]<<g,g+=8),w+=p&(1<<m)-1,p>>>=m,g-=m),g<15&&(p+=T[n++]<<g,g+=8,p+=T[n++]<<g,g+=8),L=v[p&x];n:for(;;){if(m=L>>>24,p>>>=m,g-=m,m=L>>>16&255,m&16){if(E=L&65535,m&=15,g<m&&(p+=T[n++]<<g,g+=8,g<m&&(p+=T[n++]<<g,g+=8)),E+=p&(1<<m)-1,E>a){e.msg="invalid distance too far back",C.mode=Xr;break e}if(p>>>=m,g-=m,m=i-s,E>m){if(m=E-m,m>h&&C.sane){e.msg="invalid distance too far back",C.mode=Xr;break e}if(S=0,k=f,u===0){if(S+=c-m,m<w){w-=m;do I[i++]=f[S++];while(--m);S=i-E,k=I}}else if(u<m){if(S+=c+u-m,m-=u,m<w){w-=m;do I[i++]=f[S++];while(--m);if(S=0,u<w){m=u,w-=m;do I[i++]=f[S++];while(--m);S=i-E,k=I}}}else if(S+=u-m,m<w){w-=m;do I[i++]=f[S++];while(--m);S=i-E,k=I}for(;w>2;)I[i++]=k[S++],I[i++]=k[S++],I[i++]=k[S++],w-=3;w&&(I[i++]=k[S++],w>1&&(I[i++]=k[S++]))}else{S=i-E;do I[i++]=I[S++],I[i++]=I[S++],I[i++]=I[S++],w-=3;while(w>2);w&&(I[i++]=I[S++],w>1&&(I[i++]=I[S++]))}}else if(m&64){e.msg="invalid distance code",C.mode=Xr;break e}else{L=v[(L&65535)+(p&(1<<m)-1)];continue n}break}}else if(m&64)if(m&32){C.mode=Gf;break e}else{e.msg="invalid literal/length code",C.mode=Xr;break e}else{L=b[(L&65535)+(p&(1<<m)-1)];continue t}break}}while(n<r&&i<l);w=g>>3,n-=w,g-=w<<3,p&=(1<<g)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?5+(r-n):5-(n-r),e.avail_out=i<l?257+(l-i):257-(i-l),C.hold=p,C.bits=g};const Cn=15,tl=852,nl=592,rl=0,ys=1,il=2,Qf=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),eg=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),tg=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ng=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ar=(e,t,n,r,i,s,l,a)=>{const c=a.bits;let h=0,u=0,f=0,p=0,g=0,b=0,v=0,D=0,x=0,L=0,m,w,E,S,k,T=null,I;const C=new Uint16Array(Cn+1),R=new Uint16Array(Cn+1);let P=null,z,Z,H;for(h=0;h<=Cn;h++)C[h]=0;for(u=0;u<r;u++)C[t[n+u]]++;for(g=c,p=Cn;p>=1&&C[p]===0;p--);if(g>p&&(g=p),p===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,a.bits=1,0;for(f=1;f<p&&C[f]===0;f++);for(g<f&&(g=f),D=1,h=1;h<=Cn;h++)if(D<<=1,D-=C[h],D<0)return-1;if(D>0&&(e===rl||p!==1))return-1;for(R[1]=0,h=1;h<Cn;h++)R[h+1]=R[h]+C[h];for(u=0;u<r;u++)t[n+u]!==0&&(l[R[t[n+u]]++]=u);if(e===rl?(T=P=l,I=20):e===ys?(T=Qf,P=eg,I=257):(T=tg,P=ng,I=0),L=0,u=0,h=f,k=s,b=g,v=0,E=-1,x=1<<g,S=x-1,e===ys&&x>tl||e===il&&x>nl)return 1;for(;;){z=h-v,l[u]+1<I?(Z=0,H=l[u]):l[u]>=I?(Z=P[l[u]-I],H=T[l[u]-I]):(Z=32+64,H=0),m=1<<h-v,w=1<<b,f=w;do w-=m,i[k+(L>>v)+w]=z<<24|Z<<16|H|0;while(w!==0);for(m=1<<h-1;L&m;)m>>=1;if(m!==0?(L&=m-1,L+=m):L=0,u++,--C[h]===0){if(h===p)break;h=t[n+l[u]]}if(h>g&&(L&S)!==E){for(v===0&&(v=g),k+=f,b=h-v,D=1<<b;b+v<p&&(D-=C[b+v],!(D<=0));)b++,D<<=1;if(x+=1<<b,e===ys&&x>tl||e===il&&x>nl)return 1;E=L&S,i[E]=g<<24|b<<16|k-s|0}}return L!==0&&(i[k+L]=h-v<<24|64<<16|0),a.bits=g,0};const rg=0,sl=1,ol=2,{Z_FINISH:al,Z_BLOCK:ig,Z_TREES:Qr,Z_OK:en,Z_STREAM_END:sg,Z_NEED_DICT:og,Z_STREAM_ERROR:nt,Z_DATA_ERROR:ll,Z_MEM_ERROR:cl,Z_BUF_ERROR:ag,Z_DEFLATED:hl}=bn,ei=16180,dl=16181,ul=16182,fl=16183,gl=16184,pl=16185,_l=16186,ml=16187,bl=16188,wl=16189,ti=16190,At=16191,vs=16192,yl=16193,ks=16194,vl=16195,kl=16196,El=16197,Cl=16198,ni=16199,ri=16200,Sl=16201,Al=16202,Rl=16203,xl=16204,Tl=16205,Es=16206,Dl=16207,Il=16208,pe=16209,Nl=16210,Ll=16211,lg=852,cg=592,hg=15,dg=hg,Ol=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function ug(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const tn=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<ei||t.mode>Ll?1:0},Ml=e=>{if(tn(e))return nt;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=ei,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(lg),t.distcode=t.distdyn=new Int32Array(cg),t.sane=1,t.back=-1,en},Ul=e=>{if(tn(e))return nt;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Ml(e)},Pl=(e,t)=>{let n;if(tn(e))return nt;const r=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?nt:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,Ul(e))},zl=(e,t)=>{if(!e)return nt;const n=new ug;e.state=n,n.strm=e,n.window=null,n.mode=ei;const r=Pl(e,t);return r!==en&&(e.state=null),r},fg=e=>zl(e,dg);let Bl=!0,Cs,Ss;const gg=e=>{if(Bl){Cs=new Int32Array(512),Ss=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ar(sl,e.lens,0,288,Cs,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ar(ol,e.lens,0,32,Ss,0,e.work,{bits:5}),Bl=!1}e.lencode=Cs,e.lenbits=9,e.distcode=Ss,e.distbits=5},jl=(e,t,n,r)=>{let i;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(t.subarray(n-r,n-r+i),s.wnext),r-=i,r?(s.window.set(t.subarray(n-r,n),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},pg=(e,t)=>{let n,r,i,s,l,a,c,h,u,f,p,g,b,v,D=0,x,L,m,w,E,S,k,T;const I=new Uint8Array(4);let C,R;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(tn(e)||!e.output||!e.input&&e.avail_in!==0)return nt;n=e.state,n.mode===At&&(n.mode=vs),l=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,r=e.input,a=e.avail_in,h=n.hold,u=n.bits,f=a,p=c,T=en;e:for(;;)switch(n.mode){case ei:if(n.wrap===0){n.mode=vs;break}for(;u<16;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(n.wrap&2&&h===35615){n.wbits===0&&(n.wbits=15),n.check=0,I[0]=h&255,I[1]=h>>>8&255,n.check=Te(n.check,I,2,0),h=0,u=0,n.mode=dl;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((h&255)<<8)+(h>>8))%31){e.msg="incorrect header check",n.mode=pe;break}if((h&15)!==hl){e.msg="unknown compression method",n.mode=pe;break}if(h>>>=4,u-=4,k=(h&15)+8,n.wbits===0&&(n.wbits=k),k>15||k>n.wbits){e.msg="invalid window size",n.mode=pe;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=h&512?wl:At,h=0,u=0;break;case dl:for(;u<16;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(n.flags=h,(n.flags&255)!==hl){e.msg="unknown compression method",n.mode=pe;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=pe;break}n.head&&(n.head.text=h>>8&1),n.flags&512&&n.wrap&4&&(I[0]=h&255,I[1]=h>>>8&255,n.check=Te(n.check,I,2,0)),h=0,u=0,n.mode=ul;case ul:for(;u<32;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.head&&(n.head.time=h),n.flags&512&&n.wrap&4&&(I[0]=h&255,I[1]=h>>>8&255,I[2]=h>>>16&255,I[3]=h>>>24&255,n.check=Te(n.check,I,4,0)),h=0,u=0,n.mode=fl;case fl:for(;u<16;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.head&&(n.head.xflags=h&255,n.head.os=h>>8),n.flags&512&&n.wrap&4&&(I[0]=h&255,I[1]=h>>>8&255,n.check=Te(n.check,I,2,0)),h=0,u=0,n.mode=gl;case gl:if(n.flags&1024){for(;u<16;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.length=h,n.head&&(n.head.extra_len=h),n.flags&512&&n.wrap&4&&(I[0]=h&255,I[1]=h>>>8&255,n.check=Te(n.check,I,2,0)),h=0,u=0}else n.head&&(n.head.extra=null);n.mode=pl;case pl:if(n.flags&1024&&(g=n.length,g>a&&(g=a),g&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(s,s+g),k)),n.flags&512&&n.wrap&4&&(n.check=Te(n.check,r,g,s)),a-=g,s+=g,n.length-=g),n.length))break e;n.length=0,n.mode=_l;case _l:if(n.flags&2048){if(a===0)break e;g=0;do k=r[s+g++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k));while(k&&g<a);if(n.flags&512&&n.wrap&4&&(n.check=Te(n.check,r,g,s)),a-=g,s+=g,k)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=ml;case ml:if(n.flags&4096){if(a===0)break e;g=0;do k=r[s+g++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k));while(k&&g<a);if(n.flags&512&&n.wrap&4&&(n.check=Te(n.check,r,g,s)),a-=g,s+=g,k)break e}else n.head&&(n.head.comment=null);n.mode=bl;case bl:if(n.flags&512){for(;u<16;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(n.wrap&4&&h!==(n.check&65535)){e.msg="header crc mismatch",n.mode=pe;break}h=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=At;break;case wl:for(;u<32;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}e.adler=n.check=Ol(h),h=0,u=0,n.mode=ti;case ti:if(n.havedict===0)return e.next_out=l,e.avail_out=c,e.next_in=s,e.avail_in=a,n.hold=h,n.bits=u,og;e.adler=n.check=1,n.mode=At;case At:if(t===ig||t===Qr)break e;case vs:if(n.last){h>>>=u&7,u-=u&7,n.mode=Es;break}for(;u<3;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}switch(n.last=h&1,h>>>=1,u-=1,h&3){case 0:n.mode=yl;break;case 1:if(gg(n),n.mode=ni,t===Qr){h>>>=2,u-=2;break e}break;case 2:n.mode=kl;break;case 3:e.msg="invalid block type",n.mode=pe}h>>>=2,u-=2;break;case yl:for(h>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if((h&65535)!==(h>>>16^65535)){e.msg="invalid stored block lengths",n.mode=pe;break}if(n.length=h&65535,h=0,u=0,n.mode=ks,t===Qr)break e;case ks:n.mode=vl;case vl:if(g=n.length,g){if(g>a&&(g=a),g>c&&(g=c),g===0)break e;i.set(r.subarray(s,s+g),l),a-=g,s+=g,c-=g,l+=g,n.length-=g;break}n.mode=At;break;case kl:for(;u<14;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(n.nlen=(h&31)+257,h>>>=5,u-=5,n.ndist=(h&31)+1,h>>>=5,u-=5,n.ncode=(h&15)+4,h>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=pe;break}n.have=0,n.mode=El;case El:for(;n.have<n.ncode;){for(;u<3;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.lens[P[n.have++]]=h&7,h>>>=3,u-=3}for(;n.have<19;)n.lens[P[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},T=ar(rg,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,T){e.msg="invalid code lengths set",n.mode=pe;break}n.have=0,n.mode=Cl;case Cl:for(;n.have<n.nlen+n.ndist;){for(;D=n.lencode[h&(1<<n.lenbits)-1],x=D>>>24,L=D>>>16&255,m=D&65535,!(x<=u);){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(m<16)h>>>=x,u-=x,n.lens[n.have++]=m;else{if(m===16){for(R=x+2;u<R;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(h>>>=x,u-=x,n.have===0){e.msg="invalid bit length repeat",n.mode=pe;break}k=n.lens[n.have-1],g=3+(h&3),h>>>=2,u-=2}else if(m===17){for(R=x+3;u<R;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}h>>>=x,u-=x,k=0,g=3+(h&7),h>>>=3,u-=3}else{for(R=x+7;u<R;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}h>>>=x,u-=x,k=0,g=11+(h&127),h>>>=7,u-=7}if(n.have+g>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=pe;break}for(;g--;)n.lens[n.have++]=k}}if(n.mode===pe)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=pe;break}if(n.lenbits=9,C={bits:n.lenbits},T=ar(sl,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,T){e.msg="invalid literal/lengths set",n.mode=pe;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},T=ar(ol,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,T){e.msg="invalid distances set",n.mode=pe;break}if(n.mode=ni,t===Qr)break e;case ni:n.mode=ri;case ri:if(a>=6&&c>=258){e.next_out=l,e.avail_out=c,e.next_in=s,e.avail_in=a,n.hold=h,n.bits=u,Xf(e,p),l=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,r=e.input,a=e.avail_in,h=n.hold,u=n.bits,n.mode===At&&(n.back=-1);break}for(n.back=0;D=n.lencode[h&(1<<n.lenbits)-1],x=D>>>24,L=D>>>16&255,m=D&65535,!(x<=u);){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(L&&!(L&240)){for(w=x,E=L,S=m;D=n.lencode[S+((h&(1<<w+E)-1)>>w)],x=D>>>24,L=D>>>16&255,m=D&65535,!(w+x<=u);){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}h>>>=w,u-=w,n.back+=w}if(h>>>=x,u-=x,n.back+=x,n.length=m,L===0){n.mode=Tl;break}if(L&32){n.back=-1,n.mode=At;break}if(L&64){e.msg="invalid literal/length code",n.mode=pe;break}n.extra=L&15,n.mode=Sl;case Sl:if(n.extra){for(R=n.extra;u<R;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.length+=h&(1<<n.extra)-1,h>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=Al;case Al:for(;D=n.distcode[h&(1<<n.distbits)-1],x=D>>>24,L=D>>>16&255,m=D&65535,!(x<=u);){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(!(L&240)){for(w=x,E=L,S=m;D=n.distcode[S+((h&(1<<w+E)-1)>>w)],x=D>>>24,L=D>>>16&255,m=D&65535,!(w+x<=u);){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}h>>>=w,u-=w,n.back+=w}if(h>>>=x,u-=x,n.back+=x,L&64){e.msg="invalid distance code",n.mode=pe;break}n.offset=m,n.extra=L&15,n.mode=Rl;case Rl:if(n.extra){for(R=n.extra;u<R;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}n.offset+=h&(1<<n.extra)-1,h>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=pe;break}n.mode=xl;case xl:if(c===0)break e;if(g=p-c,n.offset>g){if(g=n.offset-g,g>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=pe;break}g>n.wnext?(g-=n.wnext,b=n.wsize-g):b=n.wnext-g,g>n.length&&(g=n.length),v=n.window}else v=i,b=l-n.offset,g=n.length;g>c&&(g=c),c-=g,n.length-=g;do i[l++]=v[b++];while(--g);n.length===0&&(n.mode=ri);break;case Tl:if(c===0)break e;i[l++]=n.length,c--,n.mode=ri;break;case Es:if(n.wrap){for(;u<32;){if(a===0)break e;a--,h|=r[s++]<<u,u+=8}if(p-=c,e.total_out+=p,n.total+=p,n.wrap&4&&p&&(e.adler=n.check=n.flags?Te(n.check,i,p,l-p):Xn(n.check,i,p,l-p)),p=c,n.wrap&4&&(n.flags?h:Ol(h))!==n.check){e.msg="incorrect data check",n.mode=pe;break}h=0,u=0}n.mode=Dl;case Dl:if(n.wrap&&n.flags){for(;u<32;){if(a===0)break e;a--,h+=r[s++]<<u,u+=8}if(n.wrap&4&&h!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=pe;break}h=0,u=0}n.mode=Il;case Il:T=sg;break e;case pe:T=ll;break e;case Nl:return cl;case Ll:default:return nt}return e.next_out=l,e.avail_out=c,e.next_in=s,e.avail_in=a,n.hold=h,n.bits=u,(n.wsize||p!==e.avail_out&&n.mode<pe&&(n.mode<Es||t!==al))&&jl(e,e.output,e.next_out,p-e.avail_out),f-=e.avail_in,p-=e.avail_out,e.total_in+=f,e.total_out+=p,n.total+=p,n.wrap&4&&p&&(e.adler=n.check=n.flags?Te(n.check,i,p,e.next_out-p):Xn(n.check,i,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(n.mode===At?128:0)+(n.mode===ni||n.mode===ks?256:0),(f===0&&p===0||t===al)&&T===en&&(T=ag),T},_g=e=>{if(tn(e))return nt;let t=e.state;return t.window&&(t.window=null),e.state=null,en},mg=(e,t)=>{if(tn(e))return nt;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,en):nt},bg=(e,t)=>{const n=t.length;let r,i,s;return tn(e)||(r=e.state,r.wrap!==0&&r.mode!==ti)?nt:r.mode===ti&&(i=1,i=Xn(i,t,n,0),i!==r.check)?ll:(s=jl(e,t,n,n),s?(r.mode=Nl,cl):(r.havedict=1,en))};var wg=Ul,yg=Pl,vg=Ml,kg=fg,Eg=zl,Cg=pg,Sg=_g,Ag=mg,Rg=bg,xg="pako inflate (from Nodeca project)",Rt={inflateReset:wg,inflateReset2:yg,inflateResetKeep:vg,inflateInit:kg,inflateInit2:Eg,inflate:Cg,inflateEnd:Sg,inflateGetHeader:Ag,inflateSetDictionary:Rg,inflateInfo:xg};function Tg(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Dg=Tg;const Fl=Object.prototype.toString,{Z_NO_FLUSH:Ig,Z_FINISH:Ng,Z_OK:lr,Z_STREAM_END:As,Z_NEED_DICT:Rs,Z_STREAM_ERROR:Lg,Z_DATA_ERROR:Hl,Z_MEM_ERROR:Og}=bn;function cr(e){this.options=Jr.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qa,this.strm.avail_out=0;let n=Rt.inflateInit2(this.strm,t.windowBits);if(n!==lr)throw new Error(Jt[n]);if(this.header=new Dg,Rt.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=sr.string2buf(t.dictionary):Fl.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Rt.inflateSetDictionary(this.strm,t.dictionary),n!==lr)))throw new Error(Jt[n])}cr.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,l,a;if(this.ended)return!1;for(t===~~t?l=t:l=t===!0?Ng:Ig,Fl.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),s=Rt.inflate(n,l),s===Rs&&i&&(s=Rt.inflateSetDictionary(n,i),s===lr?s=Rt.inflate(n,l):s===Hl&&(s=Rs));n.avail_in>0&&s===As&&n.state.wrap>0&&e[n.next_in]!==0;)Rt.inflateReset(n),s=Rt.inflate(n,l);switch(s){case Lg:case Hl:case Rs:case Og:return this.onEnd(s),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(n.avail_out===0||s===As))if(this.options.to==="string"){let c=sr.utf8border(n.output,n.next_out),h=n.next_out-c,u=sr.buf2string(n.output,c);n.next_out=h,n.avail_out=r-h,h&&n.output.set(n.output.subarray(c,c+h),0),this.onData(u)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===lr&&a===0)){if(s===As)return s=Rt.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0},cr.prototype.onData=function(e){this.chunks.push(e)},cr.prototype.onEnd=function(e){e===lr&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Jr.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function xs(e,t){const n=new cr(t);if(n.push(e),n.err)throw n.msg||Jt[n.err];return n.result}function Mg(e,t){return t=t||{},t.raw=!0,xs(e,t)}var Ug=cr,Pg=xs,zg=Mg,Bg=xs,jg=bn,Fg={Inflate:Ug,inflate:Pg,inflateRaw:zg,ungzip:Bg,constants:jg};const{Deflate:Lp,deflate:Hg,deflateRaw:Op,gzip:Mp}=Jf,{Inflate:Up,inflate:Zg,inflateRaw:Pp,ungzip:zp}=Fg;var Vg=Hg,Wg=Zg;function qg(e){let t,n,r="code",i,s,l="tree",a,c;return{c(){t=ee("div"),n=ee("button"),n.textContent=r,i=Ce(),s=ee("button"),s.textContent=l,this.h()},l(h){t=te(h,"DIV",{class:!0});var u=ce(t);n=te(u,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(n)!=="svelte-1tzsrcf"&&(n.textContent=r),i=Se(u),s=te(u,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(s)!=="svelte-1f7s8uy"&&(s.textContent=l),u.forEach(X),this.h()},h(){j(n,"class","svelte-6hveha"),De(n,"active",e[0]=="code"),j(s,"class","svelte-6hveha"),De(s,"active",e[0]=="tree"),j(t,"class","row flex svelte-6hveha")},m(h,u){Xe(h,t,u),V(t,n),V(t,i),V(t,s),a||(c=[Qe(n,"click",e[1]),Qe(s,"click",e[2])],a=!0)},p(h,[u]){u&1&&De(n,"active",h[0]=="code"),u&1&&De(s,"active",h[0]=="tree")},i:Ts,o:Ts,d(h){h&&X(t),a=!1,Ds(c)}}}function $g(e,t,n){let r;return Yl(e,dr,i=>n(0,r=i)),[r,()=>{dr.set("code")},()=>{dr.set("tree")}]}class Yg extends Kl{constructor(t){super(),Jl(this,t,$g,qg,$l,{})}}function Kg(e){let t,n=`create lobby
                    <svg width="24" height="24" fill="#bdbdbd" version="1.0" viewBox="0 0 24 24" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><g><path d="M16.5,14c-1.5,0-2.7,0.4-3.6,0.9c1.4,1.2,2,2.6,2.1,2.7l0.1,0.2V20h8v-2C23,18,21.4,14,16.5,14z"></path></g><g><circle cx="16.5" cy="8.5" r="3.5"></circle></g></g><g><path d="M4,8.5C4,6.6,5.6,5,7.5,5S11,6.6,11,8.5c0,1.9-1.6,3.5-3.5,3.5S4,10.4,4,8.5z M7.5,14C2.6,14,1,18,1,18v2h13v-2   C14,18,12.4,14,7.5,14z"></path></g></svg>`,r,i;return{c(){t=ee("button"),t.innerHTML=n,this.h()},l(s){t=te(s,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(t)!=="svelte-1b5uz4i"&&(t.innerHTML=n),this.h()},h(){j(t,"class","flex items-center gap-2 gray-border p-1 px-3 rounded-md hidden")},m(s,l){Xe(s,t,l),r||(i=Qe(t,"click",e[13]),r=!0)},p:Ts,d(s){s&&X(t),r=!1,i()}}}function Jg(e){let t,n,r,i,s,l,a,c,h;function u(g,b){return g[9]?Gg:Xg}let f=u(e),p=f(e);return{c(){t=ee("div"),n=ee("input"),i=Ce(),s=ee("button"),l=ee("div"),a=ee("clipboard-copy"),p.c(),this.h()},l(g){t=te(g,"DIV",{class:!0});var b=ce(t);n=te(b,"INPUT",{class:!0,type:!0}),i=Se(b),s=te(b,"BUTTON",{});var v=ce(s);l=te(v,"DIV",{class:!0});var D=ce(l);a=te(D,"CLIPBOARD-COPY",{value:!0});var x=ce(a);p.l(x),x.forEach(X),D.forEach(X),v.forEach(X),b.forEach(X),this.h()},h(){var g;j(n,"class","w-full input-monospace svelte-189c5u6"),j(n,"type","text"),n.readOnly=!0,n.value=r=(g=e[6])==null?void 0:g.split("=")[1],ii(a,"value",e[6]),j(l,"class","h-full copy-btn flex items-center justify-center px-4 svelte-189c5u6"),j(t,"class","flex")},m(g,b){Xe(g,t,b),V(t,n),V(t,i),V(t,s),V(s,l),V(l,a),p.m(a,null),c||(h=Qe(s,"click",e[12]),c=!0)},p(g,b){var v;b&64&&r!==(r=(v=g[6])==null?void 0:v.split("=")[1])&&n.value!==r&&(n.value=r),f!==(f=u(g))&&(p.d(1),p=f(g),p&&(p.c(),p.m(a,null))),b&64&&ii(a,"value",g[6])},d(g){g&&X(t),p.d(),c=!1,h()}}}function Gg(e){let t,n;return{c(){t=mt("svg"),n=mt("path"),this.h()},l(r){t=bt(r,"svg",{"aria-hidden":!0,height:!0,viewBox:!0,version:!0,width:!0,"data-view-component":!0,class:!0});var i=ce(t);n=bt(i,"path",{fill:!0,d:!0}),ce(n).forEach(X),i.forEach(X),this.h()},h(){j(n,"fill","lightgreen"),j(n,"d","M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"),j(t,"aria-hidden","true"),j(t,"height","16"),j(t,"viewBox","0 0 16 16"),j(t,"version","1.1"),j(t,"width","16"),j(t,"data-view-component","true"),j(t,"class","")},m(r,i){Xe(r,t,i),V(t,n)},d(r){r&&X(t)}}}function Xg(e){let t,n,r;return{c(){t=mt("svg"),n=mt("path"),r=mt("path"),this.h()},l(i){t=bt(i,"svg",{"aria-hidden":!0,height:!0,viewBox:!0,version:!0,width:!0,"data-view-component":!0,class:!0});var s=ce(t);n=bt(s,"path",{d:!0,class:!0}),ce(n).forEach(X),r=bt(s,"path",{d:!0,class:!0}),ce(r).forEach(X),s.forEach(X),this.h()},h(){j(n,"d","M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"),j(n,"class","svelte-189c5u6"),j(r,"d","M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"),j(r,"class","svelte-189c5u6"),j(t,"aria-hidden","true"),j(t,"height","16"),j(t,"viewBox","0 0 16 16"),j(t,"version","1.1"),j(t,"width","16"),j(t,"data-view-component","true"),j(t,"class","octicon svelte-189c5u6")},m(i,s){Xe(i,t,s),V(t,n),V(t,r)},d(i){i&&X(t)}}}function Zl(e){let t,n='<div class="ios-buttons"><div class="ios-button close"></div> <div class="ios-button minimize"></div> <div class="ios-button maximize"></div></div>';return{c(){t=ee("div"),t.innerHTML=n},l(r){t=te(r,"DIV",{"data-svelte-h":!0}),Oe(t)!=="svelte-1sh1ecu"&&(t.innerHTML=n)},m(r,i){Xe(r,t,i)},d(r){r&&X(t)}}}function Vl(e){let t,n;return{c(){t=ee("div"),n=ap(e[5]),this.h()},l(r){t=te(r,"DIV",{class:!0});var i=ce(t);n=lp(i,e[5]),i.forEach(X),this.h()},h(){j(t,"class","grow p-3 pt-2 text-red-400 overflow-y-scroll")},m(r,i){Xe(r,t,i),V(t,n)},p(r,i){i&32&&cp(n,r[5])},d(r){r&&X(t)}}}function Wl(e){let t,n,r='<svg width="32" height="32" viewBox="0 0 98 96" xmlns="http://www.w3.org/2000/svg"><path fill="#bdbdbd" fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"></path></svg>',i,s,l,a,c,h,u,f,p,g,b,v="v1",D,x="v0",L,m,w,E,S="Mainnet",k,T="Testnet",I,C,R=`compile
                    <img src="command_line.png" class="w-4" alt=""/>`,P,z;function Z(K,F){return K[8]?Qg:ep}let H=Z(e),W=H(e),J=e[2]=="v0"&&ql(e);return{c(){t=ee("div"),n=ee("a"),n.innerHTML=r,i=Ce(),s=ee("div"),l=ee("div"),a=ee("input"),c=Ce(),h=ee("button"),u=ee("div"),f=ee("clipboard-copy"),W.c(),p=Ce(),g=ee("select"),b=ee("option"),b.textContent=v,D=ee("option"),D.textContent=x,L=Ce(),J&&J.c(),m=Ce(),w=ee("select"),E=ee("option"),E.textContent=S,k=ee("option"),k.textContent=T,I=Ce(),C=ee("button"),C.innerHTML=R,this.h()},l(K){t=te(K,"DIV",{class:!0});var F=ce(t);n=te(F,"A",{class:!0,href:!0,"data-svelte-h":!0}),Oe(n)!=="svelte-gsk1jy"&&(n.innerHTML=r),i=Se(F),s=te(F,"DIV",{class:!0});var ke=ce(s);l=te(ke,"DIV",{class:!0});var Ee=ce(l);a=te(Ee,"INPUT",{class:!0,type:!0}),c=Se(Ee),h=te(Ee,"BUTTON",{});var Me=ce(h);u=te(Me,"DIV",{class:!0});var ie=ce(u);f=te(ie,"CLIPBOARD-COPY",{value:!0});var G=ce(f);W.l(G),G.forEach(X),ie.forEach(X),Me.forEach(X),Ee.forEach(X),ke.forEach(X),p=Se(F),g=te(F,"SELECT",{name:!0,id:!0,class:!0,style:!0});var he=ce(g);b=te(he,"OPTION",{"data-svelte-h":!0}),Oe(b)!=="svelte-118r9sm"&&(b.textContent=v),D=te(he,"OPTION",{"data-svelte-h":!0}),Oe(D)!=="svelte-sm54j8"&&(D.textContent=x),he.forEach(X),L=Se(F),J&&J.l(F),m=Se(F),w=te(F,"SELECT",{name:!0,id:!0,class:!0,style:!0});var ue=ce(w);E=te(ue,"OPTION",{"data-svelte-h":!0}),Oe(E)!=="svelte-25qg8g"&&(E.textContent=S),k=te(ue,"OPTION",{"data-svelte-h":!0}),Oe(k)!=="svelte-mfwbwu"&&(k.textContent=T),ue.forEach(X),I=Se(F),C=te(F,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(C)!=="svelte-9cox89"&&(C.innerHTML=R),F.forEach(X),this.h()},h(){j(n,"class","ml-2"),j(n,"href","https://github.com/SavonarolaLabs/escript-online"),j(a,"class","w-full input-monospace svelte-189c5u6"),j(a,"type","text"),a.readOnly=!0,a.value=e[4],ii(f,"value",e[4]),j(u,"class","h-full copy-btn flex items-center justify-center px-4 svelte-189c5u6"),j(l,"class","flex"),j(s,"class","grow"),b.__value="v1",xn(b,b.__value),D.__value="v0",xn(D,D.__value),j(g,"name","network"),j(g,"id","network"),j(g,"class","bg-black flex items-center gap-2 m-2 px-3 py-2 custom-select svelte-189c5u6"),xt(g,"-webkit-appearance","none",1),xt(g,"-moz-appearance","none",1),e[2]===void 0&&Is(()=>e[17].call(g)),E.__value=Ls.Mainnet,xn(E,E.__value),k.__value=Ls.Testnet,xn(k,k.__value),j(w,"name","network"),j(w,"id","network"),j(w,"class","bg-black flex items-center gap-2 m-2 px-3 py-2 custom-select svelte-189c5u6"),xt(w,"-webkit-appearance","none",1),xt(w,"-moz-appearance","none",1),e[1]===void 0&&Is(()=>e[19].call(w)),j(C,"class","btn flex items-center gap-2 m-2 px-3 py-2"),j(t,"class","w-full flex items-center p-2 gap-4")},m(K,F){Xe(K,t,F),V(t,n),V(t,i),V(t,s),V(s,l),V(l,a),V(l,c),V(l,h),V(h,u),V(u,f),W.m(f,null),V(t,p),V(t,g),V(g,b),V(g,D),Tn(g,e[2],!0),V(t,L),J&&J.m(t,null),V(t,m),V(t,w),V(w,E),V(w,k),Tn(w,e[1],!0),V(t,I),V(t,C),P||(z=[Qe(h,"click",e[11]),Qe(g,"change",e[17]),Qe(w,"change",e[19]),Qe(C,"click",e[10])],P=!0)},p(K,F){F&16&&a.value!==K[4]&&(a.value=K[4]),H!==(H=Z(K))&&(W.d(1),W=H(K),W&&(W.c(),W.m(f,null))),F&16&&ii(f,"value",K[4]),F&4&&Tn(g,K[2]),K[2]=="v0"?J?J.p(K,F):(J=ql(K),J.c(),J.m(t,m)):J&&(J.d(1),J=null),F&2&&Tn(w,K[1])},d(K){K&&X(t),W.d(),J&&J.d(),P=!1,Ds(z)}}}function Qg(e){let t,n;return{c(){t=mt("svg"),n=mt("path"),this.h()},l(r){t=bt(r,"svg",{"aria-hidden":!0,height:!0,viewBox:!0,version:!0,width:!0,"data-view-component":!0,class:!0});var i=ce(t);n=bt(i,"path",{fill:!0,d:!0}),ce(n).forEach(X),i.forEach(X),this.h()},h(){j(n,"fill","lightgreen"),j(n,"d","M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"),j(t,"aria-hidden","true"),j(t,"height","16"),j(t,"viewBox","0 0 16 16"),j(t,"version","1.1"),j(t,"width","16"),j(t,"data-view-component","true"),j(t,"class","")},m(r,i){Xe(r,t,i),V(t,n)},d(r){r&&X(t)}}}function ep(e){let t,n,r;return{c(){t=mt("svg"),n=mt("path"),r=mt("path"),this.h()},l(i){t=bt(i,"svg",{"aria-hidden":!0,height:!0,viewBox:!0,version:!0,width:!0,"data-view-component":!0,class:!0});var s=ce(t);n=bt(s,"path",{d:!0,class:!0}),ce(n).forEach(X),r=bt(s,"path",{d:!0,class:!0}),ce(r).forEach(X),s.forEach(X),this.h()},h(){j(n,"d","M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"),j(n,"class","svelte-189c5u6"),j(r,"d","M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"),j(r,"class","svelte-189c5u6"),j(t,"aria-hidden","true"),j(t,"height","16"),j(t,"viewBox","0 0 16 16"),j(t,"version","1.1"),j(t,"width","16"),j(t,"data-view-component","true"),j(t,"class","octicon svelte-189c5u6")},m(i,s){Xe(i,t,s),V(t,n),V(t,r)},d(i){i&&X(t)}}}function ql(e){let t,n,r="includeSize: false \xA0\xA0",i,s="includeSize: true \xA0\xA0",l,a;return{c(){t=ee("select"),n=ee("option"),n.textContent=r,i=ee("option"),i.textContent=s,this.h()},l(c){t=te(c,"SELECT",{name:!0,id:!0,class:!0,style:!0});var h=ce(t);n=te(h,"OPTION",{"data-svelte-h":!0}),Oe(n)!=="svelte-mccm59"&&(n.textContent=r),i=te(h,"OPTION",{"data-svelte-h":!0}),Oe(i)!=="svelte-pk2sn9"&&(i.textContent=s),h.forEach(X),this.h()},h(){n.__value=!1,xn(n,n.__value),i.__value=!0,xn(i,i.__value),j(t,"name","includeSize"),j(t,"id","includeSize"),j(t,"class","bg-black flex items-center gap-2 m-2 px-3 py-2 custom-select svelte-189c5u6"),xt(t,"-webkit-appearance","none",1),xt(t,"-moz-appearance","none",1),e[3]===void 0&&Is(()=>e[18].call(t))},m(c,h){Xe(c,t,h),V(t,n),V(t,i),Tn(t,e[3],!0),l||(a=Qe(t,"change",e[18]),l=!0)},p(c,h){h&8&&Tn(t,c[3])},d(c){c&&X(t),l=!1,a()}}}function tp(e){let t,n,r,i,s,l,a,c="ErgoScript",h,u,f,p,g='<span class="font-bold">Blockly</span> <span class="absolute top-0 right-0 -mt-2 -mr-11 px-2 py-1 text-xs font-bold text-white bg-green-500 rounded-full">beta</span>',b,v,D,x,L=`copy as html
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="ml-2"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.46447 3.46447C2 4.92893 2 7.28595 2 12C2 16.714 2 19.0711 3.46447 20.5355C4.92893 22 7.28595 22 12 22C16.714 22 19.0711 22 20.5355 20.5355C22 19.0711 22 16.714 22 12C22 7.28595 22 4.92893 20.5355 3.46447C19.0711 2 16.714 2 12 2C7.28595 2 4.92893 2 3.46447 3.46447ZM13.4881 6.44591C13.8882 6.55311 14.1256 6.96437 14.0184 7.36447L11.4302 17.0237C11.323 17.4238 10.9117 17.6613 10.5116 17.5541C10.1115 17.4468 9.8741 17.0356 9.98131 16.6355L12.5695 6.97624C12.6767 6.57614 13.088 6.3387 13.4881 6.44591ZM14.9697 8.46967C15.2626 8.17678 15.7374 8.17678 16.0303 8.46967L16.2387 8.67801C16.874 9.3133 17.4038 9.84308 17.7678 10.3202C18.1521 10.8238 18.4216 11.3559 18.4216 12C18.4216 12.6441 18.1521 13.1762 17.7678 13.6798C17.4038 14.1569 16.874 14.6867 16.2387 15.322L16.0303 15.5303C15.7374 15.8232 15.2626 15.8232 14.9697 15.5303C14.6768 15.2374 14.6768 14.7626 14.9697 14.4697L15.1412 14.2981C15.8229 13.6164 16.2797 13.1574 16.5753 12.7699C16.8577 12.3998 16.9216 12.1843 16.9216 12C16.9216 11.8157 16.8577 11.6002 16.5753 11.2301C16.2797 10.8426 15.8229 10.3836 15.1412 9.70191L14.9697 9.53033C14.6768 9.23744 14.6768 8.76257 14.9697 8.46967ZM7.96986 8.46967C8.26275 8.17678 8.73762 8.17678 9.03052 8.46967C9.32341 8.76257 9.32341 9.23744 9.03052 9.53033L8.85894 9.70191C8.17729 10.3836 7.72052 10.8426 7.42488 11.2301C7.14245 11.6002 7.07861 11.8157 7.07861 12C7.07861 12.1843 7.14245 12.3998 7.42488 12.7699C7.72052 13.1574 8.17729 13.6164 8.85894 14.2981L9.03052 14.4697C9.32341 14.7626 9.32341 15.2374 9.03052 15.5303C8.73762 15.8232 8.26275 15.8232 7.96986 15.5303L7.76151 15.322C7.12617 14.6867 6.59638 14.1569 6.23235 13.6798C5.84811 13.1762 5.57861 12.6441 5.57861 12C5.57861 11.3559 5.84811 10.8238 6.23235 10.3202C6.59638 9.84308 7.12617 9.31331 7.76151 8.67801L7.96986 8.46967Z" fill="#bdbdbd"></path></svg>`,m,w,E=`flex
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="ml-2"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.77778 21H14.2222C17.3433 21 18.9038 21 20.0248 20.2646C20.51 19.9462 20.9267 19.5371 21.251 19.0607C22 17.9601 22 16.4279 22 13.3636C22 10.2994 22 8.76721 21.251 7.6666C20.9267 7.19014 20.51 6.78104 20.0248 6.46268C19.3044 5.99013 18.4027 5.82123 17.022 5.76086C16.3631 5.76086 15.7959 5.27068 15.6667 4.63636C15.4728 3.68489 14.6219 3 13.6337 3H10.3663C9.37805 3 8.52715 3.68489 8.33333 4.63636C8.20412 5.27068 7.63685 5.76086 6.978 5.76086C5.59733 5.82123 4.69555 5.99013 3.97524 6.46268C3.48995 6.78104 3.07328 7.19014 2.74902 7.6666C2 8.76721 2 10.2994 2 13.3636C2 16.4279 2 17.9601 2.74902 19.0607C3.07328 19.5371 3.48995 19.9462 3.97524 20.2646C5.09624 21 6.65675 21 9.77778 21ZM12 9.27273C9.69881 9.27273 7.83333 11.1043 7.83333 13.3636C7.83333 15.623 9.69881 17.4545 12 17.4545C14.3012 17.4545 16.1667 15.623 16.1667 13.3636C16.1667 11.1043 14.3012 9.27273 12 9.27273ZM12 10.9091C10.6193 10.9091 9.5 12.008 9.5 13.3636C9.5 14.7192 10.6193 15.8182 12 15.8182C13.3807 15.8182 14.5 14.7192 14.5 13.3636C14.5 12.008 13.3807 10.9091 12 10.9091ZM16.7222 10.0909C16.7222 9.63904 17.0953 9.27273 17.5556 9.27273H18.6667C19.1269 9.27273 19.5 9.63904 19.5 10.0909C19.5 10.5428 19.1269 10.9091 18.6667 10.9091H17.5556C17.0953 10.9091 16.7222 10.5428 16.7222 10.0909Z" fill="#bdbdbd"></path></svg>`,S,k,T=`save code as bookmark
                <svg class="ml-2 octicon svelte-189c5u6" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 1792 1792"><path d="M1420 128q23 0 44 9 33 13 52.5 41t19.5 62v1289q0 34-19.5 62t-52.5 41q-19 8-44 8-48 0-83-32l-441-424-441 424q-36 33-83 33-23 0-44-9-33-13-52.5-41t-19.5-62V240q0-34 19.5-62t52.5-41q21-9 44-9h1048z" class="svelte-189c5u6"></path></svg>`,I,C,R,P,z,Z,H,W,J,K,F,ke;u=new Yg({});function Ee(ne,fe){return ne[6]?Jg:Kg}let Me=Ee(e),ie=Me(e),G=e[7]&&Zl(),he=e[5]&&Vl(e),ue=!e[7]&&Wl(e);return{c(){t=ee("div"),n=ee("div"),r=ee("div"),i=ee("img"),l=Ce(),a=ee("div"),a.textContent=c,h=Ce(),dp(u.$$.fragment),f=Ce(),p=ee("a"),p.innerHTML=g,b=Ce(),v=ee("div"),ie.c(),D=Ce(),x=ee("button"),x.innerHTML=L,m=Ce(),w=ee("button"),w.innerHTML=E,S=Ce(),k=ee("button"),k.innerHTML=T,I=Ce(),C=ee("div"),R=ee("div"),G&&G.c(),P=Ce(),z=ee("div"),Z=Ce(),H=ee("div"),he&&he.c(),W=Ce(),ue&&ue.c(),this.h()},l(ne){t=te(ne,"DIV",{class:!0});var fe=ce(t);n=te(fe,"DIV",{class:!0});var je=ce(n);r=te(je,"DIV",{class:!0});var Fe=ce(r);i=te(Fe,"IMG",{src:!0,alt:!0,class:!0,style:!0}),l=Se(Fe),a=te(Fe,"DIV",{class:!0,"data-svelte-h":!0}),Oe(a)!=="svelte-8vajyo"&&(a.textContent=c),h=Se(Fe),up(u.$$.fragment,Fe),Fe.forEach(X),f=Se(je),p=te(je,"A",{class:!0,href:!0,"data-svelte-h":!0}),Oe(p)!=="svelte-1hikpit"&&(p.innerHTML=g),b=Se(je),v=te(je,"DIV",{class:!0});var He=ce(v);ie.l(He),D=Se(He),x=te(He,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),Oe(x)!=="svelte-czbnmr"&&(x.innerHTML=L),m=Se(He),w=te(He,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),Oe(w)!=="svelte-g6lu7c"&&(w.innerHTML=E),S=Se(He),k=te(He,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(k)!=="svelte-2onzqt"&&(k.innerHTML=T),He.forEach(X),je.forEach(X),I=Se(fe),C=te(fe,"DIV",{class:!0});var rt=ce(C);R=te(rt,"DIV",{});var Ue=ce(R);G&&G.l(Ue),P=Se(Ue),z=te(Ue,"DIV",{class:!0}),ce(z).forEach(X),Ue.forEach(X),rt.forEach(X),Z=Se(fe),H=te(fe,"DIV",{class:!0,style:!0});var Pe=ce(H);he&&he.l(Pe),W=Se(Pe),ue&&ue.l(Pe),Pe.forEach(X),fe.forEach(X),this.h()},h(){sp(i.src,s="logo.png")||j(i,"src",s),j(i,"alt",""),j(i,"class","ml-4"),xt(i,"width","30px"),j(a,"class","text-2xl font-bold p-4 pl-2"),j(r,"class","flex items-center"),j(p,"class","ml-8 relative inline-block"),j(p,"href","/blockly"),j(x,"class","flex items-center px-2 py-1 gray-border"),xt(x,"border-style","dashed"),j(w,"class","flex items-center px-2 py-1 gray-border"),xt(w,"border-style","dashed"),j(k,"class","flex items-center rounded-full px-3 py-1 gray-border"),j(v,"class","flex gap-4 items-center pr-2"),j(n,"class","navbar flex justify-between items-center svelte-189c5u6"),j(z,"class","w-full svelte-189c5u6"),De(z,"h-full",e[7]),De(z,"h-vh",!e[7]),De(R,"editor-flex",e[7]),De(R,"fake-window-header",e[7]),De(R,"shadow-2xl",e[7]),De(R,"w-full",!e[7]),j(C,"class","h-vh w-full flex flex-col justify-center items-center svelte-189c5u6"),De(C,"flex-bg",e[7]),j(H,"class","footer w-full flex flex-col justify-end rounded-md svelte-189c5u6"),j(H,"style",J=e[5]?"height: 40vh;":""),j(t,"class","h-vh svelte-189c5u6")},m(ne,fe){Xe(ne,t,fe),V(t,n),V(n,r),V(r,i),V(r,l),V(r,a),V(r,h),fp(u,r,null),V(n,f),V(n,p),V(n,b),V(n,v),ie.m(v,null),V(v,D),V(v,x),V(v,m),V(v,w),V(v,S),V(v,k),V(t,I),V(t,C),V(C,R),G&&G.m(R,null),V(R,P),V(R,z),e[16](z),V(t,Z),V(t,H),he&&he.m(H,null),V(H,W),ue&&ue.m(H,null),K=!0,F||(ke=[Qe(x,"click",e[14]),Qe(w,"click",e[15]),Qe(k,"click",np)],F=!0)},p(ne,[fe]){Me===(Me=Ee(ne))&&ie?ie.p(ne,fe):(ie.d(1),ie=Me(ne),ie&&(ie.c(),ie.m(v,D))),ne[7]?G||(G=Zl(),G.c(),G.m(R,P)):G&&(G.d(1),G=null),(!K||fe&128)&&De(z,"h-full",ne[7]),(!K||fe&128)&&De(z,"h-vh",!ne[7]),(!K||fe&128)&&De(R,"editor-flex",ne[7]),(!K||fe&128)&&De(R,"fake-window-header",ne[7]),(!K||fe&128)&&De(R,"shadow-2xl",ne[7]),(!K||fe&128)&&De(R,"w-full",!ne[7]),(!K||fe&128)&&De(C,"flex-bg",ne[7]),ne[5]?he?he.p(ne,fe):(he=Vl(ne),he.c(),he.m(H,W)):he&&(he.d(1),he=null),ne[7]?ue&&(ue.d(1),ue=null):ue?ue.p(ne,fe):(ue=Wl(ne),ue.c(),ue.m(H,null)),(!K||fe&32&&J!==(J=ne[5]?"height: 40vh;":""))&&j(H,"style",J)},i(ne){K||(gp(u.$$.fragment,ne),K=!0)},o(ne){pp(u.$$.fragment,ne),K=!1},d(ne){ne&&X(t),_p(u),ie.d(),G&&G.d(),e[16](null),he&&he.d(),ue&&ue.d(),F=!1,Ds(ke)}}}function np(){if(window.sidebar&&window.sidebar.addPanel)window.sidebar.addPanel(document.title,window.location.href,"");else if(window.external&&"AddFavorite"in window.external)window.external.AddFavorite(window.location.href,document.title);else if(window.opera&&window.print){var e=document.createElement("a");e.setAttribute("href",window.location.href),e.setAttribute("title","ErgoScript"),e.setAttribute("rel","sidebar"),e.click()}else alert("Your browser doesn't support adding bookmarks automatically. Please use Ctrl+D (Cmd+D on macOS) to add a bookmark manually.")}function rp(e,t,n){let r;Yl(e,dr,z=>n(23,r=z)),Gl.registerLanguage("scala",mp);let i,s,l,a=Ls.Mainnet,c="v1",h=!1,u="",f="",p="",g=!1;function b(){const z=s.getValue();try{n(4,u=kp(z,a,c,h)),n(5,f="")}catch(Z){n(4,u=""),n(5,f=Z.message)}}op(async()=>{window.srust=bp,window.Address=wp,window.ErgoTree=Xl;const z=new URLSearchParams(window.location.search),Z=z.get("l");if(self.MonacoEnvironment={getWorker(H,W){return new yp}},l=await ip(()=>import("../chunks/editor.main.87ee2f97.js"),["../chunks/editor.main.87ee2f97.js","../chunks/toggleHighContrast.492bfa7f.js","../chunks/preload-helper.a4192956.js","../assets/toggleHighContrast.a99fd1e1.css"],import.meta.url),s=l.editor.create(i,{value:`{
  proveDlog(CONTEXT.preHeader.minerPk)
}`,language:"scala",minimap:{enabled:!1},theme:"vs-dark",fontSize:16,automaticLayout:!0}),s.getModel().onDidChangeContent(H=>{if(r!="code")return;const W=s.getValue(),J=Vg(W);let K="";J.forEach(F=>{K+=String.fromCharCode(F)}),window.history.replaceState(null,"","?s="+encodeURIComponent(btoa(K)))}),Z&&m(Z),!Z){const H=z.get("s");if(H){const W=atob(decodeURIComponent(H)),J=new Uint8Array(W.length);for(let ke=0;ke<W.length;ke++)J[ke]=W.charCodeAt(ke);const K=Wg(J);let F="";K.forEach(ke=>{F+=String.fromCharCode(ke)}),s.setValue(F)}}});let v=!1;function D(){v||(n(8,v=!0),setTimeout(()=>{n(8,v=!1)},3e3)),navigator.clipboard.writeText(u)}let x=!1;function L(){x||(n(9,x=!0),setTimeout(()=>{n(9,x=!1)},3e3)),navigator.clipboard.writeText(p)}function m(z,Z=!1){const H=s.getValue();n(6,p=window.location.origin+"?l="+z);const W=new ln,J=new su(z,W),K=W.getText("monaco");new cu(K,s.getModel(),new Set([s]),J.awareness),Z&&s.setValue(H),L()}const w=z=>[...Array(z)].map(()=>Math.floor(Math.random()*16).toString(16)).join("");function E(){const z=w(16);m(z,!0)}function S(){const z=Gl.highlight("scala",s.getValue()).value.replaceAll("{","&#123;").replaceAll("}","&#125;");navigator.clipboard.writeText(`
<style>
.hljs {
  color: #ddd;
}

.hljs-tag,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-strong,
.hljs-name {
  color: #f92672;
}

.hljs-code {
  color: #66d9ef;
}

.hljs-attribute,
.hljs-symbol,
.hljs-regexp,
.hljs-link {
  color: #bf79db;
}

.hljs-string,
.hljs-bullet,
.hljs-subst,
.hljs-title,
.hljs-section,
.hljs-emphasis,
.hljs-type,
.hljs-built_in,
.hljs-selector-attr,
.hljs-selector-pseudo,
.hljs-addition,
.hljs-variable,
.hljs-template-tag,
.hljs-template-variable {
  color: #a6e22e;
}

.hljs-title.class_,
.hljs-class .hljs-title {
  color: white;
}

.hljs-comment,
.hljs-quote,
.hljs-deletion,
.hljs-meta {
  color: #75715e;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-doctag,
.hljs-title,
.hljs-section,
.hljs-type,
.hljs-selector-id {
  font-weight: bold;
}

.ios-buttons {
    display: flex;
    gap: 5px;
    padding: 0.7em;
    padding-left: 1em;
}

.ios-button {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: #fff;
    cursor: pointer;
}

.ios-button.close {
    background-color: #ff3b30;
}

.ios-button.minimize {
    background-color: #ffcc00;
}

.ios-button.maximize {
    background-color: #4cd964;
}

.fake-window-header {
    border-top-left-radius: 6px;
    border-top-right-radius: 6px;
    position: sticky;
    top: 0;
    background-color: #1e1e1e;
    width:100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    color: gray;
    font-family: monospace;
}

.editor-flex {
    background: #1e1e1e;
    position: relative;
    height: 300px;
    width: 600px;
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
    overflow: scroll;
    resize: both;
    -webkit-box-shadow: 0px 0px 81px 5px rgba(0, 0, 0, 0.7);
    -moz-box-shadow: 0px 0px 81px 5px rgba(0, 0, 0, 0.7);
    box-shadow: 0px 0px 81px 5px rgba(0, 0, 0, 0.7);
}
.source-code{
    margin-left:16px;
}
</style>


<div class="editor-flex">
    <div class="fake-window-header">
                <div class="ios-buttons">
                    <div class="ios-button close" />
                    <div class="ios-button minimize" />
                    <div class="ios-button maximize" />
                </div>
                <div style="padding-right:8px;">ergoscript</div>
            </div>
            <div class="source-code">
                <pre><code class="hljs">${z}</code></pre>
            </div>   
    </div>
    `)}function k(){g?(n(7,g=!1),s.updateOptions({lineNumbers:"on"})):(n(7,g=!0),s.updateOptions({lineNumbers:"off"}))}let T="";dr.subscribe(z=>{if(z=="code"&&T!=""&&(s.setValue(T),s.updateOptions({readOnly:!1})),z=="tree"){s.updateOptions({readOnly:!0}),T=s.getValue();let Z="";try{const H=vp(T,a,c);Z=Xl.from_bytes(H).pretty_print()}catch(H){Z=H.message}s.setValue(Z)}});function I(z){hp[z?"unshift":"push"](()=>{i=z,n(0,i)})}function C(){c=Ns(this),n(2,c)}function R(){h=Ns(this),n(3,h)}function P(){a=Ns(this),n(1,a)}return[i,a,c,h,u,f,p,g,v,x,b,D,L,E,S,k,I,C,R,P]}Ql=class extends Kl{constructor(e){super(),Jl(this,e,rp,tp,$l,{})}}});export{xp as __tla,Ql as component};
